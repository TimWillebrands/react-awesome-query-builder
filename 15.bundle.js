(self.webpackChunk_react_awesome_query_builder_examples=self.webpackChunk_react_awesome_query_builder_examples||[]).push([[15],{56135:(e,t,r)=>{"use strict";r.d(t,{b$:()=>Ie});var n=r(6297),o=r(29901),i=r(95478),l=r(58722),a=r(40372),u=r(70289),s=r(40795),c=r(63050),p=r(40544),d=r(7760),f=r(11020),v=r(72313),g=r(42390),h=r(6901),y=r.n(h),m=r(7234),b=r(86550),O=r(73352),S=r.n(O),F=r(37682),w=F.cQ.ListUtils.mapListValues,j=r(613),E=r(67867),C=["width"],L=r(27121),P=r(33079),_=["width"],k=r(65532),Z=r(39421),T=r(31895),V=r(98411),I=r(67842),x=F.cQ.ListUtils.mapListValues,R=r(35805),D=r(71068),A=r(11447),N=r(6724),M=r(33865),q=r(14453),W=r(6589),G=r(16123),B=["width"];function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $=F.Px.h,J=o.createElement(W.Z,{fontSize:"small",style:{marginRight:10,marginTop:4}}),H=o.createElement(G.Z,{fontSize:"small",style:{marginRight:10,marginTop:4}}),Y=[];const K=function(e){var t=e.allowCustomValues,r=e.multiple,n=e.disableClearable,i=e.value,l=e.customProps,a=e.readonly,u=e.config,s=e.filterOptionsConfig,f=e.errorText,v={stringify:(0,o.useCallback)((function(e){return u.settings.listKeysForSearch.map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[u])},g=(0,R.D)(s||v),h=$(e,{debounceTimeout:100,multiple:r,uif:"mui"}),y=h.open,m=h.onOpen,b=h.onClose,O=h.onChange,F=h.onInputChange,w=h.inputValue,E=h.options,C=h.isInitialLoading,L=h.isLoading,P=h.aPlaceholder,_=h.extendOptions,k=h.getOptionSelected,Z=h.getOptionDisabled,T=h.getOptionIsCustom,V=h.getOptionLabel,I=h.selectedListValue,x=u.settings,W=x.defaultSelectWidth,G=x.defaultSearchWidth,U=l||{},K=U.width,Q=(0,j.Z)(U,B),X=Q.input||{},ee=X.width||G;X=S()(X,["width"]);var te=S()(Q,["showSearch","showCheckboxes"]),re=K||W,ne={width:r?void 0:re,minWidth:re},oe=a?"":P,ie=null!=i?i:r?Y:null,le=(0,q.Z)((function(e){return{input:{minWidth:ee+" !important"}}})),ae=(0,q.Z)((function(e){return{root:{height:"auto"},label:{marginTop:"3px",marginBottom:"3px"}}}))(),ue=le();return o.createElement(d.Z,{fullWidth:!0},o.createElement(D.ZP,(0,c.Z)({disableClearable:n,disableCloseOnSelect:r,fullWidth:!0,multiple:r,style:ne,classes:ue,freeSolo:t,loading:C,open:y,onOpen:m,onClose:b,inputValue:w,onInputChange:F,label:oe,onChange:O,value:ie,getOptionSelected:k,disabled:a,readOnly:a,options:E,groupBy:function(e){return null==e?void 0:e.groupTitle},getOptionLabel:V,getOptionDisabled:Z,renderInput:function(e){var t,n=!r&&!y,i=null!==(t=null==I?void 0:I.title)&&void 0!==t?t:"",l=n?i:r&&!y?"":null!=w?w:"";return o.createElement(p.Z,(0,c.Z)({},e,{inputProps:z(z({},e.inputProps),{},{value:l}),InputProps:z(z({},e.InputProps),{},{readOnly:a,endAdornment:o.createElement(o.Fragment,null,L?o.createElement(A.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}),disabled:a,placeholder:oe,error:!!f},X))},renderTags:function(e,t){return e.map((function(e,r){var n=T(e)?"customSelectOption":void 0,i=o.createElement("span",{className:n},V(e));return o.createElement(N.Z,(0,c.Z)({key:e.value,classes:ae,label:i,size:"small"},t({index:r})))}))},renderOption:function(e,t){var n=t.selected,i=e.title,l=e.renderTitle,a=(e.value,e.specialValue),u=e.isHidden,s=T(e)?"customSelectOption":void 0,c=o.createElement("span",{className:s},l||i);return u?null:r?a?o.createElement(M.Z,null,l||i):o.createElement(M.Z,null,n?H:J,c):a?o.createElement(o.Fragment,null,l||i):o.createElement(o.Fragment,null,c)},filterOptions:function(e,t){var r=g(e,t);return _(r)}},te)))};var Q=r(35201),X=["items","selectedKey","setField","isValueField"];function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re={key:"_value2",path:"value",label:"title",altLabel:"_altLabel",tooltip:"tooltip",grouplabel:"groupTitle"},ne=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){var n=t.items,i=t.path,l=t.key,a=t.label,u=t.altLabel,s=t.disabled,c=t.grouplabel,p=t.matchesType,d=t.tooltip,f="  ".repeat(r);return n?e(n,r+1):{title:a,renderTitle:p?o.createElement("b",null,f+a):f+a,value:i,disabled:s,groupTitle:r>0?f+c:null,tooltip:d,_value2:l,_altLabel:u}})).flat(1/0)},oe=function(e,t){var r=e.items,n=e.selectedKey,i=e.setField,l=e.isValueField,a=(0,j.Z)(e,X),u=ne(r),s=n,c={stringify:(0,o.useCallback)((function(e){return t.settings.fieldItemKeysForSearch.map((function(e){return re[e]})).map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[t])};return te(te({},a),{},{listValues:u,setValue:function(e,t){if(e||l)return i(e)},filterOptionsConfig:c,allowCustomValues:!1,multiple:!1,disableClearable:!l,value:s,isFieldAutocomplete:!0})},ie=r(79708),le=r(62530),ae=r(55595),ue=r(56496),se=F.cQ.DragIcon,ce={delGroup:o.createElement(ie.Z,null),delRuleGroup:o.createElement(ie.Z,null),delRule:o.createElement(ie.Z,null),addRuleGroup:o.createElement(le.Z,null),addRuleGroupExt:o.createElement(le.Z,null),addRule:o.createElement(le.Z,null),addGroup:o.createElement(le.Z,null),drag:o.createElement(ae.Z,null)},pe={drag:"inherit"},de=r(40543),fe=r(26180),ve={addRuleGroup:!0,addRuleGroupExt:!0,delGroup:!0,delRuleGroup:!0,delRule:!0},ge={addRule:"primary",addGroup:"primary",delGroup:"secondary",delRuleGroup:"secondary",delRule:"secondary"},he=r(88251),ye=r(99202),me=r(80595),be=r(91665),Oe=r(8745),Se=r(21184),Fe=r(56512),we=r(36842),je=r(99382),Ee=(0,q.Z)((function(e){return{paper:{padding:e.spacing(1)}}}));const Ce={MaterialTextWidget:function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),i=e.placeholder,l=e.customProps,a=e.maxLength,u=t||"";return o.createElement(d.Z,null,o.createElement(p.Z,(0,c.Z)({value:u,placeholder:n?"":i,InputProps:{readOnly:n},inputProps:{maxLength:a},disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}},l)))},MaterialTextAreaWidget:function(e){var t=e.value,r=e.setValue,n=e.config,i=e.readonly,l=e.placeholder,a=e.customProps,u=e.maxLength,s=e.maxRows,f=e.fullWidth,v=n.settings.defaultMaxRows,g=t||"";return o.createElement(d.Z,{fullWidth:f},o.createElement(p.Z,(0,c.Z)({fullWidth:f,maxRows:s||v,multiline:!0,value:g,placeholder:i?"":l,InputProps:{readOnly:i},inputProps:{maxLength:u},disabled:i,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}},a)))},MaterialDateWidget:function(e){var t,r,n,i=e.value,l=e.setValue,a=e.readonly,u=e.customProps,s=e.dateFormat,p=e.valueFormat,v=e.placeholder,g=(null!==(t=window)&&void 0!==t&&t.matchMedia?null===(r=(n=window).matchMedia)||void 0===r?void 0:r.call(n,"(pointer:fine), (pointer:none)").matches:e.useKeyboard)?f.e:f.M;return o.createElement(d.Z,null,o.createElement(g,(0,c.Z)({readOnly:a,disabled:a,placeholder:a?"":v,format:s,value:i||null,onChange:function(e){l(function(e){return e&&e.isValid()?e.format(p):void 0}(e))}},u)))},MaterialDateTimeWidget:function(e){var t,r,n,i=e.value,l=e.setValue,a=e.use12Hours,u=e.readonly,s=e.placeholder,p=e.dateFormat,f=e.timeFormat,g=e.valueFormat,h=e.customProps,y=(null!==(t=window)&&void 0!==t&&t.matchMedia?null===(r=(n=window).matchMedia)||void 0===r?void 0:r.call(n,"(pointer:fine), (pointer:none)").matches:e.useKeyboard)?v.B:v.x,m=p+" "+f;return o.createElement(d.Z,null,o.createElement(y,(0,c.Z)({readOnly:u,disabled:u,ampm:!!a,placeholder:u?"":s,format:m,value:i||null,onChange:function(e){l(function(e){return e&&e.isValid()?e.format(g):void 0}(e))}},h)))},MaterialTimeWidget:function(e){var t,r,n,i=e.value,l=e.setValue,a=e.use12Hours,u=e.readonly,s=e.placeholder,p=e.timeFormat,f=e.valueFormat,v=e.customProps,h=(null!==(t=window)&&void 0!==t&&t.matchMedia?null===(r=(n=window).matchMedia)||void 0===r?void 0:r.call(n,"(pointer:fine), (pointer:none)").matches:e.useKeyboard)?g.e:g.j,m=-1!=p.indexOf(":ss"),b=i?y()(i,p):null;return o.createElement(d.Z,null,o.createElement(h,(0,c.Z)({readOnly:u,disabled:u,ampm:!!a,placeholder:u?"":s,format:p,value:b||null,onChange:function(e){l(function(e){return e&&e.isValid()?e.format(f):void 0}(e))},views:m?["hours","minutes","seconds"]:["hours","minutes"]},v)))},MaterialSelectWidget:function(e){var t=e.listValues,r=e.value,n=e.setValue,i=(e.allowCustomValues,e.readonly),l=e.placeholder,a=e.customProps,u=null!=r;return o.createElement(d.Z,null,o.createElement(m.Z,(0,c.Z)({autoWidth:!0,displayEmpty:!0,label:i?"":l,onChange:function(e){void 0!==e.target.value&&n(e.target.value)},value:u?r:"",disabled:i,readOnly:i,renderValue:function(e){return i||null!=e?function(e){return w(t,(function(t){var r=t.title;return t.value===e?r:null})).filter((function(e){return null!==e})).shift()}(e):l}},S()(a,["showSearch","input"])),w(t,(function(e){var t=e.title,r=e.value;return o.createElement(b.Z,{key:r,value:r},t)}))))},MaterialNumberWidget:function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),i=e.min,l=e.max,a=e.step,u=e.placeholder,s=e.customProps,f=null==t?"":t;return o.createElement(d.Z,null,o.createElement(p.Z,(0,c.Z)({type:"number",value:f,placeholder:n?"":u,InputProps:{readOnly:n},inputProps:{min:i,max:l,step:a},disabled:n,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},s)))},MaterialSliderWidget:function(e){var t=e.config,r=e.placeholder,n=e.customProps,i=e.value,l=e.setValue,a=e.min,u=e.max,s=e.step,f=e.marks,v=e.readonly,g=t.settings.defaultSliderWidth,h=n||{},y=h.width,m=(0,j.Z)(h,C),b=m.input||{},O=m.slider||m,S="number"==typeof i?i:"",F="number"==typeof i?i:null,w=!!f&&Object.keys(f).map((function(e){return{value:e,label:f[e]}})),L=o.createElement(p.Z,(0,c.Z)({type:"number",value:S,placeholder:r,InputProps:{readOnly:v},inputProps:{min:a,max:u,step:s},disabled:v,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),l(t)},onBlur:function(){i<a?l(a):i>u&&l(u)}},b)),P=o.createElement(E.Z,(0,c.Z)({value:F,onChange:function(e,t){l(t)},disabled:v,min:a,max:u,step:s,marks:w,valueLabelDisplay:"auto"},O)),_={marginLeft:"5px",paddingLeft:"12px",marginBottom:w&&"-16px",width:y||g};return o.createElement(d.Z,null,o.createElement("div",{style:{display:"inline-flex",alignItems:"center",flexWrap:"wrap"}},o.createElement("div",{style:{marginLeft:"5px"}},L),o.createElement("div",{style:_},P)))},MaterialRangeWidget:function(e){var t=e.config,r=e.placeholders,n=e.customProps,i=e.value,l=e.setValue,a=e.min,u=e.max,s=e.step,f=e.marks,v=e.readonly,g=e.textSeparators,h=t.settings.defaultSliderWidth;(0,o.useEffect)((function(){var t=e.value||[void 0,void 0],r=(0,P.Z)(t,2);r[0],r[1],e.value}),[]);var y=function(){i&&(i[0]<a?l([a,i[1]]):i[1]>u&&l([i[0],u]))},m=n||{},b=m.width,O=(0,j.Z)(m,_),S=O.input||{},F=O.slider||O,w=!!f&&Object.keys(f).map((function(e){return{value:e,label:f[e]}})),C=i?(0,L.Z)(i):[void 0,void 0],k=(0,P.Z)(C,2),Z=k[0],T=k[1];null==Z&&(Z="",C[0]=0),null==T&&(T="",C[1]=0);var V=o.createElement(p.Z,(0,c.Z)({type:"number",value:Z,placeholder:r[0],InputProps:{readOnly:v},inputProps:{min:a,max:u,step:s},disabled:v,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,L.Z)(e.value):[void 0,void 0];n[0]=r,l(n)},onBlur:y},S)),I=o.createElement(p.Z,(0,c.Z)({type:"number",value:T,placeholder:r[1],InputProps:{readOnly:v},inputProps:{min:a,max:u,step:s},disabled:v,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,L.Z)(e.value):[void 0,void 0];n[1]=r,l(n)},onBlur:y},S)),x=o.createElement(E.Z,(0,c.Z)({value:C,onChange:function(e,t){l(t)},disabled:v,min:a,max:u,step:s,marks:w,valueLabelDisplay:"auto"},F)),R={marginLeft:"5px"},D={marginLeft:"5px",paddingLeft:"12px",marginBottom:w&&"-16px",width:b||h};return o.createElement(d.Z,null,o.createElement("div",{style:{display:"inline-flex",flexWrap:"wrap"}},o.createElement("div",{style:R},V),o.createElement("div",{className:"widget--sep"},o.createElement("span",null,g[1])),o.createElement("div",{style:R},I),o.createElement("div",{style:D},x)))},MaterialBooleanWidget:function(e){var t=e.customProps,r=e.value,n=e.setValue,i=e.labelYes,l=e.labelNo,a=e.readonly;return o.createElement(d.Z,null,o.createElement(T.Z,{component:"div"},o.createElement(Z.Z,{component:"label",container:!0,alignItems:"center",spacing:0},o.createElement(Z.Z,{item:!0,component:"span"},l),o.createElement(Z.Z,{item:!0,component:"span"},o.createElement(k.Z,(0,c.Z)({checked:!!r,onChange:function(){n(!r)},disabled:a},t))),o.createElement(Z.Z,{item:!0,component:"span"},i))))},MaterialMultiSelectWidget:function(e){var t,r=e.listValues,n=e.value,i=e.setValue,l=(e.allowCustomValues,e.readonly),a=e.placeholder,u=e.customProps,s=null!=n&&n.length>0;return o.createElement(d.Z,null,o.createElement(m.Z,(0,c.Z)({multiple:!0,autoWidth:!0,displayEmpty:!0,label:l?"":a,onChange:function(e){void 0!==e.target.value&&i(e.target.value)},value:s?n:[],disabled:l,readOnly:l,renderValue:function(e){if(!l&&!e.length)return a;var t=x(r,(function(t){var r=t.title,n=t.value;return e.indexOf(n)>-1?r:null})).filter((function(e){return null!==e}));return t.join(", ")}},S()(u,["showSearch","input","showCheckboxes"])),(t=s?n:[],x(r,(function(e){var r=e.title,n=e.value;return o.createElement(b.Z,{key:n,value:n},o.createElement(V.Z,{checked:t.indexOf(n)>-1}),o.createElement(I.Z,{primary:r}))})))))},MaterialAutocompleteWidget:K,MaterialFieldSelect:function(e){var t=e.items,r=e.setField,n=e.selectedKey,i=e.readonly,l=e.placeholder,a=e.errorText,u=null!=n;return o.createElement(d.Z,null,o.createElement(m.Z,{error:!!a,autoWidth:!0,displayEmpty:!0,label:l,onChange:function(e){void 0!==e.target.value&&r(e.target.value)},value:u?n:"",disabled:i,renderValue:function(e){return i||e?function t(r){return r.map((function(r){return r.items?t(r.items):r.path===e?r.label:null}))}(t).filter((function(e){return Array.isArray(e)?e.some((function(e){return null!==e})):null!==e})).pop():l}},function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){var n=t.items,i=t.path,l=t.label,a=t.disabled,u=t.matchesType,s="  ".repeat(r);return n?[o.createElement(Q.Z,{disabled:a,key:i,disableSticky:!0},s&&o.createElement("span",null,s),l),e(n,r+1)]:o.createElement(b.Z,{disabled:a,key:i,value:i},s&&o.createElement("span",null,s),u?o.createElement("b",null,l):l)}))}(t)))},MaterialFieldAutocomplete:function(e){return o.createElement(K,oe(e,e.config))},MaterialIcon:function(e){var t=e.type,r=e.readonly,n=ce[t]||null;return n||"drag"!==t?"drag"===t?o.createElement(ue.Z,{size:"small",disabled:r,color:pe[t]},n):n:o.createElement(se,null)},MaterialButton:function(e){var t=e.type,r=e.label,n=e.onClick,i=e.readonly,l=e.renderIcon,a=null==l?void 0:l({type:t,readonly:i});return!r||ve[t]?o.createElement(fe.Z,{size:"small",disabled:i,onClick:n,color:ge[t]},a):o.createElement(de.Z,{size:"small",disabled:i,onClick:n,color:ge[t],startIcon:a},r)},MaterialButtonGroup:function(e){var t=e.children;return e.config,o.createElement(o.Fragment,null,t)},MaterialConjs:function(e){var t=e.id,r=e.not,n=e.setNot,i=e.conjunctionOptions,l=e.setConjunction,a=e.disabled,u=e.readonly,s=e.config,c=e.showNot,p=e.notLabel,f=Object.keys(i).length,v=a,g=s.settings.forceShowConj||f>1&&!v,h=function(e){return l(e)};return o.createElement(d.Z,null,o.createElement(he.Z,{disableElevation:!0,variant:"contained",size:"small",disabled:u},c&&(u&&!r?null:o.createElement(de.Z,{key:t,id:t+"__not",color:r?"secondary":"default",onClick:function(e){return n(e)}.bind(null,!r),disabled:u},p||"NOT")),g&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=(t.name,t.label),s=t.checked,c=l.isDummyFn?"__dummy":"";return!u&&!a||s?o.createElement(de.Z,{key:r+c,id:r+c,color:s?"primary":"default",value:e,onClick:h.bind(null,e),disabled:u||a},n):null}))))},MaterialSwitch:function(e){var t=e.value,r=e.setValue,n=e.label,i=e.checkedLabel,l=e.hideLabel,a=e.id,u=e.config,s=e.type,c=(u.settings.renderSize,function(){return r(!t)}),p=s,d=t&&i||n,f=t?o.createElement(be.Z,null):o.createElement(me.Z,null);return"lock"==s?l?o.createElement(fe.Z,{key:a+p,onClick:c,size:"small"},f):o.createElement(de.Z,{key:a+p,onClick:c,size:"small",startIcon:f},d):o.createElement(ye.Z,{control:o.createElement(k.Z,{checked:!!t,size:"small",onChange:function(e){return r(e.target.checked)}}),label:d})},MaterialValueSources:function(e){var t=e.valueSources,r=e.valueSrc,n=e.title,i=e.setValueSrc,l=(e.readonly,o.useState(null)),a=(0,P.Z)(l,2),u=a[0],s=a[1],c=Ee(),p=function(){s(null)},f=Boolean(u);return o.createElement("div",null,o.createElement(fe.Z,{size:"small",onClick:function(e){u?p():function(e){s(e.currentTarget)}(e)}},o.createElement(Oe.Z,null)),o.createElement(Se.ZP,{open:f,anchorEl:u,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:p,classes:{paper:c.paper},disablePortal:!0},o.createElement(d.Z,{component:"fieldset"},o.createElement(je.Z,{component:"legend"},n),o.createElement(we.Z,{value:r||"value",onChange:function(e){void 0!==e.target.value&&(i(e.target.value),p())}},function(e){return e.map((function(e){var t=(0,P.Z)(e,2),n=t[0],i=t[1];return o.createElement(ye.Z,{key:n,value:n,checked:r==n||!r&&"value"==n,control:o.createElement(Fe.Z,null),label:i.label})}))}(t)))))},MaterialConfirm:function(e){var t=e.onOk,r=e.okText,n=e.cancelText,o=e.title;(0,e.confirmFn)({description:o||"Are you sure?",title:null,confirmationText:r||"Ok",cancellationText:n||"Cancel"}).then(t).catch((function(){}))},MaterialUseConfirm:a.N,MaterialProvider:function(e){var t=e.config,r=e.children,n=t.settings.theme||{},c=t.settings.locale||{},p=n.material,d=c.material,f=p||d?(0,i.Z)(p,d):null,v=o.createElement("div",{className:"mui"},r),g=o.createElement(u.M,{utils:s.Z},o.createElement(a.W,null,v));return f?o.createElement(l.Z,{theme:f},g):g}};function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _e=Pe(Pe({},F.I4.settings),{},{renderField:function(e,t){var r,n=t.RCE,o=t.W,i=o.MaterialFieldAutocomplete,l=o.MaterialFieldSelect;return null!=e&&null!==(r=e.customProps)&&void 0!==r&&r.showSearch?n(i,e):n(l,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.MaterialFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.MaterialFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.MaterialConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.MaterialSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.MaterialButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.MaterialIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.MaterialButtonGroup,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.MaterialValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.MaterialValueSources,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.MaterialProvider,e)},renderConfirm:function(e,t){return(0,t.W.MaterialConfirm)(e)},useConfirm:function(e){return(0,e.W.MaterialUseConfirm)()}}),ke=Pe(Pe({},F.I4.widgets),{},{text:Pe(Pe({},F.I4.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialTextWidget,e)}}),textarea:Pe(Pe({},F.I4.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialTextAreaWidget,e)}}),number:Pe(Pe({},F.I4.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialNumberWidget,e)}}),multiselect:Pe(Pe({},F.I4.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MaterialAutocompleteWidget,i=n.MaterialMultiSelectWidget;return e.asyncFetch||e.showSearch?r(o,Pe(Pe({},e),{},{multiple:!0})):r(i,e)}}),select:Pe(Pe({},F.I4.widgets.select),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MaterialAutocompleteWidget,i=n.MaterialSelectWidget;return e.asyncFetch||e.showSearch?r(o,e):r(i,e)}}),slider:Pe(Pe({},F.I4.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialSliderWidget,e)}}),boolean:Pe(Pe({},F.I4.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialBooleanWidget,e)}}),date:Pe(Pe({},F.I4.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialDateWidget,e)}}),time:Pe(Pe({},F.I4.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialTimeWidget,e)}}),datetime:Pe(Pe({},F.I4.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialDateTimeWidget,e)}}),rangeslider:Pe(Pe({},F.I4.widgets.rangeslider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MaterialRangeWidget,e)}})}),Ze=Pe({},F.I4.types),Te=Pe(Pe({},F.I4.ctx),{},{W:Pe(Pe({},F.I4.ctx.W),Ce)}),Ve=Pe(Pe({},F.I4),{},{ctx:Te,types:Ze,widgets:ke,settings:_e});const Ie=Ve=F.cQ.ConfigMixins.addMixins(Ve,["rangeslider"])},37682:(e,t,r)=>{"use strict";r.d(t,{I4:()=>gd,gs:()=>h,Ib:()=>Zp,Px:()=>w,AE:()=>rs,cQ:()=>Rd});var n={};r.r(n),r.d(n,{applyToJS:()=>J,cleanJSX:()=>K,deepEqual:()=>B,deepFreeze:()=>ne,escapeRegExp:()=>H,getFirstDefined:()=>le,getLogger:()=>ie,getOpCardinality:()=>G,isDirtyJSX:()=>Q,isImmutable:()=>z,isJSX:()=>X,isJsonCompatible:()=>oe,isJsonLogic:()=>ee,logger:()=>ae,mergeArraysSmart:()=>re,mergeCustomizerNoArrays:()=>Y,opDefKeysToOmit:()=>W,shallowEqual:()=>U,sleep:()=>te,toImmutableList:()=>$,uuid:()=>N,widgetDefKeysToOmit:()=>q});var o={};r.r(o),r.d(o,{getItemInListValues:()=>Ee,getListValue:()=>ke,getTitleInListValues:()=>Ce,getValueInListValues:()=>Le,listValuesToArray:()=>je,makeCustomListValue:()=>we,mapListValues:()=>Pe,searchListValue:()=>_e,toListValue:()=>Fe});var i={};r.r(i),r.d(i,{_fixImmutableValue:()=>Be,expandTreePath:()=>Ze,expandTreeSubpath:()=>Te,fixEmptyGroupsInTree:()=>Re,fixPathsInTree:()=>xe,getFlatTree:()=>De,getItemByPath:()=>Ve,getLightTree:()=>Me,getSwitchValues:()=>qe,getTotalReordableNodesCountInTree:()=>Ae,getTotalRulesCountInTree:()=>Ne,getTreeBadFields:()=>Nn,hasChildren:()=>Ge,immutableToJs:()=>J,isEmptyTree:()=>We,isImmutable:()=>z,jsToImmutable:()=>He,removeIsLockedInTree:()=>Ie,toImmutableList:()=>$});var l={};r.r(l),r.d(l,{SqlString:()=>yt,mongoEmptyValue:()=>bt,spelEscape:()=>St,spelFixList:()=>Ot,spelFormatConcat:()=>Ft,spelImportConcat:()=>wt,sqlEmptyValue:()=>mt,stringifyForDisplay:()=>jt});var a={};r.r(a),r.d(a,{_loadFromJsonLogic:()=>it,_loadFromSpel:()=>Xt,checkTree:()=>Mn,getTree:()=>Ue,isImmutableTree:()=>$e,isJsonLogic:()=>ee,isTree:()=>Je,isValidTree:()=>An,jsToImmutable:()=>He,loadFromJsonLogic:()=>ot,loadFromSpel:()=>Qt,loadTree:()=>ze});var u={};r.r(u),r.d(u,{createListFromArray:()=>Vr,defaultConjunction:()=>Pr,defaultGroupConjunction:()=>Lr,defaultGroupProperties:()=>_r,defaultItemProperties:()=>kr,defaultOperatorOptions:()=>Er,defaultRoot:()=>Tr,defaultRule:()=>Zr,defaultRuleProperties:()=>Cr,emptyProperties:()=>Ir,getDefaultField:()=>Sr,getDefaultFieldSrc:()=>wr,getDefaultOperator:()=>jr,getDefaultSubField:()=>Fr});var s={};r.r(s),r.d(s,{_validateTree:()=>Bn,checkTree:()=>Mn,getNewValueForFieldOp:()=>eo,getTreeBadFields:()=>Nn,isValidTree:()=>An,sanitizeTree:()=>Wn,translateValidation:()=>Vn,validateAndFixTree:()=>Gn,validateRange:()=>Xn,validateTree:()=>qn,validateValue:()=>Hn});var c={};r.r(c),r.d(c,{completeFuncValue:()=>ro,getCompatibleArgsOnFuncChange:()=>so,setArgValue:()=>ao,setArgValueSrc:()=>uo,setFunc:()=>no,setFuncDefaultArg:()=>io});var p={};r.r(p),r.d(p,{calculateValueType:()=>go,completeValue:()=>xo,filterValueSourcesForField:()=>Fo,formatFieldName:()=>Eo,getFieldPartsConfigs:()=>mo,getFieldPathLabels:()=>yo,getFirstOperator:()=>vo,getFuncPathLabels:()=>ho,getOperatorsForField:()=>fo,getOperatorsForType:()=>po,getValueLabel:()=>bo,getValueSourcesForFieldOp:()=>wo,getWidgetForFieldOp:()=>jo,getWidgetsForFieldOp:()=>So,isEmptyGroupChildren:()=>ko,isEmptyItem:()=>Co,isEmptyRuleGroupExtPropertiesAndChildren:()=>Po,isEmptyRuleProperties:()=>To,selectTypes:()=>co,whatRulePropertiesAreCompleted:()=>Vo});var d={};r.r(d),r.d(d,{_widgetDefKeysToOmit:()=>bi,applyJsonLogic:()=>Wo,cleanJSX:()=>K,compileConfig:()=>oi,compressConfig:()=>ri,configKeys:()=>Ho,decompressConfig:()=>ni,extendConfig:()=>di,getFieldConfig:()=>Vi,getFieldParts:()=>ki,getFieldPath:()=>_i,getFieldPathParts:()=>Zi,getFieldRawConfig:()=>wi,getFieldSrc:()=>Ti,getFieldWidgetConfig:()=>xi,getFirstField:()=>Ri,getFuncArgConfig:()=>Li,getFuncConfig:()=>Ci,getFuncSignature:()=>Ei,getOperatorConfig:()=>Ii,isDirtyJSX:()=>Q,isFieldDescendantOfField:()=>Pi,isJSX:()=>X,iterateFields:()=>Si,iterateFuncs:()=>Oi,normalizeField:()=>ji});var f={};r.r(f),r.d(f,{_mongodbFormat:()=>ul,_spelFormat:()=>Tt,_sqlFormat:()=>Ol,elasticSearchFormat:()=>Tl,jsonLogicFormat:()=>$i,mongodbFormat:()=>al,queryBuilderFormat:()=>Ni,queryString:()=>Mr,spelFormat:()=>Zt,sqlFormat:()=>bl});var v={};r.r(v),r.d(v,{fixListValuesGroupOrder:()=>Bl,getListValue:()=>ke,listValueToOption:()=>Gl,mergeListValues:()=>Ml,optionToListValue:()=>ql,optionsToListValues:()=>Wl,simulateAsyncFetch:()=>Nl});var g={};r.r(g),r.d(g,{Autocomplete:()=>v,ConfigUtils:()=>d,DefaultUtils:()=>u,ExportUtils:()=>l,FuncUtils:()=>c,ListUtils:()=>o,OtherUtils:()=>n,RuleUtils:()=>p,TreeUtils:()=>i,Validation:()=>s,checkTree:()=>Mn,clone:()=>Do(),compressConfig:()=>ri,decompressConfig:()=>ni,getSwitchValues:()=>qe,i18n:()=>In,isValidTree:()=>An,moment:()=>Qe(),sanitizeTree:()=>Wn,uuid:()=>N,validateAndFixTree:()=>Gn,validateTree:()=>qn});var h={};r.r(h),r.d(h,{LINEAR_REGRESSION:()=>Hl,LOWER:()=>$l,NOW:()=>Ul,RELATIVE_DATETIME:()=>zl,UPPER:()=>Jl});var y={};r.r(y),r.d(y,{addCaseGroup:()=>eu,addDefaultCaseGroup:()=>Xa,addGroup:()=>tu,addRule:()=>Ka,moveItem:()=>nu,removeGroup:()=>ru,removeRule:()=>Qa,setTree:()=>Ya});var m={};r.r(m),r.d(m,{setConjunction:()=>ou,setLock:()=>lu,setNot:()=>iu});var b={};r.r(b),r.d(b,{setField:()=>au,setFieldSrc:()=>uu,setFuncValue:()=>du,setOperator:()=>su,setOperatorOption:()=>fu,setValue:()=>cu,setValueSrc:()=>pu});var O={};r.r(O),r.d(O,{bindActionCreators:()=>Hu,isUsingLegacyReactDomRender:()=>Uu,liteShouldComponentUpdate:()=>zu,pureShouldComponentUpdate:()=>$u,useOnPropsChanged:()=>Ju});var S={};r.r(S),r.d(S,{FuncWidget:()=>yc,ValueFieldWidget:()=>qp,VanillaBooleanWidget:()=>Wp,VanillaButton:()=>od,VanillaButtonGroup:()=>ld,VanillaConjs:()=>rd,VanillaDateTimeWidget:()=>Jp,VanillaDateWidget:()=>Up,VanillaFieldSelect:()=>td,VanillaIcon:()=>id,VanillaMultiSelectWidget:()=>Yp,VanillaNumberWidget:()=>Xp,VanillaProvider:()=>cd,VanillaSelectWidget:()=>Qp,VanillaSliderWidget:()=>ed,VanillaSwitch:()=>ud,VanillaTextAreaWidget:()=>Bp,VanillaTextWidget:()=>Gp,VanillaTimeWidget:()=>zp,VanillaValueSources:()=>ad,vanillaConfirm:()=>sd});var F={};r.r(F),r.d(F,{ProximityOperator:()=>pd});var w={};r.r(w),r.d(w,{h:()=>Vd});var j=r(51101),E=r(36838),C=r(85161),L=r(50584),P=r(69097),_=r(16875),k=r(29901),Z=r(6297),T=r(27121),V=r(33079),I=r(17743),x=r(45072),R=r(73352),D=r.n(R),A=0;const N=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&A++;return("x"===e?t:3&t|8).toString(16)}))+e};r(73656);var M=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},q=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],W=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],G=function(e){var t;return null!==(t=null==e?void 0:e.cardinality)&&void 0!==t?t:1},B=function(e,t){return e===t||(x.D5.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},U=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?U(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):x.D5.isMap(e)?e.equals(t):"object"==(0,I.Z)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var l=0;l<i;l++){var a=n[l];if(!(r?U(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)};var z=function(e){return"object"===(0,I.Z)(e)&&null!==e&&"function"==typeof e.toJS};function $(e){return z(e)?e:new x.ZP.List(e)}function J(e){return z(e)?e.toJS():e}var H=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},Y=function(e,t,r,n,o,i){if(Array.isArray(e))return t},K=function e(t){var r;if(t instanceof Array)return t.map((function(t,r){return e(t)}));if("object"===(0,I.Z)(t)&&null!==t&&Q(t)){var n,o=D()(t,["$$typeof","_owner","_store","ref","key"]);return o.type&&(o.type="string"==typeof(r=o.type)?r:"function"==typeof r?r.name:r),null!=o&&null!==(n=o.props)&&void 0!==n&&n.children&&(o.props.children=e(o.props.children)),o}return t},Q=function(e){return"object"===(0,I.Z)(e)&&null!==e&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},X=function(e){return"object"===(0,I.Z)(e)&&null!==e&&!Array.isArray(e)&&"string"==typeof e.type&&Object.keys(e).includes("props")},ee=function(e){return"object"===(0,I.Z)(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length};function te(e){return new Promise((function(t){setTimeout(t,e)}))}function re(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var n=(0,V.Z)(e,2),o=n[0];if(-1==n[1]){var i=r.slice(t+1),l=r.slice(0,t).reverse().find((function(e){var t=(0,V.Z)(e,2);return t[0],-1!=t[1]})),a=i.find((function(e){var t=(0,V.Z)(e,2);return t[0],-1!=t[1]}));return a?[o,"before",a[0]]:l?[o,"after",l[0]]:[o,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=(0,V.Z)(t,3),n=r[0],o=r[1],i=r[2],l=e.indexOf(i);return-1==e.indexOf(n)&&(l>-1?e.splice(l+("after"==o?1:0),0,n):e.splice("append"==o?1/0:0,0,n)),e}),e.slice())}var ne=function e(t){"object"===(0,I.Z)(t)&&null!==t&&(Object.keys(t).forEach((function(r){e(t[r])})),Object.freeze(t))},oe=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(M(t)){if(t.var)return n[t.var]=r,!0;if(!M(r))return!1;for(var i in t)if(!e(t[i],r[i],n,[].concat((0,T.Z)(o),[i])))return!1;return!0}if(Array.isArray(t)){if(!Array.isArray(r))return!1;for(var l=0;l<t.length;l++)if(!e(t[l],r[l],n,[].concat((0,T.Z)(o),[l])))return!1;return!0}return t===r},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null!=e&&e?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},le=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},ae=ie(),ue=r(81109),se=r.n(ue),ce=r(88469),pe=r.n(ce),de=r(49335),fe=r.n(de),ve=r(24098),ge=r.n(ve),he=r(77875),ye=r.n(he);function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Se=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},Fe=function(e,t){return null==e||""==e?void 0:Se(e)?Oe(Oe({},e),{},{title:e.title||e.value}):{value:e,title:void 0!==t?t:""+e}},we=function(e){var t=Fe(e);return Se(t)?Oe(Oe({},Fe(e)),{},{isCustom:!0}):t},je=function(e){if(Array.isArray(e))return e.map((function(e){return Fe(e)}));if(!Se(e))return e;var t=[];for(var r in e){var n=e[r];t.push(Fe(r,n))}return t},Ee=function(e,t){return Array.isArray(e)?e.map((function(e){return Fe(e)})).find((function(e){return""+e.value==""+t})):void 0!==e[t]?Fe(t,e[t]):void 0},Ce=function(e,t){if(null==e)return t;var r=Ee(e,t);return void 0!==r?r.title:t},Le=function(e,t){if(null==e)return t;var r=Ee(e,t);return void 0!==r?r.value:t},Pe=function(e,t){var r=[];if(Array.isArray(e)){var n,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,l=t(Fe(i));null!=l&&r.push(l)}}catch(e){o.e(e)}finally{o.f()}}else for(var a in e){var u=t(Fe(a,e[a]));null!=u&&r.push(u)}return r},_e=function(e,t){return Pe(t,(function(t){return-1!="".concat(t.value).indexOf(e)||-1!=t.title.indexOf(e)?t:null})).filter((function(e){return null!==e})).shift()},ke=function(e,t){return Pe(t,(function(t){return""+t.value==""+e?t:null})).filter((function(e){return null!==e})).shift()},Ze=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},Te=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},Ve=function(e,t){var r=new x.ZP.OrderedMap((0,Z.Z)({},e.get("id"),e)),n=e;return t.forEach((function(e){var t;n=r.get(e),r=null===(t=n)||void 0===t?void 0:t.get("children1")})),n},Ie=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.push(r.get("id")),l=r.getIn(["properties","isLocked"]);o&&l&&(t=t.deleteIn(Ze(i,"properties","isLocked")));var a=r.get("children1");a&&a.map((function(t,r){e(t,i,l||o)}))}(e,new x.ZP.List),t},xe=function(e){var t=e;return function e(r,n,o,i){if(r){var l=r.get("path"),a=r.get("id"),u=a||i||N(),s=n.push(u);l&&l.equals(s)||(t=t.setIn(Ze(s,"path"),s)),a||(t=t.setIn(Ze(s,"id"),u));var c=r.get("children1");c&&("Map"===c.constructor.name&&(t=t.setIn(Ze(s,"children1"),new x.ZP.OrderedMap(c))),c.map((function(t,r){e(t,s,o+1,r)})))}}(e,new x.ZP.List,0),t},Re=function(e){var t=e;return function e(r,n,o,i){if(!r)return!1;var l=r.get("id")||i,a=n.push(l),u=r.get("children1");if(u){var s=u.map((function(t,r){return e(t,a,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==u.size||s)&&o>0)return t=t.deleteIn(Ze(a)),!0}return!1}(e,new x.ZP.List,0),t},De=function(e){var t=[],r={},n=[],o=0,i=0,l=0,a={};!function u(s,c,p,d,f,v,g,h){var y=s===e,m=s.get("type"),b=s.get("collapsed"),O=s.get("id"),S=s.get("children1"),F=s.getIn(["properties","isLocked"]),w=S?S.map((function(e,t){return t})).valueSeq().toArray():null,j="rule_group"===m,E="rule"===m,C="group"===m,L="case_group"===m,P=!f&&(!S||j),_=(null==w?void 0:w.length)>0,k=c.length?c[c.length-1]:null,Z=L?O:g;L&&(n.push(O),i=0,l=0,a={});var V,I=Z?n.indexOf(Z):null,x=t.length,R=o;y||((V={}).caseNo=I,V.globalNoByType=a[m]||0,V.indexPath=[].concat((0,T.Z)(c.slice(1).map((function(e){return r[e].childNo}))),[h]),E?V.globalLeafNo=i:C&&(V.globalGroupNo=l)),t.push(O),r[O]={node:s,index:x,id:O,type:m,parent:k,parentType:k?r[k].type:null,children:w,childNo:h,caseId:Z,caseNo:I,path:c.concat(O),lev:v,isLeaf:!S,isAtomicRule:P,isLocked:F||d,top:p?null:R,isDefaultCase:L?!S:void 0,atomicRulesCountInCase:L?0:void 0,position:V,collapsed:b,_top:x,leaf:!S};var D=0,A=0;p||(o+=1,D+=1,!_||b||j||(A+=1),y||L||(C&&l++,E&&i++,a[m]=(a[m]||0)+1)),g&&P&&r[g].atomicRulesCountInCase++;var N=0,M=0;if(_){var q=0;S.map((function(e,t){if(e){u(e,c.concat(O),p||b,d||F,f||j,v+1,Z,q);var n=r[t];N=Math.max(N,n.depth||0),M+=n.height,q++}}))}D+=M,A+=N;var W=t.length-x,G=p?null:R+D;Object.assign(r[O],{depth:S?A:void 0,_height:W,height:D,bottom:G})}(e,[],!1,!1,!1,0,null,null);for(var u=0;u<t.length;u++){var s=u>0?t[u-1]:null,c=u<t.length-1?t[u+1]:null,p=r[t[u]];p.prev=s,p.next=c}return{flat:t,items:r,cases:n}},Ae=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,l,a;"function"==typeof r.get?(i=r.get("id"),l=r.get("children1"),a=r.get("type")):(i=r.id,l=r.children1,a=r.type),t++,l&&"rule_group"!=a&&l.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t-1},Ne=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,l,a;"function"==typeof r.get?(i=r.get("id"),l=r.get("children1"),a=r.get("type")):(i=r.id,l=r.children1,a=r.type),"rule"==a||"rule_group"==a?t++:l&&l.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t},Me=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return function e(n,o){t&&n.path&&delete n.path,t&&!r&&o&&delete n.id;var i=n.properties;i&&null==i.operatorOptions&&delete i.operatorOptions;var l=n.children1;if(l){for(var a in l)l[a]&&e(l[a],a);r&&(n.children1=Object.values(l))}}(e,null),n},qe=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,n=e.getIn(["properties","value"]);n&&1==n.size?(r=n.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat((0,T.Z)(t),[r])})),t},We=function(e){return!e.get("children1")||0==e.get("children1").size},Ge=function(e,t){return e.getIn(Ze(t,"children1")).size>0},Be=function(e){if(null!=e&&e.toJS){var t,r=null==e||null===(t=e.toJS)||void 0===t?void 0:t.call(e);return null!=r&&r.func?e.toOrderedMap():r}return e},Ue=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),Me(n,t,r)}},ze=function(e){if($e(e))return e;if(Je(e))return xe(He(e));if("string"==typeof e&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if("string"==typeof e)return xe(He(JSON.parse(e)));throw new Error("Can't load tree!")},$e=function(e){return x.D5.isMap(e)},Je=function(e){return"object"==(0,I.Z)(e)&&("group"==e.type||"switch_group"==e.type)};function He(e){return(0,x.d0)(e,(function(e,t,r){var n,o=r&&r.length>3&&"value"===r[r.length-1]&&"args"===r[r.length-3],i=r&&r.length>3&&"value"===r[r.length-1]&&"properties"===r[r.length-2];if("properties"==e){n=t.toOrderedMap();for(var l=0;l<2;l++){var a,u,s;null===(null===(a=n.get("value"))||void 0===a||null===(u=(s=a).get)||void 0===u?void 0:u.call(s,l))&&(n=n.setIn(["value",l],void 0))}}else n=o?Be(t):(r?i:"value"==e)&&x.ZP.Iterable.isIndexed(t)?t.map(Be).toList():"asyncListValues"==e?t.toJS():"children1"==e&&x.ZP.Iterable.isIndexed(t)?new x.ZP.OrderedMap(t.map((function(e){return[(null==e?void 0:e.get("id"))||N(),e]}))):x.ZP.Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return n}))}var Ye=r(35262),Ke=r(6901),Qe=r.n(Ke);function Xe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var nt=function(e){return{errors:[],settings:null==e?void 0:e.settings}},ot=function(e,t){return it(e,t,!1)},it=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=nt();n.settings={allowUnknownFields:!1,returnErrors:r};var o=di(t,void 0,!1),i=lt(o),l=e?at(e,i,o,"rule",n):void 0;l&&"group"!=l.type&&(l=dt(l,o));var a=l?ze(l):void 0;return r?[a,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),a)},lt=function(e){var t={};for(var r in e.operators){var n=e.operators[r];if("string"==typeof n.jsonLogic){var o=(n._jsonLogicIsRevArgs?"#":"")+n.jsonLogic+"/"+G(n);t[o]||(t[o]=[]),t[o].push(r)}else if("string"==typeof n.jsonLogic2){var i=n.jsonLogic2+"/"+G(n);t[i]||(t[i]=[]),t[i].push(r)}}var l={};for(var a in e.conjunctions)l[e.conjunctions[a].jsonLogicConj||a.toLowerCase()]=a;var u,s={},c=Xe(Oi(e));try{for(c.s();!(u=c.n()).done;){var p=(0,V.Z)(u.value,2),d=p[0],f=p[1],v=void 0;f.jsonLogicIsMethod?v="#"+f.jsonLogic:"string"==typeof f.jsonLogic&&(v=f.jsonLogic),v&&(s[v]||(s[v]=[]),s[v].push(d))}}catch(e){c.e(e)}finally{c.f()}var g=e.settings.jsonLogic;return{operators:t,conjunctions:l,funcs:s,varKeys:["var",g.groupVarKey,g.altVarKey]}},at=function e(t,r,n,o,i){var l,a,u,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;ee(t)&&(a=t[l=Object.keys(t)[0]],Array.isArray(a)||(a=[a]));var f=i.errors.length,v=n.settings.jsonLogic.lockedOp,g="!"==l&&1==a.length&&a[0]&&ee(a[0])&&r.varKeys.includes(Object.keys(a[0])[0]),h="!"==l&&!g,y=v&&l==v;y?u=e(a[0],r,n,o,i,s,c,p,d,!0):h?u=e(a[0],r,n,o,i,!s,c,p,d):"val"==o?u=st(l,a,r,n,s,i,d)||ct(l,a,r,n,s,c,i,d)||ut(t,c,p,n,i):"rule"==o&&(u=pt(l,a,r,n,s,i,d,!1)||vt(l,a,r,n,s,i,d));var m=i.errors.length;return"!"!=l&&void 0===u&&m==f&&i.errors.push("Can't parse logic ".concat(JSON.stringify(t))),y&&(u.properties.isLocked=!0),u},ut=function(e,t,r,n,o){var i;if(void 0===e&&(e=null==t?void 0:t.defaultValue),void 0!==e){var l=n.widgets[r||(null==t?void 0:t.mainWidget)],a=null==t?void 0:t.type;if(!a||l){if(!ee(e)){if("time"==a&&"number"==typeof e){var u=Math.floor(e/60/60)%24,s=Math.floor(e/60)%60,c=e%60,p=l.valueFormat;if(p){var d=new Date(e);d.setMilliseconds(0),d.setHours(u),d.setMinutes(s),d.setSeconds(c),e=Qe()(d).format(p)}else e="".concat(u,":").concat(s,":").concat(c)}if(["date","datetime"].includes(a)&&e&&!(e instanceof Date))try{var f=new Date(e);f instanceof Date&&f.toISOString()===e&&(e=f)}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var v=l.valueFormat;v&&(e=Qe()(e).format(v))}var g;return e&&null!=t&&null!==(i=t.fieldSettings)&&void 0!==i&&i.asyncFetch&&(g=Array.isArray(e)?e:[e]),{valueSrc:"value",value:e,valueType:null==l?void 0:l.type,asyncListValues:g}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(a))}},st=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var a,u=ji(n,t[0],l),s=Vi(n,u);return s||null!==(a=i.settings)&&void 0!==a&&a.allowUnknownFields?{valueSrc:"field",value:u,valueType:null==s?void 0:s.type}:void i.errors.push("No config for field ".concat(u))}},ct=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var u,s,c,p="method"==e;if(p){var d,f,v=(0,Ye.Z)(t);d=v[0],u=v[1],f=v.slice(2),s=[d].concat((0,T.Z)(f))}else u=e,s=t;var g=(p?"#":"")+u,h=(null==i?void 0:i.type)||(null==i?void 0:i.returnType),y=(r.funcs[g]||[]).filter((function(e){return!i||Ci(n,e).returnType==h}));if(y.length)c=y[0];else{var m,b=(0,Z.Z)({},e,t),O=Xe(Oi(n));try{for(O.s();!(m=O.n()).done;){var S=(0,V.Z)(m.value,2),F=S[0],w=S[1];if(w.jsonLogicImport&&(!h||w.returnType==h)){var j=void 0;try{j=w.jsonLogicImport(b)}catch(e){}j&&(c=F,s=j)}}}catch(e){O.e(e)}finally{O.f()}}if(c&&c){var E=Ci(n,c),C=Object.keys(E.args||{}),L=s.reduce((function(e,t,o){var i,u=C[o],s=E.args[u];return s&&(i=at(t,r,n,"val",l,!1,s,null,a)),void 0!==i?rt(rt({},e),{},(0,Z.Z)({},u,i)):e}),{});for(var P in E.args){var _,k=E.args[P],I=L[P];if(void 0===I)if(void 0!==(I=null==k?void 0:k.defaultValue)&&(I={value:I,valueSrc:null!==(_=I)&&void 0!==_&&_.func?"func":"value",valueType:k.type}),void 0===I){if(null==k||!k.isOptional)return void l.errors.push("No value for arg ".concat(P," of func ").concat(c))}else L[P]=I}return{valueSrc:"func",value:{func:c,args:L},valueType:E.returnType}}}},pt=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=r.conjunctions[e],s=n.settings.fieldSeparator;if(u){var c=t.map((function(e){return at(e,r,n,"rule",i,!1,null,null,a)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return rt(rt({},e),{},(0,Z.Z)({},t.id,t))}),{}),p=Object.values(c).map((function(e){var t,r;return"field"==(null==e||null===(t=e.properties)||void 0===t?void 0:t.fieldSrc)&&(null==e||null===(r=e.properties)||void 0===r?void 0:r.field)})).filter((function(e){var t;return null==e||null===(t=e.includes)||void 0===t?void 0:t.call(e,s)})),d=Object.fromEntries((l=p,Array.from(new Set(l))).map((function(e){var t=e.split(s),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat((0,T.Z)(r.slice(0,t)),[e])})).map((function(e){return[e.join(s),Vi(n,e)]})).filter((function(e){var t=(0,V.Z)(e,2),r=(t[0],t[1]);return"!group"==(null==r?void 0:r.type)})));return[e,Object.keys(r)]}))),f={conjunction:u,not:o},v=N(),g={},h={};return Object.entries(c).map((function(e){var t=(0,V.Z)(e,2),r=t[0],o=t[1];if("group"==(null==o?void 0:o.type)||"rule_group"==(null==o?void 0:o.type))g[r]=o;else{var i,l=null==o||null===(i=o.properties)||void 0===i?void 0:i.field,c=d[l]||[],p=c[c.length-1];if(p){var f=g,v=ki(a,n),y=ki(p,n);U(v,y.slice(0,v.length))||(v=[]),p.split(s).slice(v.length).map((function(e,t,r){return[].concat((0,T.Z)(v),(0,T.Z)(r.slice(0,t)),[e]).join(s)})).map((function(e){return{f:e,fc:Vi(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=h[r];o||(o=N(),h[r]=o,f[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:u,not:!1,field:r,fieldSrc:"field",mode:n.mode}}),f=f[o].children1})),f[r]=o}else o&&(g[r]=o)}})),{type:"group",id:v,children1:g,properties:f}}},dt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:N(),children1:(0,Z.Z)({},e.id,e),properties:{conjunction:Pr(t),not:r}}},ft=function(e,t,r,n,o,i,l,a){var u,s,c=!(("all"==e||"some"==e)&&ee(r[1])&&"in"==Object.keys(r[1])[0]&&""===(null===(u=r[1].in[0])||void 0===u?void 0:u.var))&&i.settings.groupOperators.includes(e),p=c?0:t-1;c?p=0:["==","!="].includes(e)&&1==p&&null===r[1]&&(t=1,p=0,r=[r[0]]);var d=e+"/"+p,f=o.operators[(l?"#":"")+d];if(f){var v,g=[];if(["<","<=",">",">="].includes(e)&&3==t)v=r[1],g=[r[0],r[2]];else if(l)v=r[1],g=[r[0]];else{var h=r,y=(0,Ye.Z)(h);v=y[0],g=y.slice(1)}if(ee(v)){var m=function(e,t,r,n,o){var i,l,a,u,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,p=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,f=Object.keys(t)[0],v=Object.values(t)[0],g=function(e,t){return function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Array.isArray(t)||(t=[t]);var a=st(e,t,r,n,o,i,l);if(a)return{fieldSrc:"field",field:a.value}}(e,t,n,o,s,p,d)||function(e,t,r,n,o){var i=ct(e,t,r,n,o,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6?arguments[6]:void 0,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null);if(i)return{fieldSrc:"func",field:i.value}}(e,t,n,o,s,c,p,d)},h=p.errors.length,y=g(f,v);if(y&&(i=y.field,l=y.fieldSrc),e&&(u=!0,a=r[0],r=[]),"reduce"==f&&Array.isArray(v)&&3==v.length){var m=v,b=(0,V.Z)(m,3),O=b[0],S=b[1],F=b[2];if(ee(O)&&0==F&&ee(S)&&Array.isArray(S["+"])&&1==S["+"][0]&&ee(S["+"][1])&&"accumulator"==S["+"][1].var)if(f=Object.keys(O)[0],v=Object.values(O)[0],"filter"==f){var w=v,j=(0,V.Z)(w,2),E=j[0],C=j[1];if(ee(E)){var L=g(f=Object.keys(E)[0],v=Object.values(E)[0]);L&&(i=L.field,l=L.fieldSrc,a=C,u=!0)}}else{var P=g(f,v);P&&(i=P.field,l=P.fieldSrc,u=!0)}}var _=p.errors.length;if(i||_!=h||p.errors.push("Unknown LHS ".concat(JSON.stringify(t))),i)return{field:i,fieldSrc:l,having:a,isGroup:u,args:r}}(c,v,g,o,i,null,null,a,n);if(m){var b=m.field,O=m.fieldSrc,S=m.having,F=(m.isGroup,m.args),w=Vi(i,b);if(w||null!==(s=a.settings)&&void 0!==s&&s.allowUnknownFields){var j=f[0];if(f.length>1&&w&&w.operators){if(0==(f=f.filter((function(e){return w.operators.includes(e)}))).length)return void a.errors.push("No corresponding ops for LHS ".concat(b));j=f[0]}return{field:b,fieldSrc:O,fieldConfig:w,opKey:j,args:F,having:S}}a.errors.push("No config for LHS ".concat(b))}}else a.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)))}},vt=function e(t,r,n,o,i,l){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(t){var u=r.length;if(("all"==t||"some"==t)&&ee(r[1])){var s,c=Object.keys(r[1])[0],p=""===(null===(s=r[1][c][0])||void 0===s?void 0:s.var);"in"==c&&p&&(r=[r[0],r[1][c][1]],t=t+"-"+c)}var d=function(e,t,r,n,o,i,l){var a=nt(l),u=ft(e,t,r,n,o,i,!1,a);if(u||(u=ft(e,t,r,n,o,i,!0,nt(l))),u)return u;l.errors.push(a.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t))}(t,u,r,a,n,o,l);if(d){var f,v,g=d.field,h=d.fieldSrc,y=d.fieldConfig,m=d.opKey,b=d.args,O=d.having,S=o.operators[m],F=(void 0!==(null==y?void 0:y.showNot)?y.showNot:o.settings.showNot,!1);if("!group"==(null==y?void 0:y.type)&&O){v=O[f=Object.keys(O)[0]],Array.isArray(v)||(v=[v]);var w="!"==f&&1==v.length&&v[0]&&ee(v[0])&&n.varKeys.includes(Object.keys(v[0])[0]);"!"!=f||w||(F=!0,v=(O=O["!"])[f=Object.keys(O)[0]],Array.isArray(v)||(v=[v]))}i&&S.reversedOp&&(i=!1,m=S.reversedOp,S=o.operators[m]);var j=jo(o,g,m,null),E=b.map((function(e){return at(e,n,o,"val",l,!1,y,j,a)}));if(!E.filter((function(e){return void 0===e})).length){var C,L=null==y?void 0:y.type;if("!group"!==L&&"!struct"!==L||(L=null),"!group"==(null==y?void 0:y.type)&&O){if(void 0!==n.conjunctions[f])C=pt(f,v,n,o,F,l,g,!0),F=!1;else{var P=e(f,v,n,o,F,l,g);F=!1,C=function(e,t,r,n,o){if(e)return{type:"rule_group",id:N(),children1:(0,Z.Z)({},e.id,e),properties:{conjunction:o||Lr(n,r),not:!1,field:t}}}(P,g,y,o,n.conjunctions.and)}if(!C)return;C.type="rule_group",Object.assign(C.properties,{field:g,mode:y.mode,operator:m}),"array"==y.mode&&Object.assign(C.properties,{value:E.map((function(e){return e.value})),valueSrc:E.map((function(e){return e.valueSrc})),valueType:E.map((function(e){return e.valueType}))}),i&&(C=dt(C,o,i))}else if("!group"!=(null==y?void 0:y.type)||O){var _=E.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),k=_.length?_[0]:void 0;C={type:"rule",id:N(),properties:rt({field:g,fieldSrc:h,operator:m,value:E.map((function(e){return e.value})),valueSrc:E.map((function(e){return e.valueSrc})),valueType:E.map((function(e){return e.valueType}))},k?{asyncListValues:k}:{})},i&&(C=dt(C,o,i))}else C={type:"rule_group",id:N(),children1:{},properties:{conjunction:Lr(o,y),not:i,mode:y.mode,field:g,operator:m}},"array"==y.mode&&Object.assign(C.properties,{value:E.map((function(e){return e.value})),valueSrc:E.map((function(e){return e.valueSrc})),valueType:E.map((function(e){return e.valueType}))});return C}}}},gt=r(60226),ht=r(57679),yt=r.n(ht)();yt.trim=function(e){return"'"==e.charAt(0)?e.substring(1,e.length-1):e},yt.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=yt.escape(e);return"'"+(n=(t?"%":"")+(n=(n=yt.trim(n)).replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var mt=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},bt=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},Ot=function(e){return"".concat(e,".?[true]")},St=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch((0,I.Z)(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!i.includes(t)||!i.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return St(e,!0)})):e.map((function(e){return St(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")}(e,r);throw new Error("spelEscape: Object is not supported");default:return function(e){return"'"+e.replace(/'/g,"''")+"'"}(e)}},Ft=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?St(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},wt=function(e){if(null==e)return[void 0,[]];var t=[];return[("case_value"==e.valueType?e.value:[e]).map((function(e){return"value"==e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"==e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]},jt=function(e){return null==e?"NULL":e.toString()};function Et(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _t="${0}.compareTo(${1})",kt={datetime:!0,time:!0,date:!0},Zt=function(e,t){return Tt(e,t,!1)},Tt=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=di(t,void 0,!1),i=Vt(e,o,n,null);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),i)},Vt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?Rt(e,t,r,n):"rule"===o?Nt(e,t,r,n):"switch_group"==o?xt(e,t,r,n):"case_group"==o?It(e,t,r,n):void 0}},It=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var i=e.get("properties")||new x.D5,l=qt(t,i,r,null,n,"!case_value"),a=(0,V.Z)(l,3),u=a[0];return a[1],a[2],[Rt(e,t,r,n),u]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},xt=function(e,t,r){e.get("properties")||new x.D5;var n=e.get("children1");if(n){var o=n.map((function(e){return It(e,t,r,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var i=[],l=0;l<o.length;l++)l==o.length-1||o[l][0]?(i.push(o[l]),l==o.length-1&&o[l][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(l));for(var a="",u="",s=0;s<i.length;s++){var c=(0,V.Z)(i[s],2),p=c[0],d=c[1];null==d&&(d="null"),null==p&&(p="true"),s!=i.length-1?(a+="(".concat(p," ? ").concat(d," : "),u+=")"):a+="".concat(d)}return a+u}}},Rt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),i=e.get("properties")||new x.D5,l=i.get("mode"),a=e.get("children1")||new x.aV,u=i.get("field"),s=i.get("conjunction");s||(s=Pr(t));var c=t.conjunctions[s],p=i.get("not"),d="rule_group"===o,f=d&&"struct"!=l,v=f?u:n,g=(Vi(t,v)||{}).isSpelArray,h=t.settings.fieldSeparator,y=i.get("operator");y||l&&"some"!=l||(y="some");var m=At(t,y,u),b=m!=y,O=y&&Ii(t,m,u)||null,S=d&&(!m||0==O.cardinality),F=qt(t,i,r,m,n,null),w=(0,V.Z)(F,3),j=w[0],E=w[1],C=w[2],L=a.map((function(e){return Vt(e,t,r,v)})).filter((function(e){return void 0!==e}));if(f&&!S){if(null==j)return}else if(!L.size)return;var P,_=d,k=L.size?c.spelFormatConj(L,s,p,_):null;if(f){var Z=Gt(r,t,u,n),T=(h||".")+(g?"length":"size()"),I="".concat(Z).concat(T),R=k?"".concat(Z,".?[").concat(k,"]").concat(T):I;P=Dt(r,t,i,R,S?I:j,m,E,C,b)}else P=k;return P},Dt=function(e,t,r,n,o,i,l,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=r.get("field"),c=Ii(t,i,s)||{},p=Vi(t,s)||{},d=r.get("operatorOptions"),f=c.spelFormatOp||function(e,t,r){var n=t.spelOp;if(n){var o,i=n.includes("${0}"),l=kt[r],a=n,u=G(t);return l?o=function(e,t,r,n,o,i,l,s){var c=_t.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}));return"".concat(c," ").concat(a," 0")}:i?o=function(e,t,r,o,i,l,a,s){return n.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}))}:0==u?o=function(e,t,r,n,o,i,l,u){return"".concat(e," ").concat(a)}:1==u&&(o=function(e,t,r,n,o,i,l,u){return"".concat(e," ").concat(a," ").concat(r)}),o}}(0,c,a);if(f){var v,g=[n,i,o,l,a,D()(c,W),d,p];return v=f.call.apply(f,[t.ctx].concat(g)),u&&(v=t.settings.spelFormatReverse(v)),void 0===v&&e.errors.push("Operator ".concat(i," is not supported for value source ").concat(l)),v}e.errors.push("Operator ".concat(i," is not supported"))},At=function(e,t,r){if(t){var n=Ii(e,t,r)||{},o=n.reversedOp,i=Ii(e,o,r)||{},l=n.spelOp||n.spelFormatOp,a=i.spelOp||i.spelFormatOp;if(l||a){if(!l&&a){var u=[o,t];t=u[0],o=u[1];var s=[i,n];n=s[0],i=s[1]}return t}}},Nt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new x.D5,i=o.get("field"),l=o.get("fieldSrc"),a=o.get("operator");if(null!=i&&null!=a){var u=At(t,a,i);if(u){var s=u!=a,c=qt(t,o,r,u,n,null),p=(0,V.Z)(c,3),d=p[0],f=p[1],v=p[2];if(void 0!==d){var g=Mt(r,t,i,l,n);if(void 0!==g)return Dt(r,t,o,g,d,u,f,v,s)}}else r.errors.push("Operator ".concat(a," is not supported"))}},Mt=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"func"===n?Bt(e,t,r,o):Gt(e,t,r,o)},qt=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=t.get("field"),a=t.get("valueSrc"),u=t.get("valueType");("!case_value"==i||u&&"case_value"==u.get(0))&&(l="!case_value");var s,c=Vi(e,l)||{},p=Ii(e,n,l)||{},d=G(p),f=t.get("value"),v=t.get("asyncListValues"),g=[],h=[];if(null!=f){var y=f.map((function(t,i){var s=a?a.get(i):null,d=u?u.get(i):null,f=xo(t,s,e),y=jo(e,l,n,s),m=D()(xi(e,l,n,y,s),["factory"]),b=Wt(r,e,f,s,d,m,c,n,p,o,v);return void 0!==b&&(g.push(s),h.push(d)),b})),m=y.filter((function(e){return void 0===e})).size>0;y.size<d||m||(s=d>1?y.toArray():1==d?y.first():null)}return[s,g.length>1?g:g[0],h.length>1?h:h[0]]},Wt=function(e,t,r,n,o,i,l,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"===n)p=Gt(e,t,r,s);else if("func"===n)p=Bt(e,t,r,s);else if("function"==typeof i.spelFormatValue){var d=i.spelFormatValue,f=[r,Pt(Pt({},fe()(l,["fieldSettings","listValues"])),{},{asyncListValues:c}),D()(i,q)];if(a&&(f.push(a),f.push(u)),"field"==n){var v=Vi(t,r)||{};f.push(v)}p=d.call.apply(d,[t.ctx].concat(f))}else p=St(r);return p}},Gt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,i=Vi(t,r)||{},l=ki(r,t),a=mo(r,t,n),u=t.settings.formatSpelField,s=Eo(r,t,e,n),c=a.map((function(e){var t,r=(0,V.Z)(e,3),n=r[0],i=r[1],l=r[2];return l&&(t="!struct"==l.type||"!group"==l.type&&"struct"==l.mode?i.isSpelMap?"map":"class":"!group"==l.type?i.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==i?void 0:i.isSpelVariable,fieldSeparator:o}}));return u.call(t.ctx,s,n,l,c,i,t)}},Bt=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=Ci(t,l);if(u){var s={},c=[],p=[];for(var d in u.args){var f,v,g=u.args[d],h=Vi(t,g),y=g.defaultValue,m=g.isOptional,b=null!=y&&y.func?"func":"value",O=a?a.get(d):void 0,S=O?O.get("value"):void 0,F=O?O.get("valueSrc"):void 0;"func"!==F&&null!==(f=S)&&void 0!==f&&f.toJS&&(S=S.toJS());var w=O?O.get("asyncListValues"):void 0,j=null===(v=g.spelEscapeForFormat)||void 0===v||v,E=null,C=jo(t,g,E,F),L=D()(xi(t,g,E,C,F),["factory"]),P=Wt(e,t,S,F,g.type,L,h,null,null,i,w);if(null!=S&&void 0===P)return void("func"!=F&&e.errors.push("Can't format value of arg ".concat(d," for func ").concat(l)));var _=void 0;if(void 0===P&&!m&&null!=y){var k=jo(t,g,E,b),Z=D()(xi(t,g,E,k,b),["factory"]);if(void 0===(_=Wt(e,t,y,b,g.type,Z,h,null,null,i,w)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(d," for func ").concat(l)))}var T=null!=P?P:_;if(void 0!==T){var V;if(c.length){var I,x=Et(c);try{for(x.s();!(I=x.n()).done;){var R=I.value;s[R]=void 0}}catch(e){x.e(e)}finally{x.f()}c=[]}s[d]=j?T:null!==(V=S)&&void 0!==V?V:y}else m||p.push(d),c.push(d)}if(!p.length){var A;if("function"==typeof u.spelFormatFunc){var N=u.spelFormatFunc,M=[s];A=N.call.apply(N,[t.ctx].concat(M))}else if(u.spelFunc){A=u.spelFunc.replace(/\${(\w+)}/g,(function(e,t){var r;return null!==(r=s[t])&&void 0!==r?r:e}));var q,W=Object.keys(u.args||{}).reverse().filter((function(e){return!!u.args[e].isOptional})),G=Et(W);try{for(G.s();!(q=G.n()).done;){var B=q.value;if(null!=s[B])break;A=A.replace(new RegExp("(, )?\\${"+B+"}","g"),"")}}catch(e){G.e(e)}finally{G.f()}A=A.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(l," is not supported"));return A}}else e.errors.push("Func ".concat(l," is not defined in config"))};function Ut(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ht={number:"number",string:"text",boolean:"boolean",null:"null"},Yt={String:"text"},Kt=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},Qt=function(e,t){return Xt(e,t,!0)},Xt=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={errors:[]},l=di(t,void 0,!1),a=rr(l),u=void 0;try{r=gt.SpelExpressionEvaluator.compile(e)._compiledExpression}catch(e){i.errors.push(e)}r&&(n=er(r,i),ae.debug("convertedObj:",n,i),(u=nr(n,a,l,i))&&"group"!=u.type&&"switch_group"!=u.type&&(u=mr(u,l,n.not)),ae.debug("jsTree:",u));var s=u?ze(u):void 0;return o?[s,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),s)},er=function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.getType(),l=t.getChildren().map((function(n){return e(n,r,t)}));if("op-or"!=i&&"op-and"!=i||(l=l.reduce((function(e,t){var r=t.type!=i||t.not?[t]:t.children;return[].concat((0,T.Z)(e),(0,T.Z)(r))}),[])),"op-not"==i)return 1!=l.length&&r.errors.push("Operator NOT should have 1 child, but got ".concat(l.length,"}")),Jt(Jt({},l[0]),{},{not:!l[0].not});if("compound"==i){var a=(l=l.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));a&&1!=a.children.length&&r.errors.push("Selection should have 1 child, but got ".concat(a.children.length));var u=a?a.children[0]:null,s=l[l.length-1],c="method"==s.type&&"size"==s.val.methodName||"!func"==s.type&&"size"==s.methodName,p="property"==s.type&&"length"==s.val,d=l.filter((function(e){return e!==a&&e!==s})),f={type:"compound",children:d};if((c||p)&&null!=ir(d))return{type:"!aggr",filter:u,source:f};if(l=(l=l.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"!func"==s.type){var v={},g=v;do{var h,y;Object.assign(g,s),l=l.filter((function(e){return e!==s})),"!func"==(null===(y=s=l[l.length-1])||void 0===y?void 0:y.type)?(g.obj={},g=g.obj):l.length>1?g.obj={type:"compound",children:l}:g.obj=s}while("!func"==(null===(h=s)||void 0===h?void 0:h.type));return v}}try{t.getRaw?n=t.getRaw():0==t.getValue.length&&(n=t.getValue())}catch(e){ae.error("[spel2js] Error in getValue()",e)}if("ternary"==i&&(n=tr(l)),"object"===(0,I.Z)(n)&&null!==n&&(n.methodName||n.functionName)&&(n.args=n.args.map((function(n){return e(n,r,t)}))),"list"==i&&(n=n.map((function(n){return e(n,r,t)})),!o&&1==n.length))return n[0];if("constructorref"==i){var m=l.find((function(e){return"qualifiedidentifier"==e.type})),b=null==m?void 0:m.val;return b?{type:"!new",cls:b,args:l.filter((function(e){return"qualifiedidentifier"!=e.type}))}:void r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(l)))}if("typeref"==i){var O=l.find((function(e){return"qualifiedidentifier"==e.type})),S=null==O?void 0:O.val;return S?(l.filter((function(e){return"qualifiedidentifier"!=e.type})),{type:"!type",cls:S}):void r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(l)))}if("function"==i||"method"==i){var F=n,w=F.functionName,j=F.methodName,E=F.args;return{type:"!func",methodName:w||j,isVar:"function"==i,args:E}}return{type:i,children:l,val:n}},tr=function(e){var t=[];return function e(r){var n=(0,V.Z)(r,3),o=n[0],i=n[1],l=n[2];t.push([o,i]),"ternary"==(null==l?void 0:l.type)?e(l.children):t.push([void 0,l])}(e),t},rr=function(e){var t={},r=function(r){var n=e.operators[r];if(n.spelOps)n.spelOps.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else if(n.spelOp){var o=n.spelOp;t[o]||(t[o]=[]),t[o].push(r)}else ae.log("[spel] No spelOp for operator ".concat(r))};for(var n in e.operators)r(n);var o={};for(var i in e.conjunctions)o[e.conjunctions[i].spelConj||i.toLowerCase()]=i;var l,a={},u=Ut(Oi(e));try{var s=function(){var e=(0,V.Z)(l.value,2),t=e[0],r=e[1],n=[],o=r.spelFunc;if("string"==typeof o){var i=Object.keys(r.args||{}).reverse().filter((function(e){return!!r.args[e].isOptional||null!=r.args[e].defaultValue})),u=o.replace(/\${(\w+)}/g,(function(e,t){return"?"})),s=i.reduce((function(e,t){return[].concat((0,T.Z)(e),[[t].concat((0,T.Z)(e[e.length-1]||[]))])}),[]).map((function(e){return o.replace(/(?:, )?\${(\w+)}/g,(function(t,r){return e.includes(r)?"":t})).replace(/\${(\w+)}/g,(function(e,t){return"?"}))}));n=[u].concat((0,T.Z)(s))}var c,p=Ut(n);try{for(p.s();!(c=p.n()).done;){var d=c.value;a[d]||(a[d]=[]),a[d].push(t)}}catch(e){p.e(e)}finally{p.f()}};for(u.s();!(l=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}var c={};for(var p in e.widgets){var d=e.widgets[p],f=d.spelImportFuncs;if(d.type,f){var v,g=Ut(f);try{for(g.s();!(v=g.n()).done;){var h=v.value;if("string"==typeof h){var y=h.replace(/\${(\w+)}/g,(function(e,t){return"?"})),m=(0,T.Z)(h.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,V.Z)(e,2);return t[0],t[1]}));c[y]||(c[y]=[]),c[y].push({w:p,argsOrder:m})}}}catch(e){g.e(e)}finally{g.f()}}}var b={};for(var O in e.operators){var S=e.operators[O].spelOp;if(null!=S&&S.includes("${0}")){var F=S.replace(/\${(\w+)}/g,(function(e,t){return"?"})),w=(0,T.Z)(S.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,V.Z)(e,2);return t[0],t[1]}));b[F]||(b[F]=[]),b[F].push({op:O,argsOrder:w})}}return b[_t.replace(/\${(\w+)}/g,(function(e,t){return"?"}))]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:a,valueFuncs:c,opFuncs:b}},nr=function e(t,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){var l,a=!0;if(0===t.type.indexOf("op-")||"matches"===t.type)l=or(t,r,n,o,i);else if("!aggr"==t.type){var u,s=e(t.source,r,n,o,Jt(Jt({},t),{},{_groupField:null==i?void 0:i._groupField})),c=e(t.filter,r,n,o,Jt(Jt({},t),{},{_groupField:null==s?void 0:s.value}));"rule"==(null===(u=c)||void 0===u?void 0:u.type)&&(c=mr(c,n,t.filter.not)),l={groupFilter:c,groupFieldValue:s},i||(l=void 0,o.errors.push("Unexpected !aggr in root"),a=!1)}else if("ternary"==t.type){var p={};t.val.forEach((function(e){var i=(0,V.Z)(e,2),l=i[0],a=i[1],u=gr(l,a,r,n,o,t);u&&(p[u.id]=u)})),l={type:"switch_group",id:N(),children1:p,properties:{}}}if(!l&&a&&(l=lr(t,r,n,o,i)),l&&!l.type&&!i){var d=vr(t,r,n,o);d?l=d:(l=void 0,o.errors.push("Can't convert rule of type ".concat(t.type,", it looks like var/literal")))}return l}},or=function e(t,r,n,o){var i,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=t.type.startsWith("op-")?t.type.slice(3):t.type;if(("minus"==a||"plus"==a)&&1==t.children.length)return t.isUnary=!0,e(t.children[0],r,n,o,t);var u="and"==a&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,s="or"==a&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type;if(u||s){var c=(0,V.Z)(t.children[0].children,2),p=c[0],d=c[1],f=(0,V.Z)(t.children[1].children,2),v=f[0],g=f[1];if(fr(p,v,t,r,n,o,l))return d.val,g.val,e({type:"op-between",children:[p,d,g],not:s},r,n,o,l)}var h=r.operators[a];"eq"==a&&"null"==t.children[1].type?h=["is_null"]:"ne"==a&&"null"==t.children[1].type?h=["is_not_null"]:"le"==a&&"string"==t.children[1].type&&""==t.children[1].val?h=["is_empty"]:"gt"==a&&"string"==t.children[1].type&&""==t.children[1].val?h=["is_not_empty"]:"between"==a&&(h=["between"]);var y=function(){var e,i=t.children.map((function(e){return nr(e,r,n,o,Jt(Jt({},t),{},{_groupField:null==l?void 0:l._groupField}))}));return i.length>=2&&"!compare"==(null===(e=i)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.type)&&(i=i[0].children),i};if("and"==a||"or"==a){var m={};y().forEach((function(e){if(e){var t=N();e.id=t,null!=e.type?m[t]=e:o.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),i={type:"group",id:N(),children1:m,properties:{conjunction:r.conjunctions[a],not:t.not}}}else if(h){var b,O,S=y(),F=S[0],w=S.slice(1),j=null==F||null===(b=F.groupFieldValue)||void 0===b?void 0:b.value,E=null===(O=w)||void 0===O?void 0:O[0],C=h[0];if(h.length>1){var L,P,_=(null===(L=S[0])||void 0===L?void 0:L.valueType)||(null===(P=S[1])||void 0===P?void 0:P.valueType),k=null==F?void 0:F.value,Z=h.map((function(e){return{op:e,widget:jo(n,k,e)}}));if(ae.warn("[spel] Spel operator ".concat(a," can be mapped to ").concat(h,"."),"widgets:",Z,"vals:",S,"valueType=",_),"eq"==a||"ne"==a){var T=Z.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));T&&(C=T.op)}}null!=F&&F.groupFieldValue&&(E&&E.groupFieldValue&&"field"==E.groupFieldValue.valueSrc&&E.groupFieldValue.value==j?(C="all",w=[]):"equal"==C&&"value"==E.valueSrc&&"number"==E.valueType&&0==E.value?(C="none",w=[]):"greater"==C&&"value"==E.valueSrc&&"number"==E.valueType&&0==E.value&&(C="some",w=[]));var I=!1;if(t.not){var x=n.operators[C];x.reversedOp?(C=x.reversedOp,t.not=!1):I=!0}if(F)if(F.groupFieldValue)"field"!=F.groupFieldValue.valueSrc&&o.errors.push("Expected group field ".concat(JSON.stringify(F))),i=dr(F,C,w,n,o);else{"field"!=F.valueSrc&&"func"!=F.valueSrc&&o.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(F)));var R=F.value;i=pr(n,o,R,C,w)}I&&("group"!==i.type?i=mr(i,n,t.not):i.properties.not=!i.properties.not)}else l||(i=vr(t,r,n,o));return i},ir=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;var o,i;n=!0,r&&(null==t||null===(o=t.errors)||void 0===o||null===(i=o.push)||void 0===i||i.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(e))))}));return n?void 0:o},lr=function e(t,r,n,o,i){if(null!=t){var l=n.settings.fieldSeparator;if("variable"==t.type||"property"==t.type){var a=ji(n,t.val,null==i?void 0:i._groupField),u=Vi(n,a),s="variable"==t.type;return{valueSrc:"field",valueType:null==u?void 0:u.type,isVariable:s,value:a}}if("compound"==t.type){var c=ir(t.children,o);if(c){var p,d=ji(n,c.join(l),null==i?void 0:i._groupField),f=Vi(n,d),v="variable"==(null===(p=t.children)||void 0===p||null===(p=p[0])||void 0===p?void 0:p.type);return{valueSrc:"field",valueType:null==f?void 0:f.type,isVariable:v,value:d}}}else{if(Ht[t.type]){var g=t.val,h=Ht[t.type];return null!=i&&i.isUnary&&(g=-g),{valueSrc:"value",valueType:h,value:g}}if("!new"==t.type&&Yt[t.cls.at(-1)]){var y=t.args.map((function(i){return e(i,r,n,o,t)})),m=null==y?void 0:y[0],b=Yt[t.cls.at(-1)];return Jt(Jt({},m),{},{valueType:b})}if("list"==t.type){var O,S=t.val.map((function(i){return e(i,r,n,o,t)}));return S.length&&(null===(O=S[0])||void 0===O||O.valueType),{valueSrc:"value",valueType:"multiselect",value:S.map((function(e){return null==e?void 0:e.value}))}}if("op-plus"==t.type&&"ternary"==(null==i?void 0:i.type))return hr(t,r,n,o)}var F=ur(t,r,n,o,i);if(void 0!==F)return F;o.errors.push("Can't convert arg of type ".concat(t.type))}},ar=function e(t,r){var n,o=[],i="",l=t.type,a=t.methodName,u=(t.val,t.obj),s=t.args,c=t.isVar,p=t.cls,d=t.children,f=null==d?void 0:d[d.length-1],v=r[r.length-1];if("!func"===l){for(var g=u;g;){var h,y=e(Jt(Jt({},g),{},{obj:null}),[{}]),m=(0,V.Z)(y,2),b=m[0],O=m[1];if("?"!==b){var S={s:v.s,params:(0,T.Z)(v.params),objs:(0,T.Z)(v.objs)};v.objs.unshift("?"),v.params.unshift(g),r.push(S),v=r[r.length-1]}v.objs.unshift(b),(h=v.params).unshift.apply(h,(0,T.Z)(O)),g="!func"===g.type?g.obj:null}var F,w=Ut(r);try{for(w.s();!(F=w.n()).done;){var j,E=F.value;o=[].concat((0,T.Z)((null==E?void 0:E.params)||[]),(0,T.Z)(s||[])),i="",null!=E&&null!==(j=E.objs)&&void 0!==j&&j.length&&(i+=E.objs.join(".")+"."),i+=(c?"#":"")+a,i+="("+(s||[]).map((function(e){return"?"})).join(", ")+")",E.s=i,E.params=o}}catch(e){w.e(e)}finally{w.f()}}else"!new"===l?(o=s||[],i="new ".concat(p.join("."),"(").concat(o.map((function(e){return"?"})).join(", "),")")):"!type"===l?i="T(".concat(p.join("."),")"):"compound"===l&&"property"===f.type&&(n=f.val,["length"].includes(n))?i=d.map((function(t){var r;if(t===f)return t.val;var n=e(Jt(Jt({},t),{},{obj:null}),[{}]),i=(0,V.Z)(n,2),l=i[0],a=i[1];return(r=o).push.apply(r,(0,T.Z)(a)),l})).join("."):(o=[t],i="?");return v&&(v.s=i,v.params=o),[i,o]},ur=function(e,t,r,n,o){var i,l=function(i){return lr(i,t,r,n,Jt(Jt({},e),{},{_groupField:null==o?void 0:o._groupField}))},a=function(e){var t=[{s:"",params:[],objs:[]}];return ar(e,t),t.map((function(e){return{s:e.s,params:e.params}})).reverse().filter((function(e){var t=e.s;return""!==t&&"?"!==t}))}(e),u=null==a||null===(i=a[0])||void 0===i?void 0:i.s;a.length&&ae.debug("Signatures for ",e,":",u,a);var s=sr(e,t,r,n,o,a,l);if(void 0!==s)return s;var c,p,d,f=cr(e,t,r,n,o,a,l);if(void 0!==f)return f;var v,g=Ut(a);try{var h=function(){var e=v.value,n=e.s,o=e.params,i=t.funcs[n];if(i){c=i[0];var a=(p=Ci(r,c)).spelFunc,u=o.map(l),s=(0,T.Z)(a.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,V.Z)(e,2);return t[0],t[1]}));return d=Object.fromEntries(s.map((function(e,t){return[e,u[t]]}))),"break"}};for(g.s();!(v=g.n()).done&&"break"!==h(););}catch(e){g.e(e)}finally{g.f()}if(!c){var y,m=Ut(Oi(r));try{for(m.s();!(y=m.n()).done;){var b=(0,V.Z)(y.value,2),O=b[0],S=b[1];if(S.spelImport){var F=void 0;try{F=S.spelImport(e)}catch(e){}if(F)for(var w in p=Ci(r,c=O),d={},F)d[w]=l(F[w])}}}catch(e){m.e(e)}finally{m.f()}}if(c){var j={};for(var E in p.args){var C,L=p.args[E],P=d[E];if(void 0===P)if(void 0===(P=null==L?void 0:L.defaultValue)){if(null==L||!L.isOptional)return void n.errors.push("No value for arg ".concat(E," of func ").concat(c))}else P={value:P,valueSrc:null!==(C=P)&&void 0!==C&&C.func?"func":"value",valueType:L.type};P&&(j[E]=P)}return{valueSrc:"func",value:{func:c,args:j},valueType:p.returnType}}e.methodName&&n.errors.push("Signature ".concat(u," - failed to convert"))},sr=function(e,t,r,n,o,i,l){var a,u,s,c=[];for(var p in r.widgets){var d=r.widgets[p].spelImportFuncs;if(d)for(var f=0;f<d.length;f++){var v=d[f];if(Kt(v)){var g={};if(oe(v,e,g)){for(var h in g)g[h]=l(g[h]);c.push({s:"widgets.".concat(p,".spelImportFuncs[").concat(f,"]"),w:p,argsObj:g})}}}}var y,m=Ut(i);try{for(m.s();!(y=m.n()).done;){var b,O=y.value,S=O.s,F=O.params,w=Ut(t.valueFuncs[S]||[]);try{var j=function(){var e=b.value,t=e.w,r=e.argsOrder,n=F.map(l),o=Object.fromEntries(r.map((function(e,t){return[e,n[t]]})));c.push({s:S,w:t,argsObj:o})};for(w.s();!(b=w.n()).done;)j()}catch(e){w.e(e)}finally{w.f()}}}catch(e){m.e(e)}finally{m.f()}for(var E=0,C=c;E<C.length;E++){var L=C[E],P=L.s,_=L.w,k=L.argsObj,Z=r.widgets[_],T=Z.spelImportValue,I=Z.type;for(var x in s=_,u=P,a=[],k)["value"].includes(k[x].valueSrc)||a.push("".concat(x," has unsupported value src ").concat(k[x].valueSrc));var R=k.v.value;if(T&&!a.length){var D=T.call(r.ctx,k.v,Z,k),A=(0,V.Z)(D,2);R=A[0],(a=A[1])&&!Array.isArray(a)&&(a=[a])}if(!a.length)return{valueSrc:"value",valueType:I,value:R}}s&&a.length&&n.errors.push("Signature ".concat(u," - looks like convertable to ").concat(s,", but: ").concat(a.join("; ")))},cr=function(e,t,r,n,o,i,l){var a,u,s,c,p=Ut(i);try{for(p.s();!(c=p.n()).done;){var d,f=c.value,v=f.s,g=f.params,h=Ut(t.opFuncs[v]||[]);try{var y=function(){var t,i=d.value,c=i.op,p=i.argsOrder,f=g.map(l);if(u=c,"!compare"===c){if(o.type.startsWith("op-")&&2==o.children.length&&"number"==o.children[1].type&&0===o.children[1].val)return{v:{type:"!compare",children:f}};a.push("Result of compareTo() should be compared to 0")}s=v,a=[];var h=r.operators[u],y=(h.spelOp,h.valueTypes),m=Object.fromEntries(p.map((function(e,t){return[e,f[t]]}))),b=m[0],O=Object.keys(m).filter((function(e){return parseInt(e)>0})).map((function(e){return m[e]})),S=null===(t=f.filter((function(e){return!!e})).find((function(e){return"value"===e.valueSrc})))||void 0===t?void 0:t.valueType;if(y&&S&&!y.includes(S)&&a.push("Op supports types ".concat(y,", but got ").concat(S)),!a.length)return{v:pr(r,n,b,u,O,e)}};for(h.s();!(d=h.n()).done;){var m=y();if("object"===(0,I.Z)(m))return m.v}}catch(e){h.e(e)}finally{h.f()}}}catch(e){p.e(e)}finally{p.f()}u&&a.length&&n.errors.push("Signature ".concat(s," - looks like convertable to ").concat(u,", but: ").concat(a.join("; ")))},pr=function(e,t,r,n,o,i){var l;if(!o.filter((function(e){return void 0===e})).length){var a=null!==(l=r)&&void 0!==l&&l.func?"func":"field";Kt(r)&&r.valueSrc&&(a=r.valueSrc,r=r.value);var u=Vi(e,r);if(u){var s=!1;if(null!=i&&i.not){var c=e.operators[n];c.reversedOp?(n=c.reversedOp,i.not=!1):s=!0}var p=jo(e,r,n),d=e.widgets[p||u.mainWidget],f=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),v=f.length?f[0]:void 0,g={type:"rule",id:N(),properties:Jt({field:r,fieldSrc:a,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==d?void 0:d.type)||(null==u?void 0:u.type))||e.valueType}))},v?{asyncListValues:v}:{})};return s&&(g=mr(g,e,null==i?void 0:i.not),null!=i&&i.not&&(i.not=!1)),g}t.errors.push("No config for field ".concat(r))}},dr=function(e,t,r,n,o){var i=e.groupFilter,l=e.groupFieldValue;if("field"!=l.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(l));var a=l.value,u=pr(n,o,a,t,r);if(u){var s,c=Vi(n,a),p=null==c?void 0:c.mode;return(s="group"===(null==i?void 0:i.type)?Jt(Jt({},i||{}),{},{type:"rule_group",properties:Jt(Jt(Jt({},u.properties),(null==i?void 0:i.properties)||{}),{},{mode:p})}):Jt(Jt({},u||{}),{},i?{type:"rule_group",children1:[i],properties:Jt(Jt({},u.properties),{},{mode:p})}:{type:"rule_group",properties:Jt(Jt({},u.properties),{},{mode:p})})).id||(s.id=N()),s}},fr=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(e.type==t.type){if("!aggr"==e.type){var a=[e.source,t.source].map((function(e){return lr(e,n,o,i,Jt(Jt({},r),{},{_groupField:null==l?void 0:l._groupField}))})),u=(0,V.Z)(a,2),s=u[0],c=u[1];return s.value==c.value}var p=[e,t].map((function(e){return lr(e,n,o,i,Jt(Jt({},r),{},{_groupField:null==l?void 0:l._groupField}))})),d=(0,V.Z)(p,2),f=d[0],v=d[1];return f.value==v.value}return!1},vr=function(e,t,r,n){var o={},i=gr(null,e,t,r,n);return i&&(o[i.id]=i),{type:"switch_group",id:N(),children1:o,properties:{}}},gr=function(e,t,r,n,o){var i,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=yr(n,o,r,t,l);return e?(i=nr(e,r,n,o,l))&&i.type?("group"!=i.type&&(i=mr(i,n)),i.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0):i={id:N(),type:"case_group",properties:{}},i&&(i.properties=Jt(Jt({},i.properties),a)),i},hr=function(e,t,r,n){var o=[];return function i(l){l.map((function(l){if("op-plus"==l.type)i(l.children);else{var a=lr(l,t,r,n,e);a?o.push(a):n.errors.push("Can't convert ".concat(l.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},yr=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l={};o="op-plus"==(null==n?void 0:n.type)?hr(n,r,e,t):lr(n,r,e,t,i);var a=e.widgets.case_value,u=null==a?void 0:a.spelImportValue;if(u){var s=u(o),c=(0,V.Z)(s,2),p=c[0];c[1].map((function(e){return t.errors.push(e)})),p&&(l={value:[p],valueSrc:["value"],valueType:["case_value"]})}else t.errors.push("No fucntion to import case value");return l},mr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:N(),children1:(0,Z.Z)({},e.id,e),properties:{conjunction:Pr(t),not:r||!1}}};function br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Sr=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.settings.defaultField,o=(r?Fr(e,r):n)||t&&Ri(e,r)||null;return null==o||"string"==typeof o||z(o)||(o=He(o)),o},Fr=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return null;var n=(null==e||null===(t=e.settings)||void 0===t?void 0:t.fieldSeparator)||".",o=Vi(e,r),i=null==o?void 0:o.defaultField;return i&&(i=[].concat((0,T.Z)(ki(r)),[i]).join(n)),i},wr=function(e){var t;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=e.settings.fieldSources)||void 0===t?void 0:t[0])||"field"},jr=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e.settings.defaultOperator,o=Vi(e,t),i=(null==o?void 0:o.operators)||[];n&&!i.includes(n)&&(n=null);var l=null==o?void 0:o.defaultOperator;return l&&!i.includes(l)&&(l=null),!l&&r&&(l=vo(e,t)),(null==o?void 0:o._origDefaultOperator)&&l||n||l},Er=function(e,t,r){var n=t?Ii(e,t,r):null;return n&&n.options?new x.ZP.Map(n.options&&n.options.defaults||{}):null},Cr=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=null,s=null,c=null,p=e.settings.showErrorMessage;i?(c=null==i||null===(t=i.properties)||void 0===t?void 0:t.fieldSrc,u=null==i||null===(r=i.properties)||void 0===r?void 0:r.field,s=null==i||null===(n=i.properties)||void 0===n?void 0:n.operator):l?(c=(u=Sr(e,a,o))?z(u)?"func":"field":wr(e),s=jr(e,u,!0)):c=wr(e);var d=new x.ZP.Map({fieldSrc:c,field:u,operator:s,value:new x.ZP.List,valueSrc:new x.ZP.List,operatorOptions:Er(e,s,u)});if(p&&(d=d.set("valueError",new x.ZP.List)),u&&s){var f=eo(e,e,d,u,s,"operator",!1),v=f.newValue,g=f.newValueSrc,h=f.newValueType,y=f.newValueError,m=f.newFieldError;d=d.set("value",v).set("valueSrc",g).set("valueType",h),p&&(d=d.set("valueError",y).set("fieldError",m))}return d},Lr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(t=Vi(e,t))&&t.conjunctions||Object.keys(e.conjunctions);return 1==r.length?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},Pr=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},_r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new x.ZP.Map({conjunction:Lr(e,t),not:!1})},kr=function(e,t){var r;return t&&"group"==t.type?_r(e,null==t||null===(r=t.properties)||void 0===r?void 0:r.field):Cr(e,null,t)},Zr=function(e,t){return(0,Z.Z)({},e,new x.ZP.Map({type:"rule",id:e,properties:Cr(t)}))},Tr=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new x.ZP.Map({type:"group",id:N(),children1:new x.ZP.OrderedMap(t?Or({},Zr(N(),e)):{}),properties:_r(e)})},Vr=function(e){return new x.ZP.List(e)},Ir=function(){return new x.ZP.Map};function xr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Rr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Nr,Mr=function(e,t){var r={errors:[],settings:{isForDisplay:arguments.length>2&&void 0!==arguments[2]&&arguments[2],isDebugMode:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},n=di(t,void 0,!1),o=qr(e,n,r,null);return r.errors.length&&console.warn("Errors while exporting to string:",r.errors),o},qr=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return e.get("children1"),"group"===o||"rule_group"===o?Wr(e,t,r,n):"rule"===o?Gr(e,t,r,n):void 0}},Wr=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=r.settings,a=l.isForDisplay,u=l.isDebugMode,s=e.get("type"),c=e.get("properties")||new x.D5,p=c.get("mode"),d=e.get("children1")||new x.aV,f="rule_group"===s,v=f&&"array"==p?c.get("field"):null,g="rule_group"===s?c.get("operator"):null,h=g?null!==(n=null===(o=t.operators[g])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1:void 0,y=f&&"array"===p&&h>=1,m=c.get("not"),b=d.map((function(e){return qr(e,t,r,v)})).filter((function(e){return void 0!==e}));if(y||b.size||u){var O=c.get("conjunction");O||(O=Pr(t));var S,F=t.conjunctions[O],w=b.size?F.formatConj(b,O,m,a):null;if(v){var j=Gr(e,t,r,i,!0);if(j){var E,C=j.pop(),L=[w].concat((0,T.Z)(j));S=(E=t.settings).formatAggr.apply(E,(0,T.Z)(L)),C&&(S=t.settings.formatReverse(S,null,null,null,null,a))}}else S=w;return u&&null==S&&(S="?"),S}},Gr=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=r.settings,l=i.isForDisplay,a=i.isDebugMode,u=e.get("properties")||new x.D5,s=u.get("field"),c=u.get("fieldSrc"),p=u.get("operator"),d=u.get("operatorOptions");if(null!=s&&null!=p||a){var f=Vi(t,s)||{},v=Ii(t,p,s)||{},g=v.reversedOp,h=Ii(t,g,s)||{},y=!1,m=v.formatOp;if(!m&&g&&(m=h.formatOp)){y=!0;var b=[g,p];p=b[0],g=b[1];var O=[h,v];v=O[0],h=O[1]}if(a&&!p&&(p="?"),m||(m=function(e,t,r){var n,o=r.settings.isDebugMode,i=(null==t?void 0:t.labelForFormat)||e,l=G(t);return 0==l?n=function(e,t,r,n,o,l,a,u){return"".concat(e," ").concat(i)}:1==l?n=function(e,t,r,n,l,a,u,s){return o&&"?"===t&&"?"===r?e&&"?"!==e?"".concat(e," ?"):"?":"".concat(e," ").concat(i," ").concat(r)}:2==l&&(n=function(e,t,r,n,o,l,a,u){var s,c,p=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),d=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(i," ").concat(p," AND ").concat(d)}),n}(p,v,r)),m){var S="func"===c?zr(t,r,s,n):Ur(t,r,s,n);if(null!=S){var F=function(e,t,r,n,o){var i,l,a=r.settings,u=(a.isForDisplay,a.isDebugMode),s=t.get("field"),c=t.get("valueSrc"),p=t.get("valueType"),d=Vi(e,s)||{},f=n||t.get("operator"),v=Ii(e,f,s)||{},g=G(v),h=t.get("value"),y=t.get("asyncListValues"),m=[],b=[];return null!=h&&!((l=h.map((function(t,n){var i=c?c.get(n):null,l=p?p.get(n):null,a=u?t:xo(t,i,e),g=jo(e,s,f,i),h=D()(xi(e,s,f,g,i),["factory"]),O=Br(e,r,a,i,l,h,d,f,v,o,y);return void 0!==O&&(m.push(i),b.push(l)),O}))).filter((function(e){return void 0===e})).size>0)&&l.size===g&&(i=1==g?l.first():l),u&&!i&&(i=g>1?new x.aV(Array.from({length:g}).map((function(e,t){var r,n;return null!==(r=null===(n=l)||void 0===n?void 0:n.get(t))&&void 0!==r?r:"?"}))):"?"),[i,m.length>1?m:m[0],b.length>1?b:b[0]]}(t,u,r,p,n),w=(0,V.Z)(F,3),j=w[0],E=w[1],C=w[2];if(void 0!==j){var L=[S,p,j,E,C,D()(v,W),d,l,f,y];if(o)return L;var P,_=(P=m).call.apply(P,[t.ctx].concat(L));return y&&(_=t.settings.formatReverse(_,p,g,v,h,l)),_}}}}},Br=function(e,t,r,n,o,i,l,a,u){var s,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,p=arguments.length>10?arguments[10]:void 0,d=t.settings,f=d.isForDisplay,v=d.isDebugMode;if(void 0===r)return v?"array"===(null==i?void 0:i.jsType)?[]:"?":void 0;if("field"==n)s=Ur(e,t,r,c);else if("func"==n)s=zr(e,t,r,c);else if("function"==typeof i.formatValue){var g=i.formatValue,h=[r,Ar(Ar({},fe()(l,["fieldSettings","listValues"])),{},{asyncListValues:p}),D()(i,q),f];if(a&&(h.push(a),h.push(u)),"field"==n){var y=Vi(e,r)||{};h.push(y)}s=g.call.apply(g,[e.ctx].concat(h))}else s=r;return s},Ur=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.settings,l=i.isForDisplay,a=i.isDebugMode,u=e.settings,s=(u.fieldSeparator,u.fieldSeparatorDisplay),c=null;if(r){var p=Vi(e,r)||{},d=ki(r,e),f=yo(r,e,o?n:null),v=f?f.join(s):null,g=p.label2||v;c=(0,e.settings.formatField)(Eo(r,e,t,o?n:null,{useTableName:!0}),d,g,p,e,l)}else a&&(c="?");return c},zr=function(e,t,r){var n,o,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.settings,u=a.isForDisplay,s=a.isDebugMode,c=null==r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func");if(!c)return s?"?()":void 0;var p=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),d=Ci(e,c);if(d||s){var f,v=ki(c,e),g=v[v.length-1],h=u&&(null==d?void 0:d.label)||g,y={},m=[],b=[],O={},S=xr(d?Object.keys(d.args||{}):(null==p||null===(i=p.keySeq)||void 0===i?void 0:i.call(p).toArray())||[]);try{for(S.s();!(f=S.n()).done;){var F,w=f.value,j=null==d?void 0:d.args[w],E=Vi(e,j),C=j||{},L=C.defaultValue,P=C.isOptional,_=null!=L&&L.func?"func":"value",k=u&&(null==j?void 0:j.label)||w,Z=p?p.get(w):void 0,T=Z?Z.get("value"):void 0,I=Z?Z.get("valueSrc"):void 0;"func"!==I&&null!==(F=T)&&void 0!==F&&F.toJS&&(T=T.toJS());var x=Z?Z.get("asyncListValues"):void 0,R=Br(e,t,T,I,null==j?void 0:j.type,E,j,null,null,l,x);null!=T&&void 0===R&&"func"!=I&&t.errors.push("Can't format value of arg ".concat(w," for func ").concat(c));var D=void 0;if(void 0===R&&!P&&null!=L&&void 0===(D=Br(e,t,L,_,null==j?void 0:j.type,E,j,null,null,l,x)))return void("func"!=_&&t.errors.push("Can't format default value of arg ".concat(w," for func ").concat(c)));var A=null!=R?R:D;if(void 0!==A){if(m.length){var N,M=xr(w);try{for(M.s();!(N=M.n()).done;){var q=(0,V.Z)(N.value,2),W=q[0];q[1],y[W]=void 0}}catch(e){M.e(e)}finally{M.f()}m=[]}y[w]=A,O[k]=A}else P||b.push(w),m.push([w,k])}}catch(e){S.e(e)}finally{S.f()}if(!b.length||s){var G=null;if("function"==typeof(null==d?void 0:d.formatFunc)){var B=d.formatFunc,U=[y,u];G=B.call.apply(B,[e.ctx].concat(U))}else{var z=Object.entries(u?O:y).map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return u?"".concat(r,": ").concat(n):"".concat(n)})).join(", ");G="".concat(h,"(").concat(z,")")}return G}}else t.errors.push("Func ".concat(c," is not defined in config"))},$r="EMPTY_GROUP",Jr="EMPTY_RULE_GROUP",Hr="EMPTY_QUERY",Yr="EMPTY_CASE",Kr="NO_CONFIG_FOR_FIELD",Qr="NO_CONFIG_FOR_OPERATOR",Xr="NO_CONFIG_FOR_FUNCTION",en="INVALID_VALUE",tn="INVALID_FUNC_ARG_VALUE",rn="UNSUPPORTED_FIELD_TYPE",nn="UNSUPPORTED_OPERATOR_FOR_FIELD",on="INVALID_VALUE_SRC",ln="INCOMPLETE_RULE",an="INCOMPLETE_LHS",un="INCOMPLETE_RHS",sn="BAD_MULTISELECT_VALUES",cn="BAD_SELECT_VALUE",pn="INCORRECT_VALUE_TYPE",dn="INCORRECT_VALUE_JS_TYPE",fn="VALUE_LENGTH_CONSTRAINT_FAIL",vn="VALUE_MIN_CONSTRAINT_FAIL",gn="VALUE_MAX_CONSTRAINT_FAIL",hn="NO_CONFIG_FOR_FIELD_VALUE",yn="CANT_COMPARE_FIELD_WITH_ITSELF",mn="CANT_COMPARE_FIELD_WITH_FIELD",bn="INCORRECT_FIELD_TYPE",On="UNSUPPORTED_FUNCTION_FOR_FIELD",Sn="REQUIRED_FUNCTION_ARG",Fn="INCORRECT_FUNCTION_RETURN_TYPE",wn="INVALID_RANGE",jn="ITEM_POSITION",En="ITEM_POSITION_ROOT",Cn="ITEM_POSITION_WITH_INDEX_PATH",Ln="ITEM_POSITION_IN_CASE",Pn=r(89932),_n=(Nr={},(0,Z.Z)(Nr,$r,"Empty group"),(0,Z.Z)(Nr,Jr,"No conditions for group field {{field}}"),(0,Z.Z)(Nr,Hr,"Empty query"),(0,Z.Z)(Nr,Yr,"Empty case"),(0,Z.Z)(Nr,Kr,"No config for field {{field}}"),(0,Z.Z)(Nr,"FIXED_OPERATOR","Fixed operator {{from}} to {{to}} for field {{field}}"),(0,Z.Z)(Nr,Qr,"No config for operator {{operator}}"),(0,Z.Z)(Nr,Xr,"No config for function {{funcKey}}"),(0,Z.Z)(Nr,en,"Invalid value"),(0,Z.Z)(Nr,tn,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,Z.Z)(Nr,rn,"Type of field {{field}} is not supported"),(0,Z.Z)(Nr,nn,"Operator {{operator}} is not supported for field {{field}}"),(0,Z.Z)(Nr,ln,"Incomplete rule"),(0,Z.Z)(Nr,an,"Incomplete LHS"),(0,Z.Z)(Nr,un,"Incomplete RHS"),(0,Z.Z)(Nr,on,"Invalid value src {{valueSrcs, list}}"),(0,Z.Z)(Nr,sn+"_one","Value {{badValues, list}} is not in the list of allowed values"),(0,Z.Z)(Nr,sn+"_other","Values {{badValues, list}} are not in the list of allowed values"),(0,Z.Z)(Nr,cn,"Value {{value}} is not in the list of allowed values"),(0,Z.Z)(Nr,pn,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,Z.Z)(Nr,dn,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),(0,Z.Z)(Nr,fn,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),(0,Z.Z)(Nr,vn,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),(0,Z.Z)(Nr,gn,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),(0,Z.Z)(Nr,hn,"No config for field {{field}}"),(0,Z.Z)(Nr,yn,"Can't compare field {{field}} with itself"),(0,Z.Z)(Nr,mn,"Can't compare field {{leftField}} with {{rightField}}"),(0,Z.Z)(Nr,bn,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,Z.Z)(Nr,On,"Unsupported function {{funcKey}} for field {{field}}"),(0,Z.Z)(Nr,Sn,"Value of arg {{argName}} for func {{funcName}} is required"),(0,Z.Z)(Nr,Fn,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),(0,Z.Z)(Nr,wn,"Invalid range"),(0,Z.Z)(Nr,En,"Root"),(0,Z.Z)(Nr,jn+"__rule","Leaf #{{globalLeafNo}}"),(0,Z.Z)(Nr,jn+"__group","Group #{{globalGroupNo}}"),(0,Z.Z)(Nr,jn+"__rule_group","Rule-group #{{globalNoByType}}"),(0,Z.Z)(Nr,jn+"__case_group","Case #{{globalNoByType}}"),(0,Z.Z)(Nr,jn+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,Z.Z)(Nr,jn+"__group__deleted","Deleted group #{{globalGroupNo}}"),(0,Z.Z)(Nr,jn+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),(0,Z.Z)(Nr,jn+"__case_group__deleted","Deleted case #{{globalNoByType}}"),(0,Z.Z)(Nr,Ln,"{{str}} in case #{{caseNo}}"),(0,Z.Z)(Nr,Cn,"{{str}} (index path: {{indexPath, list}})"),Nr),kn="raqbvalidation",Zn="".concat(kn,":"),Tn=Pn.ZP.createInstance();Tn.init({fallbackLng:"en"}),Tn.addResources("en",kn,_n);var Vn=function e(t,r){return null!=t&&t.str?t.str:null!=t&&t.key?e(t.key,t.args):null===r?t:Tn.t(t.includes(":")?t:Zn+t,r)};const In=Tn;function xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Dn=function(e){return"object"===(0,I.Z)(e)&&null!==e&&Array.isArray(e)?"array":(0,I.Z)(e)},An=function(e,t){return 0===Nn(e,t).length},Nn=function(e,t){var r=t.settings.showErrorMessage,n=[];return e&&function e(t,o,i){var l,a,u=t.get("id"),s=t.get("children1"),c=t.getIn(["properties","valueError"]),p=t.getIn(["properties","fieldError"]),d=t.getIn(["properties","field"]),f=null!==(l=null==d||null===(a=d.get)||void 0===a?void 0:a.call(d,"func"))&&void 0!==l?l:d;((null==c?void 0:c.size)>0&&c.filter((function(e){return null!=e})).size>0||!!p)&&r&&n.push(f),s&&s.map((function(t,r){t&&e(t,o.concat(u),i+1)}))}(e,[],0),Array.from(new Set(n))},Mn=function(e,t){var r=di(t,void 0,!0),n={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=Bn(e,null,r,r,n),i=o.fixedTree,l=o.allErrors;return o.isSanitized&&l.length&&console.warn("Tree check errors: ",l),i},qn=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=di(t,void 0,!0),o=Rn(Rn({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1});return Bn(e,null,n,n,o).allErrors},Wn=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=di(t,void 0,!0),o=Rn({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),i=Bn(e,null,n,n,o);return{fixedTree:i.fixedTree,fixedErrors:i.fixedErrors,nonFixedErrors:i.nonFixedErrors,allErrors:i.allErrors}},Gn=function(e,t,r,n,o,i,l){void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===i&&(i=r.settings.removeEmptyRulesOnLoad),void 0===l&&(l=r.settings.removeIncompleteRulesOnLoad);var a=Bn(e,t,r,n,{removeEmptyGroups:o,removeEmptyRules:i,removeIncompleteRules:l,forceFix:!1}),u=a.fixedTree,s=(a.allErrors,a.fixedErrors);return a.nonFixedErrors,a.isSanitized&&s.length&&console.warn("Fixed tree errors: ",s),xe(u)},Bn=function(e,t,r,n,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var i,l,a=o||{},u=a.removeEmptyGroups,s=a.removeEmptyRules,c=a.removeIncompleteRules,p=a.forceFix,d=a.translateErrors,f=void 0===d||d,v=a.includeStringifiedItems,g=void 0===v||v,h=a.stringifyFixedItems,y=void 0!==h&&h,m=a.stringifyItemsUserFriendly,b=void 0===m||m,O=a.includeItemsPositions,S=void 0===O||O,F={errors:{}},w=$n(e,[],null,F,{config:r,oldConfig:n,removeEmptyGroups:u,removeEmptyRules:s,removeIncompleteRules:c,forceFix:p}),j=F.sanitized,E=[];for(var C in S&&(i=De(w).items),F.errors){var L=F.errors[C],P=L.path,_=L.errors;f&&(_=_.map((function(e){return Rn(Rn({},e),{},{str:Vn(e)})})));var k={path:P,errors:_};if(g){var Z=Ve(y?w:e,P);if(1!==P.length&&"group"!==Z.get("type")){var T=Mr(Z,r,b,!0);k.itemStr=T}}if(S){var V=i[C],I=!V;if(I&&(l||(l=De(e).items),V=l[C]),V){var x=Rn(Rn({},V.position),{},{index:V.index,type:V.type,isDeleted:I});k.itemPosition=x;var R=V.index?jn+"__"+V.type+(I?"__deleted":""):En,D=Rn({},x);if(b){for(var A,N=0,M=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];N<M.length;N++){var q=M[N];null!=D[q]&&(D[q]=D[q]+1)}D.indexPath=null===(A=x.indexPath)||void 0===A?void 0:A.map((function(e){return e+1}))}k.itemPositionStr=Vn(R,D),V.index&&(V.caseId&&"case_group"!==V.type&&(k.itemPositionStr=Vn(Ln,Rn(Rn({},D),{},{str:k.itemPositionStr}))),k.itemPositionStr=Vn(Cn,Rn(Rn({},D),{},{str:k.itemPositionStr})))}}E.push(k)}for(var W=[],G=[],B=0,U=E;B<U.length;B++){var z=U[B],$=z.errors.filter((function(e){return!!e.fixed})),J=z.errors.filter((function(e){return!e.fixed&&"EMPTY_QUERY"!==e.key}));$.length&&W.push(Rn(Rn({},z),{},{errors:$})),J.length&&G.push(Rn(Rn({},z),{},{errors:J}))}return{fixedTree:w,allErrors:E,fixedErrors:W,nonFixedErrors:G,isSanitized:j}};function Un(e,t,r,n){var o=t.get("id");e.errors[o]||(e.errors[o]={path:[].concat((0,T.Z)(r),[o]),errors:[]}),e.errors[o].errors.push(n)}function zn(e,t){var r=t.get("id");e.errors[r]&&e.errors[r].errors.map((function(e){e.fixed=!0}))}function $n(e,t,r,n,o){var i=null==e?void 0:e.get("type");return"group"===i||"rule_group"===i||"case_group"==i||"switch_group"==i?function(e,t,r,n,o){var i,l,a,u,s,c,p=o.removeEmptyGroups,d=o.removeIncompleteRules,f=(o.forceFix,o.config),v=(f.settings.showErrorMessage,e.get("id")),g=e.get("children1"),h=!t.length,y=g,m=e.get("type"),b=e.get("properties"),O=null==b?void 0:b.get("field"),S=null==b?void 0:b.get("mode"),F=null==b||null===(i=b.get)||void 0===i?void 0:i.call(b,"operator"),w="rule_group"===m&&"array"===S,j="case_group"===m,E=j&&null==g,C=F?null!==(l=null===(a=f.operators[F])||void 0===a?void 0:a.cardinality)&&void 0!==l?l:1:void 0,L=j?!E:!w||0==C;!v&&r&&(v=r,e=e.set("id",v),n.sanitized=!0),w&&(e=Jn(e,t,r,n,o));var P={errors:{}},_=null===(s=g=null===(u=g)||void 0===u?void 0:u.map((function(e,r){return $n(e,t.concat(v),r,P,o)})))||void 0===s?void 0:s.filter((function(e){return null!=e}));p&&(g=_);var k=P.sanitized||(null==y?void 0:y.size)!=(null===(c=g)||void 0===c?void 0:c.size),Z=p&&!h;return w&&O&&(Z=d),!(null!=_&&_.size)&&L&&(Un(n,e,t,{key:h?Hr:j?Yr:w?Jr:$r,args:{field:O},fixed:Z}),Z&&(zn(n,e),e=void 0)),k&&(n.sanitized=!0),k&&e&&(e=e.set("children1",g)),n.errors=Rn(Rn({},n.errors),(null==P?void 0:P.errors)||{}),e}(e,t,r,n,o):"rule"===i?Jn(e,t,r,n,o):e}function Jn(e,t,r,n,o){var i=o.removeIncompleteRules,l=o.removeEmptyRules,a=o.forceFix,u=o.config,s=o.oldConfig,c=u.settings.showErrorMessage,p=!c||a,d=e.get("id"),f=e.get("properties");if(f){var v=f.get("field")||null,g=f.get("fieldSrc")||null,h=f.get("operator")||null,y=f.get("operatorOptions"),m=f.get("valueSrc"),b=f.get("value"),O=f.get("valueError"),S=f.get("fieldError"),F=function(){var e,t;return{field:(null===(e=v)||void 0===e||null===(t=e.toJS)||void 0===t?void 0:t.call(e))||v,fieldSrc:g,operator:h,operatorOptions:y?y.toJS():{},valueSrc:m?m.toJS():null,value:b?b.toJS():null,valueError:O?O.toJS():null,fieldError:S||null}},w=F();!d&&r&&(d=r,e=e.set("id",d),n.sanitized=!0);var j=v?Vi(u,v):null;v&&!j&&(Un(n,e,t,{key:Kr,args:{field:v},side:"lhs",fixed:i||l}),v=null),null==v&&(f=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce((function(e,t){return e.delete(t)}),f),h=null),g||(g=Ti(v),f=f.set("fieldSrc",g)),"range_between"!==h&&"range_not_between"!==h||(h="range_between"===h?"between":"not_between",f=f.set("operator",h));var E=h?Ii(u,h,v):null;h&&!E&&(Un(n,e,t,{key:Qr,args:{operator:h},side:"op",fixed:i||l}),h=null);var C=v?fo(u,v):[];v&&(null!=C&&C.length?h&&-1==C.indexOf(h)&&("is_empty"===h||"is_not_empty"===h?(h="is_empty"===h?"is_null":"is_not_null",f=f.set("operator",h)):(Un(n,e,t,{key:nn,args:{operator:h,field:v},side:"lhs",fixed:i||l}),h=null)):(Un(n,e,t,{key:rn,args:{field:v},side:"lhs",fixed:i||l}),h=null)),null==h&&(f=["operatorOptions","valueSrc","value","valueError"].reduce((function(e,t){return e.delete(t)}),f)),y=f.get("operatorOptions"),!h||y&&!E.options?(y=null,f=f.delete("operatorOptions")):h&&!y&&E.options&&(y=Er(u,h,v),f=f.set("operatorOptions",y)),m=f.get("valueSrc"),b=f.get("value");var L=eo(u,s,f,v,h,null,p,!0),P=L.newValue,_=L.newValueSrc,k=L.newValueError,Z=L.validationErrors,T=L.newFieldError,V=L.fixedField;b=P,m=_,O=k,S=T,v=V,f=(f=(f=f.set("field",v)).set("value",b)).set("valueSrc",m),f=c?f.set("valueError",O).set("fieldError",S):f.delete("valueError").delete("fieldError");var I=F(),x=!B(w,I),R=Vo(f.toObject(),u),D=R.score>=3;if(x&&(n.sanitized=!0,e=e.set("properties",f)),null==Z||Z.map((function(r){return Un(n,e,t,r)})),!D){var A=R.score?i:l,N={key:ln,args:{}};if(R.parts.field){if(!R.parts.value){var M,q,W,G;N.key=un,N.side="rhs",null!==(M=I.valueSrc)&&void 0!==M&&M[0]&&(null===(q=I.valueSrc)||void 0===q?void 0:q[0])!=(null===(W=w.valueSrc)||void 0===W?void 0:W[0])&&null!=(null===(G=I.value)||void 0===G?void 0:G[0])&&(N.key=on,N.args={valueSrcs:I.valueSrc})}}else N.key=an,N.side="lhs";N.fixed=A,Un(n,e,t,N),A&&(zn(n,e),e=void 0)}return e}Un(n,e,t,{key:ln,args:{},fixed:i||l})}var Hn=function(e,t,r,n,o,i,l,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=[],d=o;if(null!=o){var f,v,g,h;if("field"===l){var y=Kn(t,r,o,l,i,a,e,n,u,s),m=(0,V.Z)(y,2);d=m[0],p=m[1]}else if("func"===l){var b=Qn(t,r,o,l,i,a,e,n,u,s,c),O=(0,V.Z)(b,2);d=O[0],p=O[1]}else if("value"===l||!l){var S=Yn(r,o,l,i,a,e,n,u,s),F=(0,V.Z)(S,2);d=F[0],p=F[1]}var w=!(null!==(f=p)&&void 0!==f&&f.find((function(e){return!e.fixed})));if(r&&!["field","func"].includes(l)&&(null===(v=p)||void 0===v||!v.length||w)){var j=jo(e,r,n,l),E=n?Ii(e,n,r):null,C=D()(xi(e,r,n,j,l),["factory"]),L="field"===l?Vi(e,o):null,P=C,_=C.validateValue;if("function"==typeof _){var k=[d,P,n,E];"field"===l&&k.push(L);var Z,T,x=_.call.apply(_,[e.ctx].concat(k));"object"!==(0,I.Z)(x)||null===x||Array.isArray(x)?"boolean"==typeof x?0==x&&p.push({key:en,args:{}}):"string"==typeof x&&p.push({key:x,args:null}):(T=null!==(Z=x.error)&&void 0!==Z&&Z.key?Rn({},x.error):{key:x.error,args:null},void 0!==x.fixedValue&&u&&(T.fixed=!0,T.fixedFrom=d,T.fixedTo=x.fixedValue,d=x.fixedValue),p.push(T))}}if(w=!(null!==(g=p)&&void 0!==g&&g.find((function(e){return!e.fixed}))),null!==(h=p)&&void 0!==h&&h.length&&!w&&u){var R=Vi(e,r),A=null==R?void 0:R.fieldSettings,N=null==A?void 0:A.defaultValue;if(void 0!==N){var M=p[p.length-1];M.fixed=!0,M.fixedFrom=d,M.fixedTo=N,d=N,p.map((function(e){e.fixed=!0}))}}}return[d,p]},Yn=function(e,t,r,n,o,i){var l,a,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=[],p=t;if(e){var d=Vi(i,e),f=jo(i,e,u,r),v=i.widgets[f],g=null==v?void 0:v.type,h=null==v?void 0:v.jsType,y=null==d?void 0:d.fieldSettings,m=(null==y?void 0:y.treeValues)||(null==y?void 0:y.listValues),b=!(null==y||!y.asyncFetch),O=m||b;if(n&&g&&n!=g)return c.push({key:pn,args:{wType:g,valueType:n}}),[t,c];if(h&&(a=h,Dn(l=t)!==a&&("number"!==a||isNaN(l)))&&!O)return c.push({key:dn,args:{jsType:h,valueTypeof:Dn(t)}}),[t,c];if(y){var S=o||m;if(S&&!y.allowCustomValues){var F=function(e,t,r,n,o){var i=x.ZP.List.isList(e)?e.toJS():e instanceof Array?(0,T.Z)(e):void 0,l=e,a=[];if(i){var u=i.reduce((function(e,r){var n=(0,V.Z)(e,2),o=n[0],i=n[1],l=Ee(t,r);return null==l?[o,[].concat((0,T.Z)(i),[r])]:[[].concat((0,T.Z)(o),[l.value]),i]}),[[],[]]),s=(0,V.Z)(u,2),c=s[0],p=s[1],d=p.length>0;if(l=(r=r||!0===o)&&d?c:e,p.length){var f=r&&d;a.push({key:sn,args:{badValues:p,count:p.length},fixed:f,fixedFrom:f?i:void 0,fixedTo:f?l:void 0})}return[l,a]}var v=Ee(t,e);return null==v?(l=r?null:e,a.push({key:cn,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?l:void 0})):l=v.value,[l,a]}(t,S,s,0,i.settings.removeInvalidMultiSelectValuesOnLoad),w=(0,V.Z)(F,2);p=w[0],c=w[1]}y.maxLength>0&&null!=t&&String(t).length>y.maxLength&&(p=s?String(t).substring(0,y.maxLength):t,c.push({key:fn,args:{value:t,length:String(t).length,fieldSettings:y},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?p:void 0})),null!=y.min&&t<y.min&&(p=s?y.min:t,c.push({key:vn,args:{value:t,fieldSettings:y},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?p:void 0})),null!=y.max&&t>y.max&&(p=s?y.max:t,c.push({key:gn,args:{value:t,fieldSettings:y},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?p:void 0}))}}return[p,c]},Kn=function(e,t,r,n,o,i,l){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=[],s=l.settings,c=s.fieldSeparator,p=s.canCompareFieldWithField,d="object"==(0,I.Z)(t)&&(null==t?void 0:t._isFuncArg),f=Array.isArray(e)?e.join(c):e,v=Vi(l,e),g=Array.isArray(r)?r.join(c):r,h=Vi(l,r);return h?e&&g===f&&!d?(u.push({key:yn,args:{field:f}}),[r,u]):o&&o!=h.type?(u.push({key:bn,args:{field:g,type:h.type,expected:o}}),[r,u]):e&&!d&&p&&!p(f,v,g,h,a)?(u.push({key:mn,args:{leftField:f,rightField:g}}),[r,u]):[r]:(u.push({key:hn,args:{field:g}}),[r,u])},Qn=function(e,t,r,n,o,i,l){var a,u,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=r,v=[];if(!r)return[r];var g=null===(a=r.get)||void 0===a?void 0:a.call(r,"func");if(!g)return[r];var h=Vi(l,t);if(null!=h&&h.funcs&&!h.funcs.includes(g))return v.push({key:On,args:{funcKey:g,field:t}}),[r,v];var y=Ci(l,g);if(!y)return v.push({key:Xr,args:{funcKey:g}}),[r,v];var m=null!==(u=y.label)&&void 0!==u?u:g;if(o&&y.returnType!=o)return v.push({key:Fn,args:{funcKey:g,funcName:m,returnType:y.returnType,valueType:o}}),[r,v];for(var b in c=c||d,y.args){var O,S=y.args[b],F=f.get("args"),w=F?F.get(b):void 0,j=Vi(l,S),E=null!==(O=null==j?void 0:j.label)&&void 0!==O?O:b,C=w?w.get("value"):void 0,L=w?w.get("valueSrc"):void 0;if(void 0!==C){var P=Hn(l,e,j,s,C,S.type,L,i,c,p,d),_=(0,V.Z)(P,2),k=_[0],Z=_[1],T=!(null!=Z&&Z.length),I=c&&k!==C,x=c&&!T&&!I&&(p||d);if(I&&(f=f.setIn(["args",b,"value"],k)),x&&(f=f.deleteIn(["args",b]),f=io(l,f,y,b)),!T){var R,D,A=null!==(R=null!==(D=Z.find((function(e){return!e.fixed&&!e.ignore})))&&void 0!==D?D:Z.find((function(e){return!e.fixed})))&&void 0!==R?R:Z[0],N=I||x,M=0===Z.filter((function(e){return!e.ignore})).length;if(A){var q=Vn(A);v.push({key:tn,args:{funcKey:g,funcName:m,argKey:b,argName:E,argValidationError:q,argErrors:Z},ignore:M,fixed:N,fixedFrom:N?C:void 0,fixedTo:N?I?k:S.defaultValue:void 0})}}}else if(!S.isOptional&&(p||d)){var W=c&&void 0!==S.defaultValue&&(p||d);p&&v.push({key:Sn,args:{funcKey:g,funcName:m,argKey:b,argName:E},fixed:W,fixedTo:W?S.defaultValue:void 0,ignore:!W}),W&&(f=f.deleteIn(["args",b]),f=io(l,f,y,b))}}return[f,v]},Xn=function(e,t,r,n,o){var i,l=Ii(e,r,t),a=r?G(l):null,u=o.toJS?o.toJS():o,s=n.toJS?n.toJS():n,c=u.filter((function(e){return"value"==e||null==e})).length==a;if(null!=l&&l.validateValues&&c){var p=u[0],d=jo(e,t,r,p),f=xi(e,t,r,d,p),v=null!=f&&f.toJS?s.map((function(t){var r=f.toJS.call(e.ctx,t,f);return r instanceof Date&&(r=r.getTime()),r})):s,g=l.validateValues(v);"boolean"==typeof g&&0==g&&(i={key:wn,args:{jsValues:v,values:s}})}return i},eo=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];o||(o=e);var d,f=e.settings,v=f.keepInputOnChangeFieldSrc,g=f.convertableWidgets,h=f.clearValueOnChangeField,y=f.clearValueOnChangeOp,m=i.get("field"),b=i.get("fieldType"),O=i.get("fieldSrc"),S=i.get("operator"),F=i.get("value"),w=i.get("valueSrc",new x.ZP.List),j=i.get("valueType",new x.ZP.List),E=i.get("asyncListValues"),C=Ii(o,S),L=Ii(e,a,l),P=S?G(C):null,_=a?G(L):null,k=Vi(o,m),Z=Vi(e,l),T=!m&&b&&v,I=(null==k?void 0:k.type)||b,R=(null==Z?void 0:Z.type)||!l&&T&&I,D=null==k?void 0:k.listValuesType,A=null==Z?void 0:Z.listValuesType,N=(null==m||null===(t=m.get)||void 0===t?void 0:t.call(m,"func"))||m,M=((null===(r=l)||void 0===r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func"))||l)!=N,q=[],W=(m||T)&&S&&a&&null!=F;if((!I||!R||I!=R||"field"===u&&M&&h||"operator"===u&&y)&&(W=!1),M&&co.includes(R)&&(A&&A===D||(W=!1)),"func"===O&&l){var B=Hn(e,null,null,a,l,R,O,E,s,c,p),U=(0,V.Z)(B,2),z=U[0],$=U[1],J=!(null!=$&&$.length),H=z!==l,Y=!J&&H&&!$.find((function(e){return!e.fixed})),K=s&&!J&&!Y&&!!u&&l!==m;if(K?l=m:H&&(l=z),!J){var Q=!J&&!Y&&!K,X=$.find((function(e){return!e.fixed&&!e.ignore}));Q&&X&&(d=Vn(X)),$.map((function(e){return q.push(Rn(Rn({side:"lhs"},e),{},{fixed:e.fixed||K||false}))}))}}for(var ee=0;ee<_;ee++){var te=w.get(ee)||null,re=jo(o,m,S,te),ne=jo(e,l,a,te),oe="value"===te?re:jo(o,m,S,"value"),ie="value"===te?ne:jo(e,l,a,"value");ie==oe||(g[oe]||[]).includes(ie)||!oe&&T||(W=!1)}S!=a&&[S,a].includes("proximity")&&(W=!1);var ae=w.first(),ue=xi(e,l,a,null,ae),se=wo(e,l,a,null);!l&&T&&(se=Object.keys(e.settings.valueSourcesInfo));var ce,pe=se[0];1==_&&ue&&void 0!==ue.type?ce=ue.type:1==_&&Z&&void 0!==Z.type&&(ce="!group"===Z.type?"number":Z.type);var de=W&&"operator"===u&&1===P&&2===_,fe=[],ve=[],ge=[],he=Array.from({length:_},(function(){return null}));if(W)for(var ye=function(t){var r=F.get(t),n=j.get(t)||null,o=w.get(t)||null;de&&1===t&&(r=void 0!==fe[0]?fe[0]:F.get(0),fe[t]=r,n=j.get(0)||null,o=w.get(0)||null);var i=!o||void 0!==se.find((function(e){return e==o})),u=Hn(e,l,l,a,r,n,o,E,s,c,p),d=(0,V.Z)(u,2),f=d[0],v=d[1],g=!(null!=v&&v.length),h=f!==r,y=!g&&h&&!(null!=v&&v.find((function(e){return!e.fixed}))),m=!(null!=v&&v.find((function(e){return!e.fixed&&!e.ignore}))),b=!i||s&&!g&&!y&&(!m||M);g||null==v||v.map((function(e){return q.push(Rn(Rn({side:"rhs",delta:t},e),{},{fixed:e.fixed||b}))})),b&&(fe[t]=null,0===t&&delete fe[1]);var O=!g&&!h,S=null==v?void 0:v.find((function(e){return!e.fixed&&!e.ignore}));O&&S&&(he[t]=Vn(S)),h&&(fe[t]=f),!de||0!==t||g||h||(de=!1),de&&0===t&&["func","field"].includes(o)&&(de=!1)},me=0;me<_;me++)ye(me);if(!W)for(var be=0;be<_;be++)if(1===_){var Oe,Se=le([null==Z?void 0:Z.defaultValue,null==Z||null===(Oe=Z.fieldSettings)||void 0===Oe?void 0:Oe.defaultValue,null==ue?void 0:ue.defaultValue]);fe[be]=Se,null!=Se&&Se.func&&(ve[be]="func")}for(var Fe=0;Fe<_;Fe++){var we,je,Ee=W&&w.get(Fe)||null,Ce=W&&j.get(Fe)||null;W&&de&&1===Fe&&(Ee=null!==(we=ve[Fe])&&void 0!==we?we:w.get(0),Ce=null!==(je=ge[Fe])&&void 0!==je?je:j.get(0),ve[Fe]=Ee,ge[Fe]=Ce),se.includes(Ee)||(ve[Fe]=pe),Ce||(ge[Fe]=ce)}var Le=new x.ZP.List(Array.from({length:_},(function(e,t){return void 0!==fe[t]?fe[t]:W?F.get(t):void 0}))),Pe=new x.ZP.List(Array.from({length:_},(function(e,t){var r;return null!==(r=ve[t])&&void 0!==r?r:W&&w.get(t)||null}))),_e=new x.ZP.List(Array.from({length:_},(function(e,t){var r;return null!==(r=ge[t])&&void 0!==r?r:W&&j.get(t)||null}))),ke=Xn(e,l,a,Le,Pe);if(ke){var Ze=Vn(ke),Te=s&&_>=2,Ve=Le;Te&&(fe[1]=Le.get(0),Le=Le.set(1,fe[1]),he[1]=he[0]),!Te&&he.push(Ze),q.push(Rn(Rn({side:"rhs",delta:-1},ke),{},{fixed:Te,fixedFrom:Te?[Ve.get(0),Ve.get(1)]:void 0,fixedTo:Te?[Le.get(0),Le.get(1)]:void 0}))}var Ie=new x.ZP.List(he);return{canReuseValue:W,newValue:Le,newValueSrc:Pe,newValueType:_e,operatorCardinality:_,fixedField:l,newValueError:Ie,newFieldError:d,validationErrors:q}},to=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},ro=function(e,t){if(e){var r=e.get("func"),n=r&&Ci(t,r);if(n){var o=e,i=!1;for(var l in n.args){var a=n.args[l],u=a.valueSources,s=a.isOptional,c=a.defaultValue,p=Fo(t,u,a),d=o.get("args"),f=1==p.length?p[0]:void 0,v=d?d.get(l):void 0,g=v?v.get("value"):void 0,h=(v?v.get("valueSrc"):void 0)||f;if(void 0!==g){var y=xo(g,h,t);if(void 0===y)return;if(y!==g&&(o=o.setIn(["args",l,"value"],y)),i)return}else if(void 0===c||to(c)){if(!s)return;i=!0}else o=(o=o.setIn(["args",l,"value"],lo(a))).setIn(["args",l,"valueSrc"],"value")}return o}}},no=function(e,t,r,n){var o=r.settings.fieldSeparator;e=e||new x.ZP.Map,Array.isArray(t)&&(t=t.join(o));var i=e.get("func"),l=e.get("args");e=e.set("func",t);var a=t&&Ci(r,t),u=t&&Ei(r,t),s=i&&Ei(r,i),c=so(s,u,l,r,n);return e=c.length?Object.keys(u.args).filter((function(e){return!c.includes(e)})).reduce((function(e,t){return e.deleteIn(["args",t])}),e):e.set("args",new x.ZP.Map),oo(r,e,a)},oo=function(e,t,r){if(r)for(var n in r.args)t=io(e,t,r,n);return t},io=function(e,t,r,n){var o=r.args[n],i=o.valueSources,l=o.defaultValue,a=Fo(e,i,o),u=a.length?a[0]:void 0,s=(l?to(l)&&l.func?"func":"value":void 0)||u;return t.getIn(["args",n])||(void 0!==l&&(t=t.setIn(["args",n,"value"],lo(o))),s&&(t=t.setIn(["args",n,"valueSrc"],s))),t},lo=function(e){var t=e.defaultValue;return to(t)&&!x.ZP.Map.isMap(t)&&t.func?x.ZP.fromJS(t,(function(e,t){return x.ZP.Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},ao=function(e,t,r,n,o){if(e&&e.get("func")){var i=(e=e.setIn(["args",t,"value"],r)).getIn(["args",t,"valueSrc"]),l=n.valueSources,a=Fo(o,l,n),u=1==a.length?a[0]:void 0;!u&&a.includes("value")&&(u="value"),!i&&u&&(e=e.setIn(["args",t,"valueSrc"],u))}return e},uo=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new x.ZP.Map({valueSrc:r}))),e},so=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(null==e?void 0:e.returnType)!=(null==t?void 0:t.returnType)?[]:Object.keys(t.args).filter((function(i,l){var a=t.args[i],u=e.args[i];if(Object.keys(e.args).indexOf(i),!u&&(void 0!==a.defaultValue||a.isOptional))return!0;if((null==u?void 0:u.type)!=a.type)return!1;if(co.includes(a.type)&&(!u.listValuesType||u.listValuesType!==a.listValuesType))return!1;if(r){var s,c=r.get(i),p=null==c?void 0:c.get("value"),d=null==c?void 0:c.get("valueSrc");if(d&&a.valueSources&&!a.valueSources.includes(d))return!1;var f=Hn(n,null,a,null,p,a.type,d,null,o,!0),v=(0,V.Z)(f,2),g=(v[0],v[1]);if(null!=g&&null!==(s=g.filter((function(e){return!e.fixed})))&&void 0!==s&&s.length)return!1}return!0}))},co=["select","multiselect","treeselect","treemultiselect"],po=function(e,t){var r;return(null===(r=e.types[t])||void 0===r?void 0:r.operators)||null},fo=function(e,t){var r=Vi(e,t);return r?r.operators:[]},vo=function(e,t){var r,n=fo(e,t);return null!==(r=null==n?void 0:n[0])&&void 0!==r?r:null},go=function(e,t,r){var n=null;if(e)if("field"===t){var o=Vi(r,e);o&&(n=o.type)}else if("func"===t){var i=e.get("func");if(i){var l=Ci(r,i);l&&(n=l.returnType||l.type)}}return n},ho=function(e,t){return yo(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"funcs","subfields")},yo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var i=t.settings.fieldSeparator,l=ki(e,t),a=ki(r,t);return l.slice(a.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat((0,T.Z)(a),(0,T.Z)(e)).join(i)})).map((function(e){var r=wi(t,e,n,o);return r&&r.label||ye()(e.split(i))})).filter((function(e){return null!=e}))},mo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&wi(t,r)||null,o=t.settings.fieldSeparator,i=ki(e,t),l=Pi(e,r,t)?ki(r,t):[];return i.slice(l.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat((0,T.Z)(l),(0,T.Z)(e)).join(o),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:wi(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},bo=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=t&&"object"==(0,I.Z)(t)&&!!t.func&&!!t.arg,a=e.settings.showLabels,u=Vi(e,t),s=xi(e,t,r,null,o)||{},c=Ii(e,r,t)||{},p=null;if((i?1:c.cardinality)>1){var d=s.valueLabels||c.valueLabels;d&&(p=d[n]),p&&"object"!=(0,I.Z)(p)&&(p={label:p,placeholder:p}),p||(p={label:e.settings.valueLabel+" "+(n+1),placeholder:e.settings.valuePlaceholder+" "+(n+1)})}else{var f=s.valueLabel,v=s.valuePlaceholder;l&&(f||(f=u.label||t.arg),v||a||(v=u.label||t.arg)),p={label:f||e.settings.valueLabel,placeholder:v||e.settings.valuePlaceholder}}return p};function Oo(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],i=[];if(!t)return{widgets:o,valueSrcs:i};var l="object"===(0,I.Z)(t)&&(!!t.func&&!!t.arg||t._isFuncArg),a=Vi(e,t),u=r?e.operators[r]:null;if(null!=a&&a.widgets){var s=function(){var s=a.widgets[c];if(!e.widgets[c])return"continue";var p=e.widgets[c].valueSrc||"value",d=!0;if("field"==c&&(d=d&&Fo(e,["field"],a).length>0),"func"==c&&(d=d&&Fo(e,["func"],a).length>0),"value"!=n||s.operators||l||"!case_value"==t||(d=!1),s.operators&&r&&(d=d&&-1!=s.operators.indexOf(r)),n&&n!=p&&"const"!=n&&(d=!1),u&&0==u.cardinality&&"value"!=p&&(d=!1),d){var f,v;o.push(c);var g=-1!=(null===(f=a.valueSources)||void 0===f?void 0:f.indexOf(p));-1==(null==u||null===(v=u.valueSources)||void 0===v?void 0:v.indexOf(p))&&(g=!1),g&&!i.find((function(e){return e==p}))&&i.push(p)}};for(var c in a.widgets)s()}var p=function(e){var t=0;return a.preferWidgets?a.preferWidgets.includes(e)&&(t+=10-a.preferWidgets.indexOf(e)):e==a.mainWidget&&(t+=100),"field"==e&&(t-=1),"func"==e&&(t-=2),t};return o.sort((function(e,t){return p(t)-p(e)})),{widgets:o,valueSrcs:i}}var So=function(e,t,r){return Oo(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets},Fo=function(e,t,r){var n;if(!r)return t;var o=null!==(n=r.type)&&void 0!==n?n:r.returnType;return t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter((function(t){var n=!0;if("field"==t&&e.__fieldsCntByType){var i=r._isFuncArg?0:1;n=n&&e.__fieldsCntByType[o]>i}return"func"==t&&(e.__funcsCntByType&&(n=n&&!!e.__funcsCntByType[o]),r.funcs&&(n=n&&r.funcs.length>0)),n}))},wo=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=Oo(e,t,r,null).valueSrcs;return Fo(e,o,n)},jo=function(e,t,r){var n=Oo(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets,o=null;return n.length&&(o=n[0]),o},Eo=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e){var i=Vi(t,e)||{},l=t.settings.fieldSeparator,a=ki(e,t),u=Array.isArray(e)?e.join(l):e;if(null!=o&&o.useTableName&&i.tableName){var s=(0,T.Z)(a);s[0]=i.tableName,u=s.join(l)}if(i.fieldName&&(u=i.fieldName),n){Vi(t,n);var c=n;0==u.indexOf(c+l)?u=u.slice((c+l).length):i.fieldName||r.errors.push("Can't cut group ".concat(c," from field ").concat(u))}return u}},Co=function(e,t){var r=e.get("type"),n=e.getIn(["properties","mode"]);return"rule_group"==r&&"array"==n?Lo(e,t):"group"==r||"rule_group"==r?_o(e,t):Zo(e,t)},Lo=function(e,t){var r=e.get("children1"),n=e.get("properties");return Po(n.toObject(),r,t)},Po=function(e,t,r){var n,o,i=e.operator,l=0==(null!==(n=null===(o=r.operators[i])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1),a=!To(e,r),u=!ko(t,r);return!(a&&(!l||u))},_o=function(e,t){var r=e.get("children1");return ko(r,t)},ko=function(e,t){return!((null==e?void 0:e.size)>0&&e.filter((function(e){return!Co(e,t)})).size>0)},Zo=function(e,t){var r=e.get("properties");return To((null==r?void 0:r.toObject())||{},t)},To=function(e,t){return!(Vo(e,t,!0).score>=3)},Vo=function(e,t){var r,n,o,i=e.field,l=e.fieldSrc,a=(e.fieldType,e.operator),u=e.value,s=e.valueSrc,c=(e.valueType,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),p=null!==(r=null===(n=t.operators[a])||void 0===n?void 0:n.cardinality)&&void 0!==r?r:1,d=null!=s&&s.get?s.toJS():s,f={parts:{},score:0};return f.parts.field=c?null!=i:Io(i,l,t),f.parts.operator=!!a,f.parts.value=(null==u||null===(o=u.filter((function(e,r){return Io(e,null==d?void 0:d[r],t,c)})))||void 0===o?void 0:o.size)>=(c?Math.min(p,1):p),f.score=Object.keys(f.parts).filter((function(e){return!!f.parts[e]})).length,c&&f.score<3&&(!f.parts.value&&"func"===l&&Io(i,l,t,!1,!0)&&f.score++,f.parts.field||null==u||u.map((function(e,r){"func"===(null==d?void 0:d[r])&&Io(e,null==d?void 0:d[r],t,!1,!0)&&f.score++}))),f},Io=function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!o&&"func"==r&&t){var l,a=null===(l=t.get)||void 0===l?void 0:l.call(t,"func"),u=Ci(n,a);if(u){var s=t.get("args");for(var c in u.args){var p=u.args[c],d=s?s.get(c):void 0,f=d?d.get("value"):void 0,v=d?d.get("valueSrc"):void 0;if(null==f&&void 0===(null==p?void 0:p.defaultValue)&&(null==p||!p.isOptional))return!1;if(null!=f&&!e(f,v,n,!i||o))return!1}return!0}}return null!=t},xo=function(e,t,r){return"func"==t?ro(e,r):e},Ro=r(89937),Do=r.n(Ro),Ao=r(53660),No=r.n(Ao);function Mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mo(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Wo(e,t){return No().apply(e,t)}var Go={CALL:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call.apply(e,[t].concat(n))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return qo(qo({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return(null==e?void 0:e.length)||0},regexTest:function(e,t,r){return null!=(null==e?void 0:e.match(new RegExp(t,r)))},now:function(){return new Date},date_add:function(e,t,r){return Qe()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function Bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Uo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function zo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Uo(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $o(e,t,r){var n;try{n=No().apply(e,t)}catch(e){throw e.message="".concat(r.join(".")," :: ").concat(e.message),e}return n}function Jo(e,t,r,n){var o;try{o=t.call.apply(t,[e].concat((0,T.Z)(r)))}catch(e){throw e.message="".concat(n.join(".")," :: ").concat(e.message),e}return o}!function(){for(var e in Go)t=e,r=Go[e],No().add_operation(t,r);var t,r}();var Ho=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],Yo={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},Ko=zo(zo({},Yo),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Qo={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Xo={widgetProps:Ko,opProps:Qo},ei={fields:{x:{fieldSettings:Yo,widgets:{x:Xo},mainWidgetProps:Ko}},widgets:{x:Ko},conjunctions:{x:{formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}}},operators:{x:Qo},types:{x:{widgets:{x:Xo}}},funcs:{x:zo(zo(zo({},{renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}}),Yo),{},{fieldSettings:Yo,args:{x:zo(zo({},Yo),{},{fieldSettings:Yo})}})},settings:{locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderRuleError:{type:"rf"}}},ti=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},ri=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=fe()(e,Ho);delete r.ctx;for(var n=function e(t,r,n,o){if(ti(t)){if(Q(t)&&(t=K(t)),"funcs"===n[0]&&!r){var i=n[n.length-1];(r=wi({funcs:o.BasicFuncs},i,"funcs","subfields")||void 0)&&(t.$$key=i)}if(void 0!==r&&ti(r))for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(!Object.keys(t).includes(l)||void 0===t[l]&&void 0!==r[l]?t[l]="$$deleted":(t[l]=e(t[l],r[l],[].concat((0,T.Z)(n),[l]),o),void 0===t[l]&&delete t[l]));for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u;r&&Object.keys(r).includes(a)||(t[a]=e(t[a],null===(u=r)||void 0===u?void 0:u[a],[].concat((0,T.Z)(n),[a]),o)),void 0===t[a]&&delete t[a]}0===Object.keys(t).length&&(t=void 0)}else Array.isArray(t)&&t.forEach((function(r,i){t[i]=e(t[i],void 0,[].concat((0,T.Z)(n),[i]),o)}));if(void 0===r||!U(t,r,!0)){if("function"==typeof t)throw new Error("compressConfig: function at ".concat(n.join(".")," should be converted to JsonLogic"));return t}},o=0,i=Ho;o<i.length;o++){var l=i[o];if("ctx"===l);else if("fields"===l)r[l]=Do()(r[l]),n(r[l],{},[l]);else if("funcs"===l)for(var a in r[l]=Do()(r[l]||{}),r[l])n(r[l][a],null,[l,a],{BasicFuncs:h});else r[l]=Do()(r[l]),n(r[l],t[l],[l])}return r},ni=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var n={},o=function e(t,r,n){if(ti(r))for(var o in ti(t)||(t={}),r)Object.prototype.hasOwnProperty.call(r,o)&&("$$deleted"===r[o]?delete t[o]:t[o]=e(t[o],r[o],[].concat((0,T.Z)(n),[o])));else t=Array.isArray(r)?Do()(r):r;return t},i=function e(t,r,n){var i=!1;if(ti(t)&&Object.prototype.hasOwnProperty.call(t,"$$key")&&t.$$key){var l=wi({funcs:n.BasicFuncs},t.$$key,"funcs","subfields");if(!l)throw new Error("decompressConfig: basic function not found by key ".concat(t.$$key," at ").concat(r.join(".")));delete t.$$key,t=o(Do()(l),t,r),i=!0}if(!i)if(ti(t))for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]=e(t[a],[].concat((0,T.Z)(r),[a]),n));else if(Array.isArray(t)){var u,s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Bo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(t);try{for(s.s();!(u=s.n()).done;){var c=u.value;t[c]=e(t[c],[].concat((0,T.Z)(r),[c]),n)}}catch(e){s.e(e)}finally{s.f()}}return t},l=0,a=Ho;l<a.length;l++){var u=a[l];"ctx"===u?n[u]=pe()({},t.ctx||{},r||{}):"funcs"===u?(n[u]=Do()(e[u]||{}),i(n[u],[u],{BasicFuncs:h})):"fields"===u?n[u]=Do()(e[u]||{}):(n[u]=Do()(t[u]||{}),o(n[u],e[u]||{},[u]))}return n},oi=function(e){return e.__compliled||(ii(e=Do()(e),e,{ctx:e.ctx},ei,[]),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0})),e};function ii(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(t)for(var l in i.length,n){var a=n[l],u="x"===l?i:[].concat((0,T.Z)(i),[l]);if("r"===a.type){var s=t,c=s[l];if(a.isArr)for(var p in c){var d=ui(c[p],r,[].concat((0,T.Z)(u),[p]));d!==c[p]&&(o.push("Compiled ".concat(u.join("."),"[").concat(p,"]")),c[p]=d)}else{var f=ui(c,r,u,void 0);f!==c&&(o.push("Compiled R ".concat(u.join("."))),s[l]=f)}}else if("rf"===a.type){var v=t,g=v[l],h=li(g,r,u,a.ignore);h!==g&&(o.push("Compiled JL-RF ".concat(u.join("."))),v[l]=h)}else if("f"===a.type){var y,m=t,b=m[l],O=ai(b,r,u,a.args,a.ignore);a.invokeWith&&O&&"function"==typeof O&&(O=(y=O).call.apply(y,[null].concat((0,T.Z)(a.invokeWith)))),O!==b&&(o.push("Compiled JL-F ".concat(u.join("."))),m[l]=O)}else if("x"===l)for(var S in t){u=[].concat((0,T.Z)(i),[S]);var F=t[S];ii(e,F,r,a,o,u),F.subfields&&ii(e,F.subfields,r,n,o,u)}else ii(e,t[l],r,a,o,u)}}function li(e,t,r){return ee(e)?function(n,o){o=o||(null==t?void 0:t.ctx);var i=$o(e,{props:n,ctx:o},r);return"string"==typeof i&&(i={type:i,props:n}),ui(i,{ctx:o},r)}:"string"==typeof e?function(n,o){o=o||(null==t?void 0:t.ctx);var i=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),o);return i?Jo(this,i,[n,o],r):ui({type:e,props:n},{ctx:o},r)}:e}function ai(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return ee(e)&&"jl"!==o?function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];var a=this||(null==t?void 0:t.ctx),u=(n||[]).reduce((function(e,t,r){return zo(zo({},e),{},(0,Z.Z)({},t,i[r]))}),{args:i,ctx:a});return $o(e,u,r)}.bind(null==t?void 0:t.ctx):"string"==typeof e&&"string"!==o?function(){var n=this||(null==t?void 0:t.ctx),o=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),n);if(o){for(var i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];return Jo(this,o,l,r)}throw new Error("".concat(r.join(".")," :: Function ").concat(e," is not found in ctx"))}.bind(null==t?void 0:t.ctx):e}function ui(e,t,r){var n,o,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(X(e)){var a,u=e.type,s=e.props;if("string"!=typeof u)throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var c,p=(n=u,(null==(o=t.ctx)||null===(i=o.components)||void 0===i?void 0:i[n])||o.W[n]||o.O[n]||u.toLowerCase());return void 0!==l&&(s=zo(zo({},s),{},{key:l})),null!==(a=s)&&void 0!==a&&a.children&&(c=ui(s.children,t,r),s=zo(zo({},s),{},{children:c})),t.ctx.RCE(p,s)}return e instanceof Array?e.map((function(e,n){return ui(e,t,r,""+n)})):e}var si={formatField:function(e,t,r,n,o,i){return i?r:e},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,canShortMongoQuery:!0,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,optimizeRenderWithInternals:!1,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function ci(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return pi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var di=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.__configId)return e;(e=r&&e.settings.useConfigCompress?e.__compliled?Do()(e):oi(e):Do()(e)).settings=ge()({},si,e.settings,Y),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},function(e,t){for(var r in e)fi(0,e[r],t)}(e.types,e),vi(e.fields,e),gi(e.funcs,e);var n=e.settings.locale.moment;return n&&Qe().locale(n),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||N()}),ne(e),e};function fi(e,t,r){var n=null,o=null;for(var i in t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0],t.widgets){var l=t.widgets[i];if(l.operators){var a=l.operators;t.excludeOperators&&(a=a.filter((function(e){return!t.excludeOperators.includes(e)}))),n=re(n,a)}l.defaultOperator&&(o=l.defaultOperator),i==t.mainWidget&&(l=pe()({},{widgetProps:t.mainWidgetProps||{}},l)),t.widgets[i]=l}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var u,s=ci(t.valueSources);try{for(s.s();!(u=s.n()).done;){var c=u.value;"value"==c||t.widgets[c]||(t.widgets[c]={})}}catch(e){s.e(e)}finally{s.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function vi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var n in e)hi(e[n],t,[].concat((0,T.Z)(r),[n])),e[n].subfields&&vi(e[n].subfields,t,[].concat((0,T.Z)(r),[n]))}function gi(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var o=(null==t||null===(r=t.settings)||void 0===r?void 0:r.fieldSeparator)||".";for(var i in e){var l=[].concat((0,T.Z)(n),[i]).join(o),a=e[i];if(a.returnType&&(t.__funcsCntByType[a.returnType]||(t.__funcsCntByType[a.returnType]=0),t.__funcsCntByType[a.returnType]++),hi(a,t,null,!1),a.args){for(var u in a.args)hi(a.args[u],t,null,!0);var s,c=!0,p=ci(Object.keys(a.args).reverse());try{for(p.s();!(s=p.n()).done;){var d=s.value,f=a.args[d];!c&&f.isOptional&&(ae.info("Arg ".concat(d," for func ").concat(l," can't be optional")),delete f.isOptional),f.isOptional||(c=!1)}}catch(e){p.e(e)}finally{p.f()}}a.subfields&&gi(a.subfields,t,[].concat((0,T.Z)(n),[i]))}}}function hi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=null,i=null,l=t.types[e.type||e.returnType],a=!!e.returnType,u=e.excludeOperators||[];if("!struct"!=e.type&&"!group"!=e.type){e.fieldSettings||(e.fieldSettings={});for(var s=0,c=["listValues","treeValues","allowCustomValues","validateValue"];s<c.length;s++){var p=c[s];e[p]&&(e.fieldSettings[p]=e[p],delete e[p])}if(e.fieldSettings.listValues&&t.settings.normalizeListValues&&(e.fieldSettings.listValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.listValues,e.type,e.fieldSettings)),e.fieldSettings.treeValues&&t.settings.normalizeListValues&&(e.fieldSettings.treeValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.treeValues,e.type,e.fieldSettings)),!l)return void(e.disabled=!0);if(n||a||(t.__fieldsCntByType[e.type]||(t.__fieldsCntByType[e.type]=0),t.__fieldsCntByType[e.type]++),n&&(e._isFuncArg=!0),!a){e.mainWidget=e.mainWidget||l.mainWidget,e.valueSources=e.valueSources||l.valueSources;var d=l.excludeOperators||[];e.widgets||(e.widgets={});var f=function(){var t=e.widgets[v]||{},r=l.widgets[v]||{};if(!n){var a=[].concat((0,T.Z)(u),(0,T.Z)(d)),s=e.preferWidgets&&("field"==v||e.preferWidgets.includes(v))||a.length>0;if(t.operators){var c=t.operators.filter((function(e){return!a.includes(e)}));o=[].concat((0,T.Z)(o||[]),(0,T.Z)(c))}else if(s&&r.operators){var p=r.operators.filter((function(e){return!a.includes(e)}));o=[].concat((0,T.Z)(o||[]),(0,T.Z)(p))}t.defaultOperator&&(i=t.defaultOperator)}v==e.mainWidget&&(t=pe()({},{widgetProps:e.mainWidgetProps||{}},t)),e.widgets[v]=t};for(var v in l.widgets)f()}n||(!e.operators&&o&&(e.operators=Array.from(new Set(o))),e._origDefaultOperator=e.defaultOperator,!e.defaultOperator&&i&&(e.defaultOperator=i))}var g=function(e,t){if(!t)return{};var r=e.settings.fieldSeparator,n=(0,T.Z)(t).reduce((function(t,n,o,i){var l=t.computedPath,a=t.computed,u=t.inGroup,s=[].concat((0,T.Z)(i.slice(0,o)),[n]),c=wi(e,s);return"!group"===(null==c?void 0:c.type)&&o<i.length-1?(u=s.join(r),l=[]):null!=c&&c.fieldName?(a=!0,l=[c.fieldName]):l=[].concat((0,T.Z)(l),[n]),{computedPath:l,computed:a,inGroup:u}}),{computedPath:[],computed:!1,inGroup:void 0}),o=n.computedPath,i=n.computed,l=n.inGroup;return i?{fieldName:o.join(r),inGroup:l}:{}}(t,r),h=g.fieldName,y=g.inGroup;h&&(e.fieldName=h,t.__fieldNames[h]||(t.__fieldNames[h]=[]),t.__fieldNames[h].push({fullPath:r,inGroup:y}))}var yi=se().mark(Oi),mi=se().mark(Si),bi=q;function Oi(e){return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Fi(e,e.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}}),yi)}function Si(e){return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Fi(e,e.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}}),mi)}function Fi(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";return se().mark((function o(i){var l,a,u;return se().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:l=(null==e||null===(i=e.settings)||void 0===i?void 0:i.fieldSeparator)||".",o.t0=se().keys(t);case 2:if((o.t1=o.t0()).done){o.next=13;break}if(a=o.t1.value,!(u=t[a])[n]){o.next=9;break}return o.delegateYield(Fi(e,u[n],[].concat((0,T.Z)(r),[a]),n),"t2",7);case 7:o.next=11;break;case 9:return o.next=11,[[].concat((0,T.Z)(r),[a]).join(l),u];case 11:o.next=2;break;case 13:case"end":return o.stop()}}),o)}))()}var wi=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"==t)return{type:"case_value",mainWidget:"case_value",widgets:{case_value:e.widgets.case_value}};var i=(null==e||null===(r=e.settings)||void 0===r?void 0:r.fieldSeparator)||".",l=ki(t,e),a=e[n];if(!a)return null;for(var u=a,s=null,c=[],p=0;p<l.length;p++){var d=l[p];c.push(d),s=u[c.join(i)],p<l.length-1&&(s&&s[o]?(u=s[o],c=[]):s=null)}return s},ji=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.settings.fieldSeparator,l=[o].concat((0,T.Z)(t.split(i))).filter((function(e){return null!=e})),a=t;return((null===(r=e.__fieldNames[a])||void 0===r||null===(n=r.find)||void 0===n||null===(n=n.call(r,(function(e){var t=e.inGroup;return!t||(null==o?void 0:o.startsWith(t))})))||void 0===n?void 0:n.fullPath)||l).join(i)},Ei=function(e,t){if(!t)return null;var r=wi(e,t,"funcs","subfields");if(!r)return null;var n=r.returnType,o=r.args;return{returnType:n,args:Object.fromEntries(Object.entries(o||{}).map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return[r,fe()(n,["type","valueSources","defaultValue","fieldSettings","isOptional"])]})))}},Ci=function(e,t){if(!t)return null;var r=wi(e,t,"funcs","subfields");if(!r)return null;var n=e.types[r.returnType]||{},o=ge()({},n,r,Y);return o.type=r.returnType||r.type,o},Li=function(e,t,r){var n=Ci(e,t);if(!n)return null;var o=n.args&&n.args[r]||null;if(!o)return null;var i=e.types[o.type]||{};return ge()({},i,o||{},Y)},Pi=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var o=(null==n||null===(r=n.settings)||void 0===r?void 0:r.fieldSeparator)||".",i=_i(e,n),l=_i(t,n);return i.startsWith(l+o)},_i=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)return e;var n=(null==r||null===(t=r.settings)||void 0===t?void 0:t.fieldSeparator)||".";return ki(e,r).join(n)},ki=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var i,l=(null==o||null===(t=o.settings)||void 0===t?void 0:t.fieldSeparator)||".";return null!=e&&e.func?Array.isArray(e.func)?e.func:e.func.split(l):null!=e&&null!==(r=e.get)&&void 0!==r&&r.call(e,"func")?null==e||null===(i=e.get)||void 0===i?void 0:i.call(e,"func").split(l):(null==e||null===(n=e.split)||void 0===n?void 0:n.call(e,l))||[]},Zi=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=ki(e,t);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},Ti=function(e){var t;if(!e)return null;if("object"==(0,I.Z)(e)){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?null:"func":"field"},Vi=function(e,t){var r;if(!t)return null;if("object"==(0,I.Z)(t)){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?Li(e,t.func,t.arg):Ci(e,t.func)}if(null!=t&&null!==(r=t.get)&&void 0!==r&&r.call(t,"func"))return null!=t&&t.get("arg")?Li(e,t.get("func"),t.get("arg")):Ci(e,t.get("func"));var n=wi(e,t);if(!n)return null;var o=e.types[n.type]||{};return ge()({},o,n||{},Y)},Ii=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o=Vi(e,r),i=jo(e,r,t,null),l=e.widgets[i]||{},a=(o&&o.widgets?o.widgets[i]:{})||{},u=(l.opProps||{})[t],s=(a.opProps||{})[t];return pe()({},n,u,s)}return n},xi=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;if(!r&&!n&&"const"!==o&&"!case_value"!==t)return null;var i=Vi(e,t);n||(n=jo(e,t,r,o));var l=e.widgets[n]||{},a=((i&&i.widgets?i.widgets[n]:{})||{}).widgetProps||{},u=("value"===o||!o)&&(null==i?void 0:i.fieldSettings)||{};return pe()({},l,a,u)},Ri=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n=ki(t,e),o=t?wi(e,t):e,i=null,l=[];do{var a,u=o===e?e.fields:null===(a=o)||void 0===a?void 0:a.subfields;if(!u||!Object.keys(u).length){o=i=null;break}i=Object.keys(u)[0],l.push(i),o=u[i]}while("!struct"==o.type||"!group"==o.type);return(n||[]).concat(l).join(r)};function Di(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ai(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Di(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ni=function(e,t){var r={usedFields:[]},n=Mi(e,t,r);if(n)return Ai(Ai({},n),r)},Mi=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?qi(e,t,r):"rule"===n?Wi(e,t,r):void 0}},qi=function(e,t,r){var n=e.get("properties")||new x.D5,o=e.get("children1"),i=e.get("id"),l=o.map((function(e){return Mi(e,t,r)})).filter((function(e){return void 0!==e}));if(l.size){var a=n.get("conjunction");a||(a=Pr(t));var u=n.get("not");return{id:i,rules:l.toList(),condition:a.toUpperCase(),not:u}}},Wi=function(e,t,r){var n,o=e.get("properties")||new x.D5,i=e.get("id"),l=o.get("operator"),a=o.get("operatorOptions"),u=o.get("field"),s=o.get("value"),c=o.get("valueSrc"),p=o.get("valueType"),d=s.filter((function(e){return void 0===e})).size>0;if(null!=u&&null!=l&&!d){var f=Vi(t,u)||{},v=Ii(t,l,u)||{},g=f.type||"undefined",h=G(v),y=t.types[f.type]||{},m=Eo(u,t,r);if(!(s.size<h)){-1==r.usedFields.indexOf(u)&&r.usedFields.push(u),s=s.toArray(),c=c.toArray(),p=(null===(n=p)||void 0===n?void 0:n.toArray())||[];for(var b=[],O=0;O<s.length;O++){var S={type:p[O],value:s[O]};if(b.push(S),"field"==c[O]){var F=s[O];-1==r.usedFields.indexOf(F)&&r.usedFields.push(F)}}var w=a?a.toJS():null;w&&!Object.keys(w).length&&(w=null);var j={id:i,fieldName:m,type:g,input:y.mainWidget,operator:l};return w&&(j.operatorOptions=w),j.values=b,j}}};function Gi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Bi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ui(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return zi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $i=function(e,t){var r,n={usedFields:[],errors:[]},o=di(t,void 0,!1),i=Ji(e,o,n,!0),l=n.errors,a=n.usedFields,u=(o.settings.fieldSeparator,{}),s=Ui(a);try{for(s.s();!(r=s.n()).done;)for(var c=r.value,p=ki(c,t),d=(Vi(o,c),u),f=0;f<p.length;f++){var v=p[f],g=Vi(o,p.slice(0,f+1))||{};f!=p.length-1?"!group"==g.type&&"struct"!=g.mode?(d[v]||(d[v]=[{}]),d=d[v][0]):(d[v]||(d[v]={}),d=d[v]):d[v]||(d[v]=null)}}catch(e){s.e(e)}finally{s.f()}return{errors:l,logic:i,data:u}},Ji=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){var i,l=e.get("type"),a=(e.get("properties")||new x.D5).get("isLocked"),u=t.settings.jsonLogic.lockedOp;return"group"===l||"rule_group"===l?i=Hi(e,t,r,n,o):"rule"===l&&(i=Yi(e,t,r,o)),a&&i&&u&&(i=(0,Z.Z)({},u,i)),i}},Hi=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type"),l=e.get("properties")||new x.D5,a=l.get("mode"),u=e.get("children1")||new x.aV,s=l.get("field"),c=l.get("conjunction");c||(c=Pr(t));var p=t.conjunctions[c].jsonLogicConj||c.toLowerCase(),d=l.get("not"),f="rule_group"===i&&!n,v=f&&"struct"!=a?s:o,g=l.get("operator"),h=g&&Ii(t,g,s)||null,y=Ki(t,l,r,g,o),m=f&&(!g||0==h.cardinality),b=u.map((function(e){return Ji(e,t,r,!1,v)})).filter((function(e){return void 0!==e}));if(f&&"struct"!=a&&!m){if(null==y)return}else if(!b.size)return;var O={};if(1!=b.size||n?O[p]=b.toList().toJS():O=b.first(),d&&(O={"!":O}),f&&"struct"!=a){var S=el(r,t,s,o);if(m){var F=g||"some";O=(0,Z.Z)({},F,[S,O])}else{var w=b.size?{filter:[S,O]}:S;O=tl(t,l,{reduce:[w,{"+":[1,{var:"accumulator"}]},0]},y,g)}}return O},Yi=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new x.D5,i=o.get("field"),l=o.get("fieldSrc"),a=o.get("operator"),u=o.get("operatorOptions");if((u=u?u.toJS():null)&&!Object.keys(u).length&&(u=null),null!=i&&null!=a){var s=Vi(t,i)||{},c=Ii(t,a,i)||{},p=c.reversedOp,d=Ii(t,p,i)||{},f=!1;if(c.jsonLogic||d.jsonLogic){if(!c.jsonLogic&&d.jsonLogic){f=!0;var v=[p,a];a=v[0],p=v[1];var g=[d,c];c=g[0],d=g[1]}var h=Ki(t,o,r,a,n);if(void 0!==h){var y="func"===l?Xi(r,t,i,n):el(r,t,i,n);if(void 0!==y)return tl(t,o,y,h,a,u,s,f)}}else r.errors.push("Operator ".concat(a," is not supported"))}},Ki=function(e,t,r,n,o){var i=t.get("field"),l=t.get("valueSrc"),a=t.get("valueType"),u=Vi(e,i)||{},s=Ii(e,n,i)||{},c=G(s),p=t.get("value"),d=t.get("asyncListValues");if(null!=p){var f=[],v=[],g=r.usedFields,h=p.map((function(t,c){var p=l?l.get(c):null,g=a?a.get(c):null,h=xo(t,p,e),y=jo(e,i,n,p),m=D()(xi(e,i,n,y,p),["factory"]),b=Qi(r,e,h,p,g,m,u,n,s,o,d);return void 0!==b&&(f.push(p),v.push(g)),b})),y=h.filter((function(e){return void 0===e})).size>0;if(!(h.size<c||y))return c>1?h.toArray():1==c?h.first():null;r.usedFields=g}},Qi=function(e,t,r,n,o,i,l,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"==n)p=el(e,t,r,s);else if("func"==n)p=Xi(e,t,r,s);else if("function"==typeof i.jsonLogic){var d=i.jsonLogic,f=[r,Bi(Bi({},fe()(l,["fieldSettings","listValues"])),{},{asyncListValues:c}),D()(i,q)];a&&(f.push(a),f.push(u)),p=d.call.apply(d,[t.ctx].concat(f))}else p=r;return p}},Xi=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=Ci(t,l),s=ki(l,t),c=s[s.length-1];if(u)if(null!=u&&u.jsonLogic){var p={},d=[],f=[];for(var v in u.args){var g,h=u.args[v],y=Vi(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",S=a?a.get(v):void 0,F=S?S.get("value"):void 0,w=S?S.get("valueSrc"):void 0;"func"!==w&&null!==(g=F)&&void 0!==g&&g.toJS&&(F=F.toJS());var j=null,E=jo(t,h,j,w),C=D()(xi(t,h,j,E,w),["factory"]),L=Qi(e,t,F,w,h.type,C,y,null,null,i);if(null!=F&&void 0===L)return void("func"!=w&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(l)));var P=void 0;if(void 0===L&&!b&&null!=m){var _=jo(t,h,j,O),k=D()(xi(t,h,j,_,O),["factory"]);if(void 0===(P=Qi(e,t,m,O,h.type,k,y,null,null,i)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(l)))}var T=null!=L?L:P;if(void 0!==T){if(d.length){var V,I=Ui(d);try{for(I.s();!(V=I.n()).done;)p[V.value]=void 0}catch(e){I.e(e)}finally{I.f()}d=[]}p[v]=T}else b||f.push(v),d.push(v)}if(!f.length){var x,R=Object.values(p);if("function"==typeof u.jsonLogic){var A=u.jsonLogic,N=[p];x=A.call.apply(A,[t.ctx].concat(N))}else{var M=u.jsonLogic||c;if(u.jsonLogicIsMethod){var q=R[0],W=R.slice(1);x=W.length?{method:[q,M,W]}:{method:[q,M]}}else x=(0,Z.Z)({},M,R)}return x}}else e.errors.push("Func ".concat(l," is not supported"));else e.errors.push("Func ".concat(l," is not defined in config"))},el=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.settings,l=i.fieldSeparator,a=i.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(l));var u=Vi(t,r)||{},s=Eo(r,t,e,o),c=u.jsonLogicVar||("!group"==u.type?a.groupVarKey:"var");n=(0,Z.Z)({},c,s),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},tl=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=t.get("field"),s=Ii(e,o,u)||{},c="function"==typeof s.jsonLogic?s.jsonLogic:function(e,t,r,n){var o,i=e,l=G(t),a=null!==(o=t._jsonLogicIsRevArgs)&&void 0!==o&&o;"string"==typeof t.jsonLogic&&(i=t.jsonLogic);var u=["<","<=",">",">="],s=["==","!="];return function(e,t,o,c,p){return 0==l&&s.includes(i)?(0,Z.Z)({},i,[r,null]):0==l?(0,Z.Z)({},i,r):1==l&&a?(0,Z.Z)({},i,[n,r]):1==l?(0,Z.Z)({},i,[r,n]):2==l&&u.includes(i)?(0,Z.Z)({},i,[n[0],r,n[1]]):(0,Z.Z)({},i,[r].concat((0,T.Z)(n)))}}(o,s,r,n),p=[r,o,n,D()(s,W),i,l],d=c.call.apply(c,[e.ctx].concat(p));return a&&(d={"!":d}),d};function rl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return nl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function nl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ol(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function il(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ol(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ol(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ll=function(e){return"object"==(0,I.Z)(e)&&null!==e&&!Array.isArray(e)},al=function(e,t){return ul(e,t,!1)},ul=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=di(t,void 0,!1),i=sl([],e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),i)},sl=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var u=t.get("type");return"group"===u||"rule_group"===u?cl(e,t,r,n,o,i,l,a):"rule"===u?pl(e,t,r,n,o,i,l,a):void 0}},cl=function(e,t,r,n){var o,i,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.get("type"),u=t.get("properties")||new x.D5,s=t.get("children1")||new x.aV,c=r.settings,p=c.canShortMongoQuery,d=c.fieldSeparator,f=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,v=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),g=f&&v,h="rule_group"===a?u.get("field"):null,y="rule_group"===a?u.get("operator"):null,m=y?null!==(o=null===(i=r.operators[y])||void 0===i?void 0:i.cardinality)&&void 0!==o?o:1:void 0,b=Eo(h,r,n,g),O=(Vi(r,h)||{}).mode,S=h&&"array"===O&&m>=1,F=l?!u.get("not"):u.get("not"),w=s.map((function(o){return sl([].concat((0,T.Z)(e),[t]),o,r,n,F,"array"!=O,"array"==O?function(e){return"$$el".concat(d).concat(e)}:void 0)})).filter((function(e){return void 0!==e}));if(S||w.size){var j=u.get("conjunction");j||(j=Pr(r));var E=r.conjunctions[j],C=E.reversedConj;if(F&&C&&(j=C,E=r.conjunctions[j]),E){var L,P=E.mongoConj;if(1==w.size)L=w.first();else if(w.size>1){var _=w.toList().toJS();p&&"$and"==P&&(L=_.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(ll(n)||(n={$eq:n}),ll(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),L||(L=(0,Z.Z)({},P,_))}if(h)if("array"==O){var k={$size:{$ifNull:["$"+b,[]]}},V=L?{$size:{$ifNull:[{$filter:{input:"$"+b,as:"el",cond:L}},[]]}}:k;L={$expr:L=sl(e,t.set("type","rule"),r,n,!1,!1,(function(e){return V}),k)}}else L=(0,Z.Z)({},b,{$elemMatch:L});return L}}},pl=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u=t.get("properties")||new x.D5,s=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,c=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),p=s&&c,d=u.get("operator"),f=u.get("operatorOptions"),v=u.get("field"),g=u.get("fieldSrc"),h=u.get("value"),y=u.get("valueSrc"),m=u.get("valueType"),b=u.get("asyncListValues");if(null!=v&&null!=d&&void 0!==h){var O,S=Vi(r,v)||{},F=Ii(r,d,v)||{},w=F.reversedOp,j=Ii(r,w,v)||{},E=G(F),C=o;if(C&&w){var L=[w,d];d=L[0],w=L[1];var P=[j,F];F=P[0],j=P[1],C=!1}var _=!1;if("func"==g){var k=vl(n,r,v,p),Z=(0,V.Z)(k,2);O=Z[0],_=Z[1]}else O=Eo(v,r,n,p),l&&(_=!0,O=l(O));if(null!=O){var T,I=[],R=[];if(null!=h){var A=h.map((function(e,t){var o=y?y.get(t):null,i=m?m.get(t):null,l=xo(e,o,r),a=jo(r,v,d,o),u=D()(xi(r,v,d,a,o),["factory"]),s=dl(n,r,l,o,i,u,S,p,d,F,b),c=(0,V.Z)(s,2),f=c[0],g=c[1];return void 0!==f&&(_=_||g,I.push(o),R.push(i)),f})),N=A.filter((function(e){return void 0===e})).size>0;if(A.size<E||N)return;T=E>1?A.toArray():1==E?A.first():null}var M=_&&i,q=F.mongoFormatOp;if(q){var B=[O,d,void 0!==a&&null==T?a:T,_,I.length>1?I:I[0],R.length>1?R:R[0],D()(F,W),f,S],U=q.call.apply(q,[r.ctx].concat(B));return M&&(U={$expr:U}),C&&(U={$not:U}),U}n.errors.push("Operator ".concat(d," is not supported"))}}},dl=function(e,t,r,n,o,i,l,a,u,s,c){if(void 0===r)return[void 0,!1];var p,d=!1;if("field"==n){var f=fl(e,t,r,a),v=(0,V.Z)(f,2);p=v[0],d=v[1]}else if("func"==n){var g=vl(e,t,r,a),h=(0,V.Z)(g,2);p=h[0],d=h[1]}else if("function"==typeof i.mongoFormatValue){var y=i.mongoFormatValue,m=[r,il(il({},fe()(l,["fieldSettings","listValues"])),{},{asyncListValues:c}),D()(i,q)];u&&(m.push(u),m.push(s)),p=y.call.apply(y,[t.ctx].concat(m))}else p=r;return[p,d]},fl=function(e,t,r,n){var o,i=t.settings.fieldSeparator;if(r){var l=Vi(t,r)||{},a=ki(r,t),u=yo(r,t),s=u?u.join(i):null;o="$"+(0,t.settings.formatField)(Eo(r,t,e,n),a,s,l,t,!1)}return[o,!0]},vl=function(e,t,r,n){var o,i,l,a=null===(o=r.get)||void 0===o?void 0:o.call(r,"func"),u=null===(i=r.get)||void 0===i?void 0:i.call(r,"args"),s=Ci(t,a);if(!s)return e.errors.push("Func ".concat(a," is not defined in config")),[void 0,!1];var c=ki(a,t),p=c[c.length-1],d=s.mongoFunc||p,f=s.mongoArgsAsObject,v={},g=0,h=void 0,y=[],m=[];for(var b in s.args){var O;g++;var S=s.args[b],F=Vi(t,S),w=S.defaultValue,j=S.isOptional,E=null!=w&&w.func?"func":"value",C=u?u.get(b):void 0,L=C?C.get("value"):void 0,P=C?C.get("valueSrc"):void 0;"func"!==P&&null!==(O=L)&&void 0!==O&&O.toJS&&(L=L.toJS());var _=C?C.get("asyncListValues"):void 0,k=null,T=jo(t,S,k,P),I=D()(xi(t,S,k,T,P),["factory"]),x=dl(e,t,L,P,S.type,I,F,n,null,null,_),R=(0,V.Z)(x,2),A=R[0];if(R[1],null!=L&&void 0===A)return"func"!=P&&e.errors.push("Can't format value of arg ".concat(b," for func ").concat(a)),[void 0,!1];var N=void 0;if(void 0===A&&!j&&null!=w){var M=jo(t,S,k,E),q=D()(xi(t,S,k,M,E),["factory"]),W=dl(e,t,w,E,S.type,q,F,n,null,null,_),G=(0,V.Z)(W,2);if(N=G[0],G[1],void 0===N)return"func"!=E&&e.errors.push("Can't format default value of arg ".concat(b," for func ").concat(a)),[void 0,!1]}var B=null!=A?A:N;if(void 0!==B){if(y.length){var U,z=rl(y);try{for(z.s();!(U=z.n()).done;)v[U.value]=void 0}catch(e){z.e(e)}finally{z.f()}y=[]}v[b]=B,h=B}else j||m.push(b),y.push(b)}if(m.length)return[void 0,!1];if("function"==typeof s.mongoFormatFunc){var $=s.mongoFormatFunc,J=[v];l=$.call.apply($,[t.ctx].concat(J))}else{if(null===s.mongoFormatFunc)return e.errors.push("Functon ".concat(d," is not supported")),[void 0,!1];l=f?(0,Z.Z)({},d,v):1==g&&void 0!==h?(0,Z.Z)({},d,h):(0,Z.Z)({},d,Object.values(v))}return[l,!0]};function gl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return hl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ml(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yl(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var bl=function(e,t){return Ol(e,t,!1)},Ol=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=di(t,void 0,!1),i=Sl(e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),i)},Sl=function(e,t,r){if(e){var n=e.get("type");return e.get("children1"),"group"===n||"rule_group"===n?Fl(e,t,r):"rule"===n?wl(e,t,r):void 0}},Fl=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new x.D5,i=e.get("children1")||new x.aV,l="rule_group"===n?o.get("field"):null;"array"==(Vi(t,l)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(l));var a=o.get("not"),u=i.map((function(e){return Sl(e,t,r)})).filter((function(e){return void 0!==e}));if(u.size){var s=o.get("conjunction");return s||(s=Pr(t)),t.conjunctions[s].sqlFormatConj(u,s,a)}},wl=function(e,t,r){var n=e.get("properties")||new x.D5,o=n.get("field"),i=n.get("fieldSrc"),l=n.get("operator"),a=n.get("operatorOptions"),u=n.get("valueSrc"),s=n.get("valueType"),c=n.get("value"),p=n.get("asyncListValues");if(null!=o&&null!=l){var d=Vi(t,o)||{},f=Ii(t,l,o)||{},v=f.reversedOp,g=Ii(t,v,o)||{},h=G(f),y=!1,m=f.sqlOp||f.sqlFormatOp,b=g.sqlOp||g.sqlFormatOp;if(m||b){if(!m&&b){y=!0;var O=[v,l];l=O[0],v=O[1];var S=[g,f];f=S[0],g=S[1]}var F,w=[],j=[];if(null!=c){var E=c.map((function(e,n){var i=u?u.get(n):null,a=s?s.get(n):null,c=xo(e,i,t),v=jo(t,o,l,i),g=D()(xi(t,o,l,v,i),["factory"]),h=jl(r,t,c,i,a,g,d,l,f,p);return void 0!==h&&(w.push(i),j.push(a)),h}));if(E.filter((function(e){return void 0===e})).size>0||E.size<h)return;F=1==h?E.first():E}var C=f.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=G(t);return 0==o?r=function(e,t,r,o,i,l,a,u){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,l,a,u){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,l,a,u){var s,c,p=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),d=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(n," ").concat(p," AND ").concat(d)}),r}(l,f);if(C){var L="func"==i?Cl(r,t,o):El(r,t,o);if(null!=L){var P,_=[L,l,F,w.length>1?w:w[0],j.length>1?j:j[0],D()(f,W),a,d];if(P=C.call.apply(C,[t.ctx].concat(_)),y&&(P=t.settings.sqlFormatReverse(P)),void 0!==P)return P;r.errors.push("Operator ".concat(l," is not supported for value source ").concat(w.join(", ")))}}else r.errors.push("Operator ".concat(l," is not supported"))}else r.errors.push("Operator ".concat(l," is not supported"))}},jl=function(e,t,r,n,o,i,l,a,u,s){if(void 0!==r){var c;if("field"==n)c=El(e,t,r);else if("func"==n)c=Cl(e,t,r);else if("function"==typeof i.sqlFormatValue){var p=i.sqlFormatValue,d=[r,ml(ml({},fe()(l,["fieldSettings","listValues"])),{},{asyncListValues:s}),D()(i,q)];if(a&&(d.push(a),d.push(u)),"field"==n){var f=Vi(t,r)||{};d.push(f)}c=p.call.apply(p,[t.ctx].concat(d))}else c=Array.isArray(r)?r.map((function(e){return yt.escape(e)})):yt.escape(r);return c}},El=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=Vi(t,r)||{},i=ki(r,t),l=yo(r,t),a=l?l.join(n):null;return(0,t.settings.formatField)(Eo(r,t,e,null,{useTableName:!0}),i,a,o,t)}},Cl=function(e,t,r){var n,o,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),l=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),a=Ci(t,i);if(a){var u=ki(i,t),s=u[u.length-1],c=a.sqlFunc||s,p={},d=[],f=[];for(var v in a.args){var g,h=a.args[v],y=Vi(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",S=l?l.get(v):void 0,F=S?S.get("value"):void 0,w=S?S.get("valueSrc"):void 0;"func"!==w&&null!==(g=F)&&void 0!==g&&g.toJS&&(F=F.toJS());var j=S?S.get("asyncListValues"):void 0,E=jl(e,t,F,w,h.type,y,h,null,null,j);if(null!=F&&void 0===E)return void("func"!=w&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(i)));var C=void 0;if(void 0===E&&!b&&null!=m&&void 0===(C=jl(e,t,m,O,h.type,y,h,null,null,j)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(i)));var L=null!=E?E:C;if(void 0!==L){if(d.length){var P,_=gl(v);try{for(_.s();!(P=_.n()).done;)p[P.value]=void 0}catch(e){_.e(e)}finally{_.f()}d=[]}p[v]=L}else b||f.push(v),d.push(v)}if(!f.length){var k;if("function"==typeof a.sqlFormatFunc){var Z=a.sqlFormatFunc,T=[p];k=Z.call.apply(Z,[t.ctx].concat(T))}else{var I=Object.entries(p).map((function(e){var t=(0,V.Z)(e,2);return t[0],t[1]})).join(", ");k="".concat(c,"(").concat(I,")")}return k}}else e.errors.push("Func ".concat(i," is not defined in config"))};function Ll(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ll(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ll(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _l(e,t,r,n,o,i){if(e&&r&&null!=t){var l=r,a=n.operators[l];if(a){var u=a.elasticSearchQueryType,s=!1;!u&&a.reversedOp&&(s=!0,l=a.reversedOp,u=(a=n.operators[l]).elasticSearchQueryType);var c=jo(n,e,l,o),p=n.widgets[c];if(p){var d,f,v=p.elasticSearchFormatValue;if(d="function"==typeof u?u(c):u)return f="function"==typeof v?v(d,t,l,e,n):function(e,t,r,n,o,i){var l=function(e,t){return e}(n);switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return(0,Z.Z)({},l,t[0]);case"term":return i===kl?(0,Z.Z)({},n,{value:t[0]}):(0,Z.Z)({},n,t[0]);case"geo_bounding_box":return(0,Z.Z)({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return(0,Z.Z)({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return(0,Z.Z)({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return(0,Z.Z)({},n,function(e){return{value:e}}(t[0]));default:return}}(d,t,l,e,n,i),s?{bool:{must_not:(0,Z.Z)({},d,Pl({},f))}}:(0,Z.Z)({},d,Pl({},f))}}}}var kl="ES_7_SYNTAX",Zl="ES_6_SYNTAX";function Tl(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zl;if(e){var n=e.get("type"),o=e.get("properties")||new Map;if("rule"===n&&o.get("field")){var i,l,a,u=o.get("operator"),s=o.get("field"),c=o.get("fieldSrc"),p=null===(i=o.get("value"))||void 0===i?void 0:i.toJS(),d=(null===(l=o.get("valueType"))||void 0===l||l.get(0),null===(a=o.get("valueSrc"))||void 0===a?void 0:a.get(0));if("func"===d||"func"==c)return;return p&&Array.isArray(p[0])?p[0].map((function(e){return _l(s,[e],u,t,d,r)})):_l(s,p,u,t,d,r)}if("group"===n||"rule_group"===n){var f=o.get("not"),v=o.get("conjunction");return v||(v=Pr(t)),function(e,t,r,n,o,i){if(e&&e.size){var l=e.valueSeq().toArray(),a=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),u=l.map((function(e){return n(e,o,i)})).filter((function(e){return void 0!==e}));if(u.length){var s=u.flat(1/0);return{bool:(0,Z.Z)({},a,s)}}}}(e.get("children1"),v,f,Tl,t,r)}}}var Vl=r(613),Il=r(70800),xl=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function Rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Al(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Nl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n=(0,Il.Z)(se().mark((function n(o,i,l){var a,u,s,c,p,d;return se().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=null!=(null==l?void 0:l.pageSize)?l.pageSize:t,u=je(e).filter((function(e){var t=e.title,r=e.value;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())||-1!="".concat(r).toUpperCase().indexOf(o.toUpperCase())})),a&&Math.ceil(u.length/a),s=i||0,a&&Math.ceil(s/a),c=a?u.slice(s,s+a):u,p=a?s+c.length:null,d=!!a&&p<u.length,!r){n.next=11;break}return n.next=11,te(r);case 11:return n.abrupt("return",{values:c,hasMore:d});case 12:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()},Ml=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return e;var o=e||[],i=t.filter((function(e){return null==o.find((function(t){return""+t.value==""+e.value}))})).map((function(e){return n?Al(Al({},e),{},{isHidden:!0}):e}));return r?[].concat((0,T.Z)(i),(0,T.Z)(o)):[].concat((0,T.Z)(o),(0,T.Z)(i))},ql=function(e,t,r){var n,o=null==e||""==e?void 0:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:e,i=ke(o,t),l=r&&!i?we(o):void 0,a=i||l;return[o,a?[a]:void 0]},Wl=function(e,t,r){var n=e.map((function(e,n){var o,i=null==e||""==e?void 0:null!==(o=null==e?void 0:e.value)&&void 0!==o?o:e,l=ke(i,t),a=r&&!l?we(i):void 0;return l||a})).filter((function(e){return null!=e})),o=n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e}));return o.length||(o=void 0),[o,n]},Gl=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,i=e.grouplabel,l=e.renderTitle,a=e.children,u=e.label,s=e.isCustom,c=e.isHidden,p=(0,Vl.Z)(e,xl),d={value:r,title:t||u||a};return n&&(d.disabled=n),s&&(d.isCustom=s),c&&(d.isHidden=c),(o||i)&&(d.groupTitle=o||i),l&&(d.renderTitle=l),Al(Al({},d),p)},Bl=function(e){var t,r=[],n=[],o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Rl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{var i=function(){var e=t.value,o=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,T.Z)(e).reverse().findIndex(t);return-1==r?-1:e.length-1-r}(r,(function(t){var r,n;return(null!==(r=t.groupTitle)&&void 0!==r?r:"")==(null!==(n=e.groupTitle)&&void 0!==n?n:"")}));null==e.groupTitle||n.includes(e.groupTitle)||(n.push(e.groupTitle),1===n.length&&(r=r.map((function(e){return Al(Al({},e),{},{groupTitle:""})})))),null==e.groupTitle&&n.length&&(e=Al(Al({},e),{},{groupTitle:""})),-1!=o?r.splice(o+1,0,e):r.push(e)};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}return r},Ul={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},zl={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim,i=r+(o.charAt(0).toUpperCase()+o.slice(1)+"s");return"".concat(t,".").concat(i,"(").concat(n,")")},spelImport:function(e){var t,r,n,o,i=null===(t=e.methodName)||void 0===t?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(o=i[2].toLowerCase(),r=i[1],["minus","plus"].includes(r)&&["day","week","month","year"].includes(o)))return r={type:"string",val:r},o={type:"string",val:o},n=e.args[0],{date:e.obj,op:r,val:n,dim:o}},jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},$l={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Jl={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Hl={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelImport:function(e){var t,r;if("op-plus"===e.type){var n=(0,V.Z)(e.children,2);if(r=n[0],t=n[1],"op-multiply"===r.type){var o=(0,V.Z)(r.children,2);return{coef:o[0],val:o[1],bias:t}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}};const Yl={utils:{SqlString:yt,moment:Qe(),mongoFormatOp1:function(e,t,r,n,o,i,l,a,u,s,c,p){var d="string"!=typeof n||n.startsWith("$")?n:"$"+n,f=t(i,p);if(void 0!==f)return r?l||e&&"$eq"!=e?l?{$not:(0,Z.Z)({},e,[d,f])}:(0,Z.Z)({},n,{$not:(0,Z.Z)({},e,f)}):(0,Z.Z)({},n,{$ne:f}):l||e&&"$eq"!=e?l?(0,Z.Z)({},e,[d,f]):(0,Z.Z)({},n,(0,Z.Z)({},e,f)):(0,Z.Z)({},n,f)},mongoFormatOp2:function(e,t,r,n,o,i,l,a,u,s,c){var p,d,f="string"!=typeof r||r.startsWith("$")?r:"$"+r;return t?i?{$not:{$and:[(0,Z.Z)({},e[0],[f,o[0]]),(0,Z.Z)({},e[1],[f,o[1]])]}}:(0,Z.Z)({},r,{$not:(p={},(0,Z.Z)(p,e[0],o[0]),(0,Z.Z)(p,e[1],o[1]),p)}):i?{$and:[(0,Z.Z)({},e[0],[f,o[0]]),(0,Z.Z)({},e[1],[f,o[1]])]}:(0,Z.Z)({},r,(d={},(0,Z.Z)(d,e[0],o[0]),(0,Z.Z)(d,e[1],o[1]),d))},mongoEmptyValue:bt,escapeRegExp:H,sqlEmptyValue:mt,stringifyForDisplay:jt,getTitleInListValues:Ce,spelEscape:St,spelFixList:Ot}};function Kl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ql(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ql(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ql(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ea={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,i,l,a,u){var s=a?"=":i.label;return"boolean"==o&&a?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(s," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,i,l,a,u){return"boolean"==o&&a?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(i.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(e){return e},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(e){return e},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return e},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(e){return e},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:"in",_jsonLogicIsRevArgs:!0,valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!0].concat(n))},valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?"^"+t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e)+"$":void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1);return a?"".concat(e," BETWEEN ").concat(u," AND ").concat(s):"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,l,a){var u=r[0],s=r[1];return"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1);return a?"".concat(e," NOT BETWEEN ").concat(u," AND ").concat(s):"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},spelFormatOp:function(e,t,r,n,o,i,l,a){var u=r[0],s=r[1];return"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") = ").concat(u)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") <> ").concat(u)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,l,a){var u=a?"=":"==";return"".concat(e," ").concat(u," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e){return e},!1].concat(r))},reversedOp:"select_any_in"},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains"},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,l,a){var u=a?"=":"==";return"value"==n?"".concat(e," ").concat(u," [").concat(r.join(", "),"]"):"".concat(e," ").concat(u," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this;return"value"==n?"".concat(e," = '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this;return"value"==n?"".concat(e," != '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"multiselect_equals"},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1),c=l.get("proximity");return"".concat(e," ").concat(u," NEAR/").concat(c," ").concat(s)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1),c=this.utils.SqlString.trim(u),p=this.utils.SqlString.trim(s),d=l.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(c,", ").concat(p,"), ").concat(d,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return 0},!1].concat(r))}}},ta={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return n?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=e.map((function(e){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?i.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var i=this;return e.map((function(e){return i.utils.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var i=o&&o.spelOp&&o.spelOp.startsWith("${1}"),l=this.utils.spelEscape(e);return i&&(l=this.utils.spelFixList(l)),l},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD");return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o,i,l;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&null!==(n=r.fmt)&&void 0!==n&&null!==(n=n.value)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n," ")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&null!==(l=i.toLowerCase)&&void 0!==l&&l.call(i).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var a=this.utils.moment(e.value,this.utils.moment.ISO_8601);return a.isValid()?[a.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(i,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var n,o,i;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&r.fmt&&(null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.toLowerCase)||void 0===o||!o.call(n).includes("hh:mm")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&i.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,"HH:mm:ss");return l.isValid()?[l.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(i.toDate())},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD HH:mm:ss");return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd HH:mm:ss","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o;if(!t)return[void 0,"No widget def to get value format"];if(null==r||null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.includes)||void 0===o||!o.call(n," "))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,this.utils.moment.ISO_8601);return i.isValid()?[i.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,n,o,i,l){return n&&l.label||e},sqlFormatValue:function(e,t,r,n,o,i){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]}}},ra=Xl(Xl({},si),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,n,o,i){var l=this,a=n.map((function(e,t){var r=e.key,n=e.parent,o=e.fieldSeparator;return 0==t?"[map]"==n?"#this[".concat(l.utils.spelEscape(r),"]"):r:"map"==n||"[map]"==n?"[".concat(l.utils.spelEscape(r),"]"):"".concat(o).concat(r)})).join("");return o.fieldName&&(a=e),o.isSpelVariable&&(a="#"+a),a},sqlFormatReverse:function(e){if(null!=e)return"NOT("+e+")"},spelFormatReverse:function(e){if(null!=e)return"!("+e+")"},formatReverse:function(e,t,r,n,o,i){if(null!=e)return i?"NOT ("+e+")":"!("+e+")"},formatAggr:function(e,t,r,n,o,i,l,a,u,s){var c=l.labelForFormat,p=l.cardinality;if(0==p){var d=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(d)}if(null==p||1==p){var f=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(f," ").concat(c," ").concat(n)}if(2==p){var v=e?" WHERE ".concat(e):"",g=n.first(),h=n.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(c," ").concat(g," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),na=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={rangeslider:la,treeselect:aa,treemultiselect:ua,rangeable__date:ia("date","date")},i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Kl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(t);try{for(i.s();!(r=i.n()).done;){var l=r.value,a=o[l];if(!a)throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(l));e=a(e,n)}}catch(e){i.e(e)}finally{i.f()}return e},oa=function(e,t){return na(e,t,!0)},ia=function(e,t){return function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.types;return o=Xl(Xl({},o),{},(0,Z.Z)({},e,Xl(Xl({},o[e]),{},{widgets:Xl({},o[e].widgets)}))),n?o[e].widgets[t]=Xl({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],Xl(Xl({},r),{},{types:o})}},la=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Xl({},r),t?r.rangeslider=Xl({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},singleWidget:"slider",toJS:function(e,t){return e}},r.rangeslider):delete r.rangeslider,n=Xl(Xl({},n),{},{number:Xl(Xl({},n.number),{},{widgets:Xl({},n.number.widgets)})}),t?n.number.widgets.rangeslider=Xl({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},n.number.widgets.rangeslider):delete n.number.widgets.rangeslider,Xl(Xl({},e),{},{widgets:r,types:n})},aa=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Xl({},r),t?r.treeselect=Xl({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,i=this.utils.getTitleInListValues(o,e);return n?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treeselect):delete r.treeselect,n=Xl({},n),t?n.treeselect=Xl({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},n.treeselect):delete n.treeselect,Xl(Xl({},e),{},{widgets:r,types:n})},ua=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Xl({},r),t?r.treemultiselect=Xl({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,l=e.map((function(e){return o.utils.getTitleInListValues(i,e)}));return n?l.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var i=this;return e.map((function(e){return i.utils.SqlString.escape(e)}))},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treemultiselect):delete r.treemultiselect,n=Xl({},n),t?n.treemultiselect=Xl({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},n.treemultiselect):delete n.treemultiselect,Xl(Xl({},e),{},{widgets:r,types:n})},sa={addMixins:oa,removeMixins:function(e,t){return na(e,t,!1)}},ca={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"AND":"&&")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" AND ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" && ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:ea,widgets:ta,types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{}}}},settings:ra,ctx:Yl};const pa=ca=oa(ca,["rangeslider","treeselect","treemultiselect"]);var da="ADD_GROUP",fa="ADD_CASE_GROUP",va="REMOVE_GROUP",ga="SET_CONJUNCTION",ha="SET_NOT",ya="ADD_RULE",ma="REMOVE_RULE",ba="SET_FIELD",Oa="SET_FIELD_SRC",Sa="SET_OPERATOR",Fa="SET_VALUE",wa="SET_VALUE_SRC",ja="SET_FUNC_VALUE",Ea="SET_OPERATOR_OPTION",Ca="SET_LOCK",La="SET_TREE",Pa="MOVE_ITEM",_a="after",ka="before",Za="append",Ta="prepend",Va="SET_DRAG_PROGRESS",Ia="SET_DRAG_START",xa="SET_DRAG_END",Ra=r(61230),Da=r.n(Ra);function Aa(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Na(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Na(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Na(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ma(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ma(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ma(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Wa=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},s=(null==o||null===(l=o.get)||void 0===l?void 0:l.call(o,"id"))||n,c=i.settings.shouldCreateEmptyGroup,p=t.push(s),d=!c,f=!(null==u||!u.isDefaultCase),v=e;return(e=Ba(e,t,r,s,_r(i).merge((0,x.d0)(o)||{}),i,a))!==v&&(a||f||(e=e.setIn(Ze(p,"children1"),new x.ZP.OrderedMap),d&&(e=Ba(e,p,"rule",N(),Cr(i),i))),e=xe(e)),e},Ga=function e(t,r,n){n&&Array.isArray(n)&&(r.children1=new x.ZP.OrderedMap(n.reduce((function(r,n){var o,i=null!==(o=n.id)&&void 0!==o?o:N(),l=qa(qa({},n),{},{properties:kr(t,n).merge((0,x.d0)(n.properties)||{}),id:i});return e(t,l,l.children1),qa(qa({},r),{},(0,Z.Z)({},i,new x.ZP.Map(l)))}),{})))},Ba=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=(null==o||null===(l=o.get)||void 0===l?void 0:l.call(o,"id"))||n;if("switch_group"==r)throw new Error("Can't add switch_group programmatically");var s,c,p=i.settings,d=p.maxNumberOfCases,f=p.maxNumberOfRules,v=p.maxNesting,g="switch_group"==e.get("type"),h=e.getIn(Ze(t)),y=g?e.getIn(Ze(t.take(2))):null,m=Ze(t,"children1"),b=e.getIn(m),O=!!b&&b.size,S=O?b.size:null;"case_group"==r?(s=S,c=d):"group"==r?(s=t.size,c=v):"rule_group"==(null==h?void 0:h.get("type"))||(s=Ne(g?y:e),c=f);var F=!c||!s||s<c,w={type:r,id:u,properties:o};Ga(i,w,a);var j="case_group"==r&&O&&null==b.last().get("children1");if(F){var E=new x.ZP.OrderedMap((0,Z.Z)({},u,new x.ZP.Map(w)));if(O)if(j){var C,L=b.last(),P=new x.ZP.OrderedMap((C={},(0,Z.Z)(C,u,new x.ZP.Map(w)),(0,Z.Z)(C,L.get("id"),L),C));e=(e=e.deleteIn(Ze(m,"children1",L.get("id")))).mergeIn(m,P)}else e=e.mergeIn(m,E);else e=e.setIn(m,E);e=xe(e)}return e},Ua=function(e,t){return e=e.deleteIn(Ze(t)),xe(e)},za=function(e,t,r,n,o){var i,l,a,u,s,c,p,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=d.__isInternal,v=d.isEndValue,g=d.canDropArgs;if(!r)return{tree:Ua(e,t),isInternalValueChange:p};var h=n.settings,y=h.fieldSeparator,m=h.setOpOnChangeField,b=h.showErrorMessage;Array.isArray(r)&&(r=r.join(y));var O=e.getIn(Ze(t,"type")),S=e.getIn(Ze(t,"properties")),F="rule_group"==O,w=null==S?void 0:S.get("fieldSrc"),j=null==S?void 0:S.get("fieldError"),E=Vi(n,r);if(!E)return console.warn("No config for LHS ".concat(r)),{tree:e,isInternalValueChange:p};var C=E.type;"!group"!==C&&"!struct"!==C||(C=null);var L=null==S?void 0:S.get("operator"),P=null==S?void 0:S.get("operatorOptions"),_=null==S?void 0:S.get("field"),k=null==S||null===(i=S.get("valueError"))||void 0===i||null===(l=i.join)||void 0===l?void 0:l.call(i,"|"),Z="!group"==E.type,T=Z&&"array"==E.mode,V=F!=Z,I=E&&-1!==(null===(a=E.operators)||void 0===a?void 0:a.indexOf(L))?L:null,R="func"===w&&(null==_||null===(u=_.get)||void 0===u?void 0:u.call(_,"func"))===(null===(s=r)||void 0===s||null===(c=s.get)||void 0===c?void 0:c.call(s,"func"))&&!!I,D=null,A="func"===w?po(n,C):fo(n,r);if(A&&1==A.length)D=A[0];else if(R)D=I;else if(A&&A.length>1){var M,q=Aa(m);try{for(q.s();!(M=q.n()).done;){var W=M.value;if("keep"!=W||V?"default"==W?D=jr(n,r,!1):"first"==W&&(D=vo(n,r)):D=I,D)break}}catch(e){q.e(e)}finally{q.f()}}if(!Z&&!E.operators)return console.warn("Type ".concat(E.type," is not supported")),{tree:e,isInternalValueChange:p};F&&!Z&&(e=(e=(e=e.setIn(Ze(t,"type"),"rule")).deleteIn(Ze(t,"children1"))).setIn(Ze(t,"properties"),new x.ZP.OrderedMap)),S||(e=e.setIn(Ze(t,"properties"),new x.ZP.OrderedMap));var G=!b;if(Z){e=e.setIn(Ze(t,"type"),"rule_group");var B=eo(n,n,S,r,D,"field",G,v,g),U=(B.canReuseValue,B.newValue),z=B.newValueSrc,$=B.newValueType,J=B.operatorCardinality,H=_r(n,E).merge({field:r,fieldSrc:"field",mode:E.mode});T&&(H=H.merge({operator:D,value:U,valueSrc:z,valueType:$})),e=(e=e.setIn(Ze(t,"children1"),new x.ZP.OrderedMap)).setIn(Ze(t,"properties"),H),E.initialEmptyWhere&&1==J||(e=Ba(e,t,"rule",N(),Cr(n,r),n)),e=xe(e)}else e=e.updateIn(Ze(t,"properties"),(function(e){return e.withMutations((function(e){var t,o=eo(n,n,e,r,D,"field",G,v,g),i=o.canReuseValue,l=o.newValue,a=o.newValueSrc,u=o.newValueType,s=o.newValueError,c=o.newFieldError,d=o.fixedField,h=null==s||null===(t=s.join)||void 0===t?void 0:t.call(s,"|"),y=r,m=d!==r;m&&(y=d);var O=(b?j!=c:!!j!=!!c)||(b?k!=h:!!k!=!!h);p=!!f&&!O&&!m,(b||f&&O)&&(e=(e=e.set("fieldError",c)).set("valueError",s));var S=i?P:Er(n,D,y);return e=e.set("field",y).delete("fieldType").set("fieldSrc",w).set("operator",D).set("operatorOptions",S).set("value",l).set("valueSrc",a).set("valueType",u),i||(e=e.delete("asyncListValues")),e}))}));return{tree:e,isInternalValueChange:p}},$a=function(e,t,r,n,o,i,l){var a,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},s=u.__isInternal,c=u.canDropArgs,p=u.isEndValue,d=i.settings,f=d.fieldSeparator,v=d.showErrorMessage,g=e.getIn(Ze(t,"properties","valueSrc",r+""))||null;"field"===g&&Array.isArray(n)&&(n=n.join(f));var h=e.getIn(Ze(t,"properties","field"))||null,y=e.getIn(Ze(t,"properties","operator"))||null,m=Ii(i,y,h),b=y?G(m):null,O=o||go(n,g,i),S=Hn(i,h,h,y,n,O,g,l,!v,p,c),F=(0,V.Z)(S,2),w=F[0],j=F[1],E=null==j?void 0:j.find((function(e){return!e.fixed&&!e.ignore})),C=E?Vn(E):null,L=w!==n;L&&(n=w),e=Ja(e,t,i,b);var P=Array.from({length:b},(function(o,i){return i==r?n:e.getIn(Ze(t,"properties","value",i+""))||null})),_=Array.from({length:b},(function(r,n){return e.getIn(Ze(t,"properties","valueSrc",n+""))||null})),k=Xn(i,h,y,P,_),Z=k?Vn(k):null,T=!C&&!Z,I=e.getIn(Ze(t,"properties","value",r)),R=e.getIn(Ze(t,"properties","valueError",r)),D=e.getIn(Ze(t,"properties","valueError",b)),A=(v?R!=C:!!R!=!!C)||(v?D!=Z:!!D!=!!Z);return a=!(!s||!!I!=!!n||A||L),(!!v||T||L)&&(e=e.deleteIn(Ze(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn(Ze(t,"properties","value",r),void 0)).setIn(Ze(t,"properties","valueType",r),null):(l&&(e=e.setIn(Ze(t,"properties","asyncListValues"),l)),e=(e=e.setIn(Ze(t,"properties","value",r),n)).setIn(Ze(t,"properties","valueType",r),O))),(v||s&&A)&&(e.getIn(Ze(t,"properties","valueError"))||(e=e.setIn(Ze(t,"properties","valueError"),new x.ZP.List(new Array(b)))),e=e.setIn(Ze(t,"properties","valueError",r),C),b>=2&&(e=e.setIn(Ze(t,"properties","valueError",b),Z))),{tree:e,isInternalValueChange:a}},Ja=function(e,t,r,n){if(!n){var o=e.getIn(Ze(t,"properties","field"))||null,i=e.getIn(Ze(t,"properties","operator"))||null,l=Ii(r,i,o);n=i?G(l):null}for(var a=0,u=["value","valueType","valueError","valueSrc"];a<u.length;a++){var s=u[a];e.getIn(Ze(t,"properties",s))||(e=e.setIn(Ze(t,"properties",s),new x.ZP.List(n?Array.from({length:n}):[])))}return e},Ha={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},Ya=function(e,t){return{type:La,tree:t,config:e}},Ka=function(e,t,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{type:ya,ruleType:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",children:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,path:$(t),id:N(),properties:Cr(e,n).merge((0,x.d0)(r)||{}),config:e}},Qa=function(e,t){return{type:ma,path:$(t),config:e}},Xa=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:fa,path:$(t),children:n,id:N(),properties:_r(e).merge((0,x.d0)(r)||{}),config:e,meta:{isDefaultCase:!0}}},eu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:fa,path:$(t),children:n,id:N(),properties:_r(e).merge((0,x.d0)(r)||{}),config:e}},tu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:da,path:$(t),children:n,id:N(),properties:_r(e).merge((0,x.d0)(r)||{}),config:e}},ru=function(e,t){return{type:va,path:$(t),config:e}},nu=function(e,t,r,n){return{type:Pa,fromPath:$(t),toPath:$(r),placement:n,config:e}},ou=function(e,t,r){return{type:ga,path:$(t),conjunction:r}},iu=function(e,t,r){return{type:ha,path:$(t),not:r}},lu=function(e,t,r){return{type:Ca,path:$(t),lock:r}},au=function(e,t,r,n,o){return{type:ba,path:$(t),field:r,config:e,asyncListValues:n,_meta:o}},uu=function(e,t,r){return{type:Oa,path:$(t),srcKey:r,config:e}},su=function(e,t,r){return{type:Sa,path:$(t),operator:r,config:e}},cu=function(e,t,r,n,o,i,l){return{type:Fa,path:$(t),delta:r,value:n,valueType:o,asyncListValues:i,config:e,_meta:l}},pu=function(e,t,r,n,o){return{type:wa,path:$(t),delta:r,srcKey:n,config:e,_meta:o}},du=function(e,t,r,n,o,i,l,a,u){return{type:ja,path:$(t),delta:r,parentFuncs:n,argKey:o,value:i,valueType:l,asyncListValues:a,config:e,_meta:u}},fu=function(e,t,r,n){return{type:Ea,path:$(t),name:r,value:n,config:e}};function vu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vu(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var hu=gu(gu(gu({},g),{},{Export:f,Import:a,ConfigMixins:sa},f),a),yu=r(7862),mu=r.n(yu);const bu=function(e,t,r,n,o){var i=qa({tree:t},Ha);return function(){var t,l,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,u=arguments.length>1?arguments[1]:void 0,s=null!==(t=null!==(l=null==o?void 0:o())&&void 0!==l?l:u.config)&&void 0!==t?t:e,c={},p=function(e,t){if(!e||!e.type)return null;var r,n=[La,Ia,Va,xa],o=Da()(D()(e,["config","asyncListValues"]),J),i=e.path&&function(e,t){return e.getIn(Ze(t,"properties","field"))||null}(t.tree,e.path)||e.field;return i&&(null!==(r=i)&&void 0!==r&&r.toJS&&(i=i.toJS()),o.affectedField=i),(n.includes(e.type)||0==e.type.indexOf("@@redux"))&&(o=null),o}(u,a);switch(null==u?void 0:u.type){case La:var d=r(s,u.tree);c.tree=d;break;case fa:c.tree=Wa(a.tree,u.path,"case_group",u.id,u.properties,s,u.children,u.meta);break;case da:c.tree=Wa(a.tree,u.path,"group",u.id,u.properties,s,u.children,u.meta);break;case va:c.tree=function(e,t,r){e=Ua(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);return Ge(e,o)||n||(e=Re(e),!We(e)||n)||(e=Ba(e,new x.ZP.List,"rule",N(),Cr(r,void 0,void 0,!1,!1),r)),xe(e)}(a.tree,u.path,s);break;case ya:c.tree=Ba(a.tree,u.path,u.ruleType,u.id,u.properties,s,u.children);break;case ma:c.tree=function(e,t,r){e=Ua(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),i=e.getIn(Ze(o)),l=i.getIn(["properties","field"]),a=i.getIn(["properties","operator"]),u=(i.getIn(["properties","value",0]),l?Vi(r,l):null),s=a?Ii(r,a,l):null,c=l&&a&&0!=s.cardinality,p="rule_group"==i.get("type"),d=!Ge(e,o),f=p?c&&u.initialEmptyWhere:n;return d&&!f&&(p&&(e=e.deleteIn(Ze(o))),e=Re(e),We(e)&&!n)&&(e=Ba(e,new x.ZP.List,"rule",N(),Cr(r,void 0,void 0,!1,!1),r)),xe(e)}(a.tree,u.path,s);break;case ga:c.tree=function(e,t,r){return e.setIn(Ze(t,"properties","conjunction"),r)}(a.tree,u.path,u.conjunction);break;case ha:c.tree=function(e,t,r){return e.setIn(Ze(t,"properties","not"),r)}(a.tree,u.path,u.not);break;case ba:var f=s.settings.optimizeRenderWithInternals,v=za(a.tree,u.path,u.field,s,u.asyncListValues,u._meta),g=v.tree,h=v.isInternalValueChange;c.__isInternalValueChange=f&&h,c.tree=g;break;case Oa:c.tree=function(e,t,r,n){var o=n.settings.keepInputOnChangeFieldSrc,i=e.getIn(Ze(t)),l=(i.get("type"),i.get("properties")),a=null==l?void 0:l.get("field"),u=null==l?void 0:l.get("fieldType"),s=Vi(n,a),c=(null==s?void 0:s.type)||u;c&&"!group"!==c&&"!struct"!==c||(c=null);var p=!co.includes(c);return(e=o&&!Co(i,n)&&p?(e=(e=e.setIn(Ze(t,"properties","field"),null)).deleteIn(Ze(t,"properties","fieldError"))).setIn(Ze(t,"properties","fieldType"),c):e.setIn(Ze(t,"properties"),Cr(n,null,null,!1))).setIn(Ze(t,"properties","fieldSrc"),r)}(a.tree,u.path,u.srcKey,s);break;case Ca:c.tree=function(e,t,r){return Ie(e.setIn(Ze(t,"properties","isLocked"),r))}(a.tree,u.path,u.lock);break;case Sa:c.tree=function(e,t,r,n){var o=n.settings.showErrorMessage,i=e.getIn(Ze(t,"properties")),l=e.getIn(Ze(t,"children1")),a=i.get("field"),u=(i.get("fieldSrc"),Vi(n,a)),s="!group"==(null==u?void 0:u.type),c=Ii(n,r,a),p=c?G(c):null;return e=e.updateIn(Ze(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),i=e.get("operatorOptions"),l=(e.get("value",new x.ZP.List),e.get("valueSrc",new x.ZP.List),e.get("operator"),eo(n,n,e,t,r,"operator",!0)),a=l.canReuseValue,u=l.newValue,s=l.newValueSrc,c=l.newValueType,p=l.newValueError;o&&(e=e.set("valueError",p));var d=a?i:Er(n,r,t);return a||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",d).set("value",u).set("valueSrc",s).set("valueType",c)}))})),s&&0==p&&0==l.size&&(e=Ba(e,t,"rule",N(),Cr(n,a),n)),e}(a.tree,u.path,u.operator,s);break;case Fa:var y=s.settings.optimizeRenderWithInternals,m=$a(a.tree,u.path,u.delta,u.value,u.valueType,s,u.asyncListValues,u._meta),b=m.tree,O=m.isInternalValueChange;c.__isInternalValueChange=y&&O,c.tree=b;break;case ja:var S=s.settings.optimizeRenderWithInternals,F=function(e,t,r,n,o,i,l,a,u){var s,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{},p=(e.settings.showErrorMessage,-1===n),d=t.getIn(Ze(r,"properties")),f=d.get("field"),v=d.get("value"),g=[],h=p?f:v.getIn([n]),y=Aa(o||[]);try{for(y.s();!(s=y.n()).done;){var m=(0,V.Z)(s.value,2),b=m[0],O=m[1];if(g.push([b,O,h]),b!==h.get("func")){var S=g.map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")||"root";throw new Error("In ".concat(p?"LHS":"RHS"," for path ").concat(S," expected func key ").concat(b," but got ").concat(parent.get("func")))}h=h.getIn(["args",O,"value"])}}catch(e){y.e(e)}finally{y.f()}if(i){var F=h.get("func"),w=Ci(e,F).args[i];h="!valueSrc"===a?uo(h,i,l,w,e):ao(h,i,l,w,e)}else h=no(h,l,e,!0),c.canDropArgs=!0;for(var j=h;g.length;){var E=g.pop(),C=(0,V.Z)(E,3),L=C[0],P=C[1],_=C[2],k=Ci(e,L).args[P];j=ao(_,P,j,k,e)}return p?za(t,r,j,e,u,c):$a(t,r,n,j,void 0,e,u,c)}(s,a.tree,u.path,u.delta,u.parentFuncs,u.argKey,u.value,u.valueType,u.asyncListValues,u._meta),w=F.tree,j=F.isInternalValueChange;c.__isInternalValueChange=S&&j,c.tree=w;break;case wa:c.tree=function(e,t,r,n,o){var i=o.settings.showErrorMessage,l=e.getIn(Ze(t,"properties","field"))||null,a=e.getIn(Ze(t,"properties","operator"))||null,u=Ii(o,a,l),s=a?G(u):null;if(e=(e=(e=(e=Ja(e,t,o,s)).setIn(Ze(t,"properties","value",r+""),void 0)).setIn(Ze(t,"properties","valueType",r+""),null)).deleteIn(Ze(t,"properties","asyncListValues")),i&&(e=e.setIn(Ze(t,"properties","valueError",r),null),u.validateValues&&(e=e.setIn(Ze(t,"properties","valueError",s),null))),e=void 0===n?e.setIn(Ze(t,"properties","valueSrc",r+""),null):e.setIn(Ze(t,"properties","valueSrc",r+""),n),n){var c=e.getIn(Ze(t,"properties")),p=eo(o,o,c,l,a,"valueSrc",!0),d=p.canReuseValue,f=p.newValue,v=p.newValueSrc,g=p.newValueType;p.newValueError,d||v.get(r)!=n||(e=(e=e.setIn(Ze(t,"properties","value",r+""),f.get(r))).setIn(Ze(t,"properties","valueType",r+""),g.get(r)))}return e}(a.tree,u.path,u.delta,u.srcKey,s,u._meta);break;case Ea:c.tree=function(e,t,r,n){return e.setIn(Ze(t,"properties","operatorOptions",r),n)}(a.tree,u.path,u.name,u.value);break;case Pa:c.tree=function(e,t,r,n,o){var i=Ve(e,t),l=t.pop(),a=t.size>1?Ve(e,l):null,u=a?a.get("children1"):null,s=Ve(e,r),c=n==Za||n==Ta?r:r.pop(),p=n==Za||n==Ta?s:r.size>1?Ve(e,c):null,d=p?p.get("children1"):null;if(!a||!p||!i)return e;var f=a.get("id")==p.get("id"),v=c.size<l.size&&B(c.toArray(),l.toArray().slice(0,c.size)),g=c.size>l.size&&B(l.toArray(),c.toArray().slice(0,l.size)),h=null,y=null;v?h=x.ZP.List(l.toArray().slice(c.size)):g&&(y=x.ZP.List(c.toArray().slice(l.size)));var m=d,b=u;return g||(b=b.delete(i.get("id"))),f?m=b:v&&(m=m.updateIn(Te(h,"children1"),(function(e){return b}))),n==ka||n==_a?m=x.ZP.OrderedMap().withMutations((function(e){var t,r=Aa(m.entries());try{for(r.s();!(t=r.n()).done;){var o=(0,V.Z)(t.value,2),l=o[0],a=o[1];l==s.get("id")&&n==ka&&e.set(i.get("id"),i),e.set(l,a),l==s.get("id")&&n==_a&&e.set(i.get("id"),i)}}catch(e){r.e(e)}finally{r.f()}})):n==Za?m=m.merge(x.ZP.OrderedMap((0,Z.Z)({},i.get("id"),i))):n==Ta&&(m=x.ZP.OrderedMap((0,Z.Z)({},i.get("id"),i)).merge(m)),g&&(b=(b=b.updateIn(Te(y,"children1"),(function(e){return m}))).delete(i.get("id"))),f||v||(e=e.updateIn(Ze(l,"children1"),(function(e){return b}))),g||(e=e.updateIn(Ze(c,"children1"),(function(e){return m}))),xe(e)}(a.tree,u.fromPath,u.toPath,u.placement);break;case Ia:c.dragStart=u.dragStart,c.dragging=u.dragging,c.mousePos=u.mousePos;break;case Va:c.mousePos=u.mousePos,c.dragging=u.dragging;break;case xa:c.tree=function(e,t){return t.settings.canLeaveEmptyGroup||(e=Re(e)),e}(a.tree,s),c=qa(qa({},c),Ha)}return p&&(c.__lastAction=p),n&&c.tree&&a.tree&&n(a.tree),qa(qa(qa({},a),{__isInternalValueChange:void 0,__lastAction:void 0}),c)}},Ou=k.createContext();var Su=r(82923),Fu=r(88543),wu="after",ju="before",Eu="append",Cu="prepend",Lu=function(e,t){return{type:"SET_DRAG_PROGRESS",mousePos:e,dragging:t}},Pu=function(e,t,r){return{type:"SET_DRAG_START",dragStart:e,dragging:t,mousePos:r}},_u=function(){return{type:"SET_DRAG_END"}},ku=y,Zu=m,Tu=b;function Vu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Iu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Iu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xu=hu.ConfigUtils,Ru=xu.extendConfig,Du=xu.configKeys,Au=function(){var e=new Map,t=0;return{getExtended:function(r){return function(r){return function(t){var r,n=Vu(e.keys());try{var o=function(){var n=r.value;if(Du.filter((function(e){return n[e]===t[e]})).length===Du.length)return{v:e.get(n)}};for(n.s();!(r=n.n()).done;){var i=o();if("object"===(0,I.Z)(i))return i.v}}catch(e){n.e(e)}finally{n.f()}var l,a=Vu(e.values());try{var u=function(){var e=l.value;if(Du.filter((function(r){return e[r]===t[r]})).length===Du.length)return{v:e}};for(a.s();!(l=a.n()).done;){var s=u();if("object"===(0,I.Z)(s))return s.v}}catch(e){a.e(e)}finally{a.f()}return null}(r)||function(r){var n=Ru(r,++t);return e.size+1>2&&e.delete(e.keys().next().value),e.set(r,n),n}(r)}(function(e){return fe()(e,Du)}(r))},getBasic:function(t){var r,n=Vu(e.keys());try{var o=function(){var n=r.value,o=e.get(n);if(0===Du.map((function(e){return o[e]===t[e]})).filter((function(e){return!e})).length)return{v:n}};for(n.s();!(r=n.n()).done;){var i=o();if("object"===(0,I.Z)(i))return i.v}}catch(e){n.e(e)}finally{n.f()}return t}}},Nu=(r(73656),function(e,t,r){if(!t||!e||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."}),Mu=function(e,t){return e===t||(null==e?void 0:e.equals(t))},qu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?qu(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):e&&"function"==typeof e.equals?e.equals(t):"object"===(0,I.Z)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var l=0;l<i;l++){var a=n[l];if(!(r?qu(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)},Wu=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null!=e&&e?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}}(),Gu=hu.Validation.validateAndFixTree,Bu=function e(t){if(t){var r,n=(r=t)._reactRootContainer?"root":Object.getOwnPropertyNames(r).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==n?n:e(t.parentNode)}},Uu=function(e){return"root"===Bu(e)},zu=function(e,t){return function(r,n){var o=e.props,i=e.state,l=r!=o||n!=i;if(l&&i==n&&o!=r){var a=[];for(var u in r){var s=r[u]!=o[u];s&&("ignore"==t[u]?s=!1:"shallow_deep"==t[u]?s=!qu(r[u],o[u],!0):"shallow"==t[u]?s=!qu(r[u],o[u]):"function"==typeof t[u]&&(s=t[u](r[u],o[u],n))),s&&a.push(u)}a.length||(l=!1)}return l}},$u=function(e){return function(t,r){return!qu(e.props,t)||!qu(e.state,r)}},Ju=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=$u(e)),16==(r=k.version.split(".").map(parseInt.bind(null,10)))[0]&&r[1]<3||r[0]<16)e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var t=e.shouldComponentUpdate;e.shouldComponentUpdate=function(r,n){return!qu(e.props,r)&&e.onPropsChanged(r),t.call(e,r,n)}.bind(e)}var r},Hu=function(e,t,r){return Da()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r(e.apply(void 0,[t].concat(o)))}}))};function Yu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ku(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yu(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qu=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;(0,j.Z)(this,o),(t=n.call(this,e)).shouldComponentUpdate=zu((0,C.Z)(t),{tree:function(e){return e!==t.oldValidatedTree||t.oldValidatedTree!==t.validatedTree}}),Ju((0,C.Z)(t)),t._updateActions(e),t.validatedTree=e.getMemoizedTree(e.config,e.tree,void 0,e.sanitizeTree),t.oldValidatedTree=t.validatedTree;var r=e.getBasicConfig(e.config);return e.onInit&&e.onInit(t.validatedTree,r,void 0,t.actions),t}return(0,E.Z)(o,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=Hu(Ku(Ku(Ku({},ku),Zu),Tu),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);if(this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!Mu(this.validatedTree,this.oldValidatedTree)){var i=e.getBasicConfig(o);t&&t(this.validatedTree,i,e.__lastAction,this.actions)}}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch,o=e.__isInternalValueChange;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n,__isInternalValueChange:o})}}]),o}(k.Component);Qu.propTypes={config:mu().object.isRequired,onChange:mu().func,onInit:mu().func,renderBuilder:mu().func,tree:mu().any};var Xu=(0,Fu.$j)((function(e){return{tree:e.tree,__isInternalValueChange:e.__isInternalValueChange,__lastAction:e.__lastAction}}),null,null,{context:Ou})(Qu);Xu.displayName="ConnectedQuery";const es=Xu;var ts=hu.DefaultUtils.defaultRoot,rs=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e,t){var r;(0,j.Z)(this,o),(r=n.call(this,e,t)).setLastTree=function(e){r.prevTree&&(r.prevprevTree=r.prevTree),r.prevTree=e},r.getConfig=function(){return r.config},r.shouldComponentUpdate=zu((0,C.Z)(r),{value:function(e,t,r){return!1}}),Ju((0,C.Z)(r));var i=Au(),l=i.getExtended,a=i.getBasic;r.getMemoizedConfig=l,r.getBasicConfig=a,r.getMemoizedTree=function(){var e,t,r;return function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o?n.__configId===r&&(Mu(o,e)||Mu(o,t))?t:(r=n.__configId,e=o,t=!1===l?Gu(o,null,n,i||n,!1,!1,!1):Gu(o,null,n,i||n)):null}}();var u=r.getMemoizedConfig(e),s=u.settings.shouldCreateEmptyGroup,c=ts(u,!s),p=!!e.value,d=e.value||c,f=r.getMemoizedTree(u,d,void 0,p),v=bu(u,f,r.getMemoizedTree,r.setLastTree,r.getConfig),g=(0,Su.MT)(v);return r.config=u,r.state={store:g},r.QueryWrapper=function(e){return u.settings.renderProvider(e,u.ctx)},r}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props,r=this.config,n=this.getMemoizedConfig(e),o=r!==n,i=this.state.store.getState().tree,l=!Mu(e.value,this.props.value)&&!Mu(e.value,i),a=l?e.value||ts(e):i,u=l&&!Mu(e.value,this.prevTree)&&!Mu(e.value,this.prevprevTree);if(this.sanitizeTree=u||o,o&&(t.settings.renderProvider!==e.settings.renderProvider&&(this.QueryWrapper=function(e){return n.settings.renderProvider(e,n.ctx)}),this.config=n),l||o){var s=this.getMemoizedTree(n,a,r,this.sanitizeTree);this.state.store.dispatch(ku.setTree(n,s))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.onInit,i=this.state.store,l=this.config,a=this.QueryWrapper;return k.createElement(a,{config:l},k.createElement(Fu.zt,{store:i,context:Ou},k.createElement(es,{config:l,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:n,onInit:o,renderBuilder:t||r})))}}]),o}(k.Component);rs.propTypes={conjunctions:mu().object.isRequired,fields:mu().object.isRequired,types:mu().object.isRequired,operators:mu().object.isRequired,widgets:mu().object.isRequired,settings:mu().object.isRequired,ctx:mu().object.isRequired,onChange:mu().func,onInit:mu().func,renderBuilder:mu().func,value:mu().any};var ns=r(63050),os=r(87608),is=r.n(os);var ls=hu.ConfigUtils.getFieldConfig;var as=hu.clone,us=hu.TreeUtils.getFlatTree,ss=!1,cs=["isDraggingTempo","isDraggingMe","dragging"];const ps=function(e){return function(t){var r;return r=function(r){(0,L.Z)(l,r);var n,o,i=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,_.Z)(n);if(o){var r=(0,_.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,P.Z)(this,e)});function l(e){var t;return(0,j.Z)(this,l),(t=i.call(this,e)).handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=k.createRef(),t}return(0,E.Z)(l,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,i=r.dragging,l=(0,Vl.Z)(r,cs),a=l.isTrueLocked,u={};o&&n&&(ss||(u={top:i.y,left:i.x,width:i.w}));var s=is()(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,a?"locked":null);return k.createElement("div",{className:s,style:u,ref:this.wrapper,"data-id":this.props.id},k.createElement(t,(0,ns.Z)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},l)))}}]),l}(k.PureComponent),r.propTypes={isDraggingTempo:mu().bool,isDraggingMe:mu().bool,onDragStart:mu().func,dragging:mu().object,isLocked:mu().bool,isTrueLocked:mu().bool},r}};var ds=r(62096),fs=r.n(ds),vs=r(57383),gs=r.n(vs);function hs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var ys=hu.ConfigUtils,ms=ys.getFieldConfig,bs=ys.getOperatorConfig,Os=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),t=n.call(this,e),Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.selectedField,o=e.selectedFieldType,i=e.selectedOperator,l=ms(r,n),a=(0,T.Z)((null==l?void 0:l.operators)||(null===(t=r.types[o])||void 0===t?void 0:t.operators)||[]);n||a.includes(i)||a.push(i);var u=Da()(gs()(r.operators,(function(e,t){return-1!==(null==a?void 0:a.indexOf(t))})),(function(e,t){return bs(r,t,n)})),s=this.buildOptions(r,u,a),c=u[i]||{},p=i?[i]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:s,selectedKey:i,selectedKeys:p,selectedPath:p,selectedLabel:c.label,selectedOpts:c,fieldConfig:l}}},{key:"buildOptions",value:function(e,t,r){return t&&r?fs()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){return{key:e,path:e,label:t[e].label}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderOperator,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hs(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:l,config:t,customProps:r,readonly:o,setField:n},this.meta);return u.items?a(u,t.ctx):null}}]),o}(k.Component);Os.propTypes={id:mu().string,groupId:mu().string,config:mu().object.isRequired,selectedField:mu().any,selectedFieldType:mu().string,selectedFieldSrc:mu().string,selectedOperator:mu().string,readonly:mu().bool,setOperator:mu().func.isRequired};var Ss=["children"],Fs=function(e){var t=e.children,r=(0,Vl.Z)(e,Ss);return k.createElement("div",r,t)},ws=function(){},js=function(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},k.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),k.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},Es=function(e){return function(t){var r=t.config.settings.useConfirm,n=r?r.call(t.config.ctx,t.config.ctx):null;return k.createElement(e,(0,ns.Z)({},t,{confirmFn:n}))}};var Cs=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,l=e.setOperator,a=e.selectedFieldParts,u=e.showOperator,s=e.showOperatorLabel,c=e.selectedFieldWidgetConfig,p=e.readonly,d=e.id,f=e.groupId;return[u&&k.createElement(Fs,{key:"operators-for-"+(a||[]).join("_"),className:"rule--operator"},t.settings.showLabels&&k.createElement("label",{className:"rule--label"},t.settings.operatorLabel),k.createElement(Os,{key:"operator",config:t,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,selectedOperator:i,setOperator:l,readonly:p,id:d,groupId:f})),s&&k.createElement(Fs,{key:"operators-for-"+(a||[]).join("_"),className:"rule--operator"},k.createElement("div",{className:"rule--operator-wrapper"},t.settings.showLabels?k.createElement("label",{className:"rule--label"}," "):null,k.createElement("div",{className:"rule--operator-text-wrapper"},k.createElement("span",{className:"rule--operator-text"},c.operatorInlineLabel))))]}}]),o}(k.PureComponent);function Ls(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ps=hu.RuleUtils.getFieldPathLabels,_s=hu.ConfigUtils,ks=_s.getFieldConfig,Zs=_s.getFieldParts,Ts=_s.getFieldPathParts,Vs=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).setField=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.props.id;if(!n.widgetId){var i=[o,"L",-1].join(":");n.widgetId=i}t.props.setField(e,r,n)},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.config,o=e.parentField,i=t,l=n.settings,a=l.maxLabelsLength,u=l.fieldSeparatorDisplay,s=l.fieldPlaceholder,c=(l.fieldSeparator,!!t),p=c?null:Nu(s,a),d=c?ks(n,i):null,f=d||{},v=Ts(i,n),g=Ts(i,n,!0),h=this.getFieldLabel(d,i,n),y=Ps(i,n),m=y?y.join(u):null;(m==h||o)&&(m=null);var b=f.label2,O=Zs(o,n),S=o?ks(n,o):null,F=o?S&&S.subfields:n.fields,w=!c&&r,j=this.buildOptions(O,n,F,w,O),E=w?"Please select field":null;return i&&"object"===(0,I.Z)(i)&&(i=void 0),{placeholder:p,items:j,parentField:o,selectedKey:i,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedAltLabel:b,selectedFullLabel:m,errorText:E}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Zs(t,r),i=(null==e?void 0:e.label)||ye()(o);return Nu(i,n)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!r)return null;var a=t.settings,u=a.fieldSeparator,s=a.fieldSeparatorDisplay,c=null!=i&&i.length?i.join(u)+u:"",p=function e(t){return Object.keys(t||{}).reduce((function(r,n){var i=t[n];return"!struct"===i.type?r+e(i.subfields):r+(i.type===o?1:0)}),0)};return fs()(r).map((function(a){var u=[].concat((0,T.Z)(null!=i?i:[]),[a]),d=r[a],f=n.getFieldLabel(d,u,t),v=Ps(u,t).join(s);(v==f||null!=e&&e.length)&&(v=null);var g=d.label2,h=d.tooltip,y=d.disabled;if(!d.hideForSelect){if("!struct"==d.type){var m=n.buildOptions(e,t,d.subfields,o,u,{label:f,tooltip:h}),b=p(d.subfields)>0;return{disabled:y,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,items:m,matchesType:b}}var O=void 0!==o?d.type===o:void 0;return{disabled:y,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,grouplabel:null==l?void 0:l.label,group:l,matchesType:O}}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setFieldSrc,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ls(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ls(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:l,config:t,customProps:r,readonly:o,setField:this.setField,setFieldSrc:n},this.meta);return a(u,t.ctx)}}]),o}(k.Component);function Is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}Vs.propTypes={id:mu().string,groupId:mu().string,config:mu().object.isRequired,selectedField:mu().any,selectedFieldSrc:mu().string,selectedFieldType:mu().string,parentField:mu().string,customProps:mu().object,readonly:mu().bool,setField:mu().func.isRequired,setFieldSrc:mu().func};var xs=hu.clone,Rs=hu.ConfigUtils,Ds=Rs.getFieldConfig,As=Rs.getFuncConfig,Ns=Rs.getFieldParts,Ms=Rs.getFieldPathParts,qs=hu.RuleUtils,Ws=qs.getFuncPathLabels,Gs=qs.getWidgetForFieldOp,Bs=hu.OtherUtils.shallowEqual,Us=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),t=n.call(this,e),Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"].map((function(r){return"parentFuncs"===r?!Bs(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","fieldType","fieldSrc","value","isLHS"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e,this.meta))}},{key:"getItems",value:function(e,t){var r=e.config,n=e.field,o=e.fieldType,i=e.isLHS,l=e.operator,a=e.parentFuncs,u=e.fieldDefinition,s=e.isFuncArg,c=t.lookingForFieldType,p=r.settings.canUseFuncForField,d=this.filterFuncs(r,r.funcs,n,o,i,l,p,a,s,u);return this.buildOptions(r,d,c)}},{key:"getMeta",value:function(e){var t=e.config,r=(e._field,e.fieldType),n=e.value,o=e.isLHS,i=e.isFuncArg,l=t.settings,a=l.funcPlaceholder,u=l.fieldSeparatorDisplay,s=n,c=!!n,p=c?null:a,d=c?As(t,s):null,f=d||{},v=Ms(s,t),g=Ms(s,t,!0),h=this.getFuncLabel(d,s,t),y=Ws(s,t),m=y?y.join(u):null;m==h&&(m=null);var b=o&&!i&&!c&&r;return{placeholder:p,selectedKey:s,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedFullLabel:m,errorText:b?"Please select function":null,lookingForFieldType:b}}},{key:"filterFuncs",value:function(e,t,r,n,o,i,l,a,u,s){t=xs(t);var c,p=e.settings.fieldSeparator,d=Ds(e,r),f=d,v=Gs(e,r,i,"value");return v&&e.widgets[v],u?(f=s,c=null==s?void 0:s.type):d?c=d.type:o||(c=n),function t(n,o){for(var u in n){var s=n[u].subfields,v=(o||[]).concat(u),g=v.join(p),h=As(e,g);if("!struct"==h.type)0==t(s,v)&&delete n[u];else{var y,m=!c||h.returnType==c;null!==(y=f)&&void 0!==y&&y.funcs&&(m=m&&f.funcs.includes(g)),l&&(m=m&&l(r,d,g,h,i)),!h.allowSelfNesting&&a&&a.map((function(e){var t=(0,V.Z)(e,2),r=t[0];return t[1],r})).includes(g)&&(m=!1),m||delete n[u]}}return fs()(n).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;var l=e.settings,a=l.fieldSeparator,u=l.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"",c=function e(t){return Object.keys(t||{}).reduce((function(r,o){var i=t[o];return"!struct"===i.type?r+e(i.subfields):r+(i.type===n?1:0)}),0)};return fs()(t).map((function(l){var a=[].concat((0,T.Z)(null!=o?o:[]),[l]),p=t[l],d=r.getFuncLabel(p,a,e),f=Ws(a,e).join(u);f==d&&(f=null);var v=p.tooltip;if("!struct"==p.type){var g=r.buildOptions(e,p.subfields,n,a,{label:d,tooltip:v}),h=c(p.subfields)>0;return{key:l,path:s+l,label:d,fullLabel:f,tooltip:v,items:g,matchesType:h}}var y=void 0!==n?p.returnType===n:void 0;return{key:l,path:s+l,label:d,fullLabel:f,tooltip:v,grouplabel:null==i?void 0:i.label,group:i,matchesType:y}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Ns(t,r),i=(null==e?void 0:e.label)||ye()(o);return Nu(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderFunc,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Is(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Is(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:o,setField:n,items:this.items,id:i,groupId:l},this.meta);return a(u,t.ctx)}}]),o}(k.Component);Us.propTypes={id:mu().string,groupId:mu().string,config:mu().object.isRequired,field:mu().any,fieldType:mu().string,fieldSrc:mu().string,operator:mu().string,customProps:mu().object,value:mu().string,setValue:mu().func.isRequired,readonly:mu().bool,parentFuncs:mu().array,fieldDefinition:mu().object,isFuncArg:mu().bool,isLHS:mu().bool};var zs=r(38569),$s=r.n(zs),Js=["factory"];function Hs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ys(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hs(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ks=hu.ListUtils.getTitleInListValues,Qs=hu.ConfigUtils._widgetDefKeysToOmit,Xs=hu.TreeUtils._fixImmutableValue;const ec=function(e){var t=e.delta,r=e.isFuncArg,n=(e.valueSrc,e.value),o=e.valueError,i=e.fieldError,l=e.asyncListValues,a=e.isSpecialRange,u=e.fieldDefinition,s=(e.widget,e.widgetDefinition),c=e.widgetValueLabel,p=e.valueLabels,d=e.textSeparators,f=e.setValueHandler,v=e.setFuncValue,g=e.config,h=e.field,y=e.fieldSrc,m=e.fieldType,b=e.isLHS,O=e.operator,S=e.readonly,F=e.parentField,w=e.parentFuncs,j=e.id,E=e.groupId,C=e.widgetId,L=s.factory,P=(0,Vl.Z)(s,Js),_=r&&u.valueSources&&1==u.valueSources.length&&"const"==u.valueSources[0],k=u.defaultValue;if(!L)return"?";var Z=n?n.map((function(e){return Xs(e)})):void 0,V=a?[null==Z?void 0:Z.get(0),null==Z?void 0:Z.get(1)]:Z?Z.get(t):void 0,I=(null==o?void 0:o.get)&&(a?[o.get(0),o.get(1),o.get(2)]:o.get(t))||null,x=b?i:I;a&&void 0===V[0]&&void 0===V[1]&&(V=void 0);var R=(u||{}).fieldSettings,A=D()(Ys(Ys(Ys({},P),R),{},{config:g,field:h,fieldSrc:y,fieldType:m,isLHS:b,parentField:F,parentFuncs:w,fieldDefinition:u,operator:O,delta:t,isSpecialRange:a,isFuncArg:r,value:V,valueError:I,fieldError:i,errorMessage:x,label:c.label,placeholder:c.placeholder,placeholders:p?p.placeholder:null,textSeparators:d,setValue:f,setFuncValue:v,readonly:S,asyncListValues:l,id:j,groupId:E,widgetId:C}),[].concat((0,T.Z)(Qs),["toJS"]));if(_&&k){var N=(null==R?void 0:R.treeValues)||(null==R?void 0:R.listValues);return"boolean"==typeof k?k?A.labelYes||"YES":A.labelNo||"NO":N?Array.isArray(k)?k.map((function(e){return Ks(N,e)||e})).join(", "):Ks(N,k)||k:""+k}return L(A,g.ctx)};var tc=hu.ConfigUtils,rc=tc.getFieldConfig,nc=tc.getOperatorConfig,oc=tc.getFieldWidgetConfig,ic=hu.RuleUtils,lc=ic.getValueSourcesForFieldOp,ac=ic.getWidgetForFieldOp,uc=ic.getValueLabel,sc=hu.DefaultUtils.createListFromArray,cc=hu.OtherUtils.shallowEqual,pc={cardinality:1},dc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e))._setValue=function(e,r,n,o,i,l){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(a.widgetId||(a.widgetId=o),e&&Array.isArray(i)){var u=[t.props.value.get(0),t.props.value.get(1)];u[0]!=i[0]&&t.props.setValue(0,i[0],n,l,a),u[1]!=i[1]&&t.props.setValue(1,i[1],n,l,a)}else t.props.setValue(r,i,n,l,a)},t._setValueSrc=function(e,r,n){var o={widgetId:r};t.props.setValueSrc(e,n,o)},t.renderWidget=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,l=r.operator,a=r.value,u=r.valueError,s=r.fieldError,c=r.readonly,p=r.parentField,d=r.parentFuncs,f=r.id,v=r.groupId,g=r.fieldSrc,h=r.fieldType,y=r.isLHS,m=r.setFuncValue,b=n.settings,O=t.widgets,S=t.iValues,F=t.aField,w=t.valueSources,j=o?S:a,E=o?i:F,C=O[e],L=C.valueSrc,P=C.valueLabel,_=C.widgetId,Z=w.length>1&&!c,T=b.showLabels?k.createElement("label",{className:"rule--label"},P.label):null;return k.createElement("div",{key:"widget-"+E+"-"+e,className:is()("func"==L?"widget--func":"widget--widget",Z?"widget--has-valuerscs":"widget--has-no-valuerscs")},"func"==L?null:T,k.createElement(ec,(0,ns.Z)({id:f,groupId:v,widgetId:_,valueSrc:L,delta:e,value:j,valueError:u,fieldError:s,isFuncArg:o,isLHS:y},fe()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),fe()(O[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValueHandler"]),{setFuncValue:m,config:n,field:E,fieldSrc:g,fieldType:h,parentField:p,parentFuncs:d,operator:l,readonly:c})))},t.renderValueSources=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,l=r.operator,a=r.readonly,u=n.settings,s=t.valueSources,c=t.widgets,p=t.aField,d=o?i:p,f=c[e],v=f.valueSrc,g=f.setValueSrcHandler,h=u.valueSourcesInfo,y=u.renderValueSources,m=s.map((function(e){return[e,{label:h[e].label}]})),b=function(e){return y(e,n.ctx)},O=u.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return s.length>1&&!a&&k.createElement("div",{key:"valuesrc-"+d+"-"+e,className:"widget--valuesrc"},O,k.createElement(b,{key:"valuesrc-"+e,delta:e,valueSources:m,valueSrc:v,config:n,field:d,operator:l,setValueSrc:g,readonly:a,title:u.valueSourcesPopupTitle}))},t.renderSep=function(e,t,r){var n=r.config,o=t.widgets,i=n.settings,l=o[e].sepText,a=i.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return l&&k.createElement("div",{key:"widget-separators-"+e,className:is()("widget--sep",0==e&&"widget--sep-first")},a,k.createElement("span",null,l))},t.renderWidgetDelta=function(e){return[t.renderSep(e,t.meta,t.props),t.renderValueSources(e,t.meta,t.props),t.renderWidget(e,t.meta,t.props)]},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","id","parentFuncs","field","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue"].map((function(r){return"parentFuncs"===r?!cc(e[r],t[r],!0):"isFuncArg"===r?e[r]!==t[r]||e.isFuncArg&&e.value!==t.value:e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=this,o=e.config,i=e.field,l=(e.fieldSrc,e.fieldType),a=e.fieldFunc,u=e.fieldArg,s=e.operator,c=e.valueSrc,p=e.value,d=e.isForRuleGroup,f=e.isCaseValue,v=e.isFuncArg,g=(e.leftField,e.asyncListValues),h=e.parentFuncs,y=e.isLHS,m=e.id,b=v?{func:a,arg:u}:i,O=!i&&l,S=c,F=p;(v||d||f)&&(S=sc([c]),F=sc([p]));var w=rc(o,b);!w&&O&&(w=o.types[l]);var j,E=ac(o,b,s);!E&&O&&(E=null===(j=o.types[l])||void 0===j?void 0:j.mainWidget);var C=v?pc:nc(o,s,b);if((null==w||null==C)&&!f)return null;var L,P,_=null==C?void 0:C.isSpecialRange,k=_&&("field"==(null===(t=S)||void 0===t?void 0:t.get(0))||"field"==(null===(r=S)||void 0===r?void 0:r.get(1))),Z=_&&!k,T=Z?1:null!==(P=null==(L=C)?void 0:L.cardinality)&&void 0!==P?P:1;if(0===T)return null;var I=lc(o,b,s,w);b||(I=Object.keys(o.settings.valueSourcesInfo));var x=$s()(0,T).map((function(e){var t,r,i=(null===(t=S)||void 0===t?void 0:t.get(e))||null,l=ac(o,b,s,i),a=oc(o,b,s,l,i);k&&(l=a.singleWidget,a=oc(o,b,s,l,i)),!a&&O&&(l=["func","field"].includes(i)?i:E,a=o.widgets[l]);var u=null===(r=a)||void 0===r?void 0:r.type,c=uc(o,b,s,e,i,Z),p=uc(o,b,s,e,null,Z),d=null!=C&&C.textSeparators?null==C?void 0:C.textSeparators[e]:null,f=null,v=null;_&&(f={placeholder:[(f=[uc(o,b,s,0),uc(o,b,s,1)])[0].placeholder,f[1].placeholder],label:[f[0].label,f[1].label]},v=null==C?void 0:C.textSeparators);var g=[m,y?"L":"R",y?-1:e||0,(h||[]).map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")].join(":"),F=g+":VS";return{valueSrc:i,valueLabel:c,widget:l,sepText:d,widgetDefinition:a,widgetValueLabel:p,valueLabels:f,textSeparators:v,setValueSrcHandler:n._setValueSrc.bind(n,e,F),setValueHandler:n._setValue.bind(n,_,e,u,g),widgetId:g}}));return{defaultWidget:E,fieldDefinition:w,operatorDefinition:C,isSpecialRange:Z,cardinality:T,valueSources:I,widgets:x,iValues:F,aField:b,asyncListValues:g}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality;if(!t)return null;var n=t;return k.createElement(Fs,{className:"rule--widget rule--widget--".concat(n.toUpperCase()),key:"widget-col-"+n},$s()(0,r).map(this.renderWidgetDelta))}}]),o}(k.Component);function fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,_.Z)(e);if(t){var o=(0,_.Z)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,P.Z)(this,r)}}dc.propTypes={config:mu().object.isRequired,value:mu().any,valueSrc:mu().any,valueError:mu().any,fieldError:mu().string,field:mu().any,fieldSrc:mu().string,fieldType:mu().string,operator:mu().string,readonly:mu().bool,asyncListValues:mu().array,id:mu().string,groupId:mu().string,setValue:mu().func,setValueSrc:mu().func,setFuncValue:mu().func,isFuncArg:mu().bool,fieldFunc:mu().string,fieldArg:mu().string,leftField:mu().any,isForRuleGroup:mu().bool,parentField:mu().string,parentFuncs:mu().array,isLHS:mu().bool,isCaseValue:mu().bool};var vc=hu.ConfigUtils.getFuncConfig,gc=hu.FuncUtils,hc=(gc.setFunc,gc.setArgValue,gc.setArgValueSrc,hu.OtherUtils.shallowEqual),yc=function(e){(0,L.Z)(r,e);var t=fc(r);function r(e){var n;return(0,j.Z)(this,r),(n=t.call(this,e)).setFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.props,o=r.isLHS,i=r.delta,l=r.parentFuncs,a=r.id;if(!t.widgetId){var u=[a,o?"L":"R",o?-1:i||0,(l||[]).map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/"),"F"].join(":");t.widgetId=u}n.props.setFuncValue(o?-1:i||0,l,null,e,"!func",void 0,t)},n.setArgValue=function(e,t,r,o,i){var l=n.props,a=(l.config,l.delta),u=l.isLHS,s=l.parentFuncs;n.props.setFuncValue(u?-1:a||0,s,e,t,r,o,i)},n.setArgValueSrc=function(e,t,r){var o=n.props,i=(o.config,o.delta),l=o.isLHS,a=o.parentFuncs;n.props.setFuncValue(l?-1:i||0,a,e,t,"!valueSrc",void 0,r)},n.renderFuncSelect=function(){var e,t,r=n.props,o=r.config,i=r.field,l=r.fieldType,a=r.fieldSrc,u=r.isLHS,s=r.operator,c=r.customProps,p=r.value,d=r.readonly,f=r.parentFuncs,v=r.id,g=r.groupId,h=r.isFuncArg,y=r.fieldDefinition,m={value:null!==(e=null==p||null===(t=p.get)||void 0===t?void 0:t.call(p,"func"))&&void 0!==e?e:null,setValue:n.setFunc,config:o,field:i,fieldType:l,fieldSrc:a,isLHS:u,operator:s,customProps:c,readonly:d,parentFuncs:f,isFuncArg:h,fieldDefinition:y,id:v,groupId:g},b=o.settings,O=b.showLabels,S=b.funcLabel,F=O?k.createElement("label",{className:"rule--label"},S):null;return k.createElement(Fs,{key:"func",className:"rule--func"},F,k.createElement(Us,m))},n.renderArgLabel=function(e,t){var r=t.valueSources,o=t.type,i=t.showPrefix,l=t.label,a=n.props.config,u=r&&1==r.length&&"const"==r[0];return a.settings.showLabels||"boolean"!=o&&!u||!i?null:k.createElement(Fs,{className:"rule--func--arg-label"},l||e)},n.renderArgLabelSep=function(e,t){var r=t.valueSources,o=t.type,i=t.showPrefix,l=n.props.config,a=r&&1==r.length&&"const"==r[0];return l.settings.showLabels||"boolean"!=o&&!a||!i?null:k.createElement(Fs,{className:"rule--func--arg-label-sep"},":")},n.renderArgVal=function(e,t,r){var o=n.props,i=o.config,l=o.field,a=o.fieldType,u=o.fieldSrc,s=o.isLHS,c=(o.operator,o.value),p=o.readonly,d=o.parentFuncs,f=o.id,v=o.groupId,g=o.fieldError,h=o.valueError,y=o.setFuncValue,m=c?c.getIn(["args",t]):null,b=m?m.get("value"):void 0,O=1==r.valueSources.length?r.valueSources[0]:void 0,S={config:i,fieldFunc:e,fieldArg:t,leftField:l,fieldType:a,fieldSrc:u,fieldError:g,valueError:h,isLHS:s,operator:null,value:b,valueSrc:m?m.get("valueSrc")||O||"value":O,setValue:n.setArgValue,setValueSrc:n.setArgValueSrc,setFuncValue:y,funcKey:e,argKey:t,argDefinition:r,readonly:p,parentFuncs:d,id:f,groupId:v};return k.createElement(Fs,{className:"rule--func--arg-value"},k.createElement(mc,S))},n.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?k.createElement(Fs,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},n.renderBracketBefore=function(e){var t=e.renderBrackets;return k.createElement(Fs,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},n.renderBracketAfter=function(e){var t=e.renderBrackets;return k.createElement(Fs,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},n.renderFuncArgs=function(){var e=n.meta,t=e.funcDefinition,r=e.funcKey;if(!r)return null;var o=(t||{}).args;return o?k.createElement(k.Fragment,null,n.renderBracketBefore(t),k.createElement(Fs,{key:"args-".concat(r),className:"rule--func--args rule--func--".concat(r,"--args")},Object.keys(o).map((function(e,i){return k.createElement(Fs,{key:"arg-".concat(e,"-").concat(i),className:"rule--func--arg rule--func--".concat(r,"--arg--").concat(e)},n.renderArgSep(e,o[e],i,t),n.renderArgLabel(e,o[e]),n.renderArgLabelSep(e,o[e]),n.renderArgVal(r,e,o[e]))}))),n.renderBracketAfter(t)):null},Ju((0,C.Z)(n)),n.onPropsChanged(e),n}return(0,E.Z)(r,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value","fieldSrc","fieldType","isLHS"].map((function(r){return"parentFuncs"===r?!hc(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=e.config,o=(e.field,e.operator,e.value),i=null!==(t=null==o||null===(r=o.get)||void 0===r?void 0:r.call(o,"func"))&&void 0!==t?t:null;return{funcDefinition:i?vc(n,i):null,funcKey:i}}},{key:"render",value:function(){var e=this.props.parentFuncs,t=e?e.map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return"".concat(r,"_").concat(n)})).join("-"):"root",r=(null==e?void 0:e.length)||0;return k.createElement(Fs,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(t," rule--func--wrapper--lev-").concat(r)},this.renderFuncSelect(),this.renderFuncArgs())}}]),r}(k.Component);yc.propTypes={id:mu().string,groupId:mu().string,config:mu().object.isRequired,field:mu().any,fieldSrc:mu().string,fieldType:mu().string,fieldError:mu().string,operator:mu().string,customProps:mu().object,value:mu().object,setValue:mu().func.isRequired,setFuncValue:mu().func,readonly:mu().bool,parentFuncs:mu().array,fieldDefinition:mu().object,isFuncArg:mu().bool,isLHS:mu().bool,valueError:mu().string};var mc=function(e){(0,L.Z)(r,e);var t=fc(r);function r(e){var n;return(0,j.Z)(this,r),(n=t.call(this,e)).setValue=function(e,t,r,o,i){var l=n.props;(0,l.setValue)(l.argKey,t,r,o,i)},n.setValueSrc=function(e,t,r){var o=n.props;(0,o.setValueSrc)(o.argKey,t,r)},Ju((0,C.Z)(n)),n.onPropsChanged(e),n}return(0,E.Z)(r,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["parentFuncs","funcKey","argKey"].map((function(r){return"parentFuncs"===r?!hc(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.parentFuncs,r=e.funcKey,n=e.argKey;return{parentFuncs:[].concat((0,T.Z)(t||[]),[[r,n]])}}},{key:"render",value:function(){var e=this.meta.parentFuncs;return k.createElement(dc,(0,ns.Z)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:e}))}}]),r}(k.Component);mc.propTypes={funcKey:mu().string.isRequired,argKey:mu().string.isRequired,setValue:mu().func.isRequired,setValueSrc:mu().func.isRequired,readonly:mu().bool,isLHS:mu().bool,parentFuncs:mu().array,id:mu().string,groupId:mu().string};var bc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){var e;(0,j.Z)(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).renderField=function(){var t=e.props,r=t.config,n=t.classname,o=t.selectedField,i=t.selectedFieldSrc,l=t.selectedFieldType,a=t.setField,u=t.setFuncValue,s=t.parentField,c=t.readonly,p=t.id,d=t.groupId,f=t.fieldError,v=t.valueError;if(!["func","field"].includes(i))return"?";var g="func"===i?k.createElement(yc,{isLHS:!0,config:r,value:o,fieldSrc:i,fieldType:l,fieldError:f,valueError:v,parentField:s,setValue:a,setFuncValue:u,readonly:c,id:p,groupId:d,key:"field-func-"+p}):k.createElement(Vs,{config:r,selectedField:o,selectedFieldSrc:i,selectedFieldType:l,parentField:s,setField:a,customProps:r.settings.customFieldSelectProps,readonly:c,id:p,groupId:d,key:"field-"+p}),h="func"===i?r.settings.funcLabel:r.settings.fieldLabel,y=r.settings.showLabels&&"func"!==i&&k.createElement("label",{className:"rule--label"},h);return k.createElement("div",{key:i,className:n},y,g)},e.renderFieldSources=function(){var t=e.props,r=t.config,n=t.readonly,o=t.selectedFieldSrc,i=t.setFieldSrc,l=t.id,a=r.settings,u=a.fieldSources,s=a.valueSourcesInfo,c=a.renderValueSources,p=u.map((function(e){return[e,{label:s[e].label}]})),d=function(e){return c(e,r.ctx)},f=a.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return u.length>1&&!n&&k.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},f,k.createElement(d,{key:"fieldsrc-"+l,valueSources:p,valueSrc:o,config:r,setValueSrc:i,readonly:n,title:a.fieldSourcesPopupTitle}))},e}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=(e.classname,e.canSelectFieldSource),r=t&&this.renderFieldSources(),n=this.renderField();return t?k.createElement(Fs,{className:"rule--field-wrapper"},r,n):n}}]),o}(k.PureComponent),Oc=["factory"];var Sc=hu.ConfigUtils.getOperatorConfig,Fc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=Sc(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=(0,Vl.Z)(t,Oc),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),this.props.config.ctx),i=this.props.selectedOperator;return k.createElement("div",{className:"rule--operator rule--operator--".concat(i.toUpperCase())},o)}}]),o}(k.PureComponent);function wc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wc(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Fc.propTypes={config:mu().object.isRequired,operatorOptions:mu().any.isRequired,selectedField:mu().any,selectedFieldSrc:mu().string,selectedOperator:mu().string.isRequired,readonly:mu().bool,setOperatorOption:mu().func.isRequired};var Ec=hu.ConfigUtils,Cc=Ec.getFieldConfig,Lc=Ec.getOperatorConfig,Pc=Ec.getFieldWidgetConfig,_c=Ec.getFieldParts,kc=hu.RuleUtils.isEmptyRuleProperties,Zc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),t=n.call(this,e),Ju((0,C.Z)(t)),t.removeSelf=t.removeSelf.bind((0,C.Z)(t)),t.setLock=t.setLock.bind((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.selectedOperator,o=e.config,i=e.reordableNodesCnt,l=e.isLocked,a=o.settings.keepInputOnChangeFieldSrc,u=_c(t,o),s=Cc(o,t),c=s&&"!struct"==s.type,p=!!t||a&&r,d=p&&n,f=Lc(o,n,t),v=f&&null!=f.options,g=Pc(o,t,n,null,null)||{},h=g.hideOperator;return{selectedFieldParts:u,selectedFieldWidgetConfig:g,showDragIcon:o.settings.canReorder&&i>1&&!l,showOperator:p&&!h,showOperatorLabel:p&&h&&g.operatorInlineLabel,showWidget:d&&!c,showOperatorOptions:d&&v}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this,t=this.props,r=t.confirmFn,n=t.config,o=n.settings,i=o.renderConfirm,l=o.removeRuleConfirmOptions,a=function(){e.props.removeSelf()};l&&!this.isEmptyCurrentRule()?i.call(n.ctx,jc(jc({},l),{},{onOk:a,onCancel:null,confirmFn:r}),n.ctx):a()}},{key:"_buildWidgetProps",value:function(e){return{field:e.selectedField,fieldSrc:e.selectedFieldSrc,fieldType:e.selectedFieldType,operator:e.selectedOperator,operatorOptions:e.operatorOptions,value:e.value,valueType:e.valueType,valueSrc:e.valueSrc,asyncListValues:e.asyncListValues,valueError:e.valueError,fieldError:e.fieldError,parentField:e.parentField}}},{key:"isEmptyCurrentRule",value:function(){var e=this.props.config,t=this._buildWidgetProps(this.props);return kc(t,e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.parentField,o=e.groupId,i=e.id,l=e.selectedFieldSrc,a=e.selectedField,u=e.selectedFieldType,s=e.setField,c=e.setFuncValue,p=e.setFieldSrc,d=e.fieldError,f=t.settings.immutableFieldsMode;return k.createElement(bc,{key:"field",classname:is()("func"==l?"rule--field--func":"rule--field"),config:t,canSelectFieldSource:!n,selectedField:a,selectedFieldSrc:l,selectedFieldType:u,fieldError:d,setField:f?ws:s,setFuncValue:f?ws:c,setFieldSrc:f?ws:p,parentField:n,readonly:f||r,id:i,groupId:o})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldParts,i=n.selectedFieldWidgetConfig,l=n.showOperator,a=n.showOperatorLabel,u=t.settings.immutableOpsMode;return k.createElement(Cs,{key:"operator",config:t,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedOperator:this.props.selectedOperator,setOperator:u?ws:this.props.setOperator,selectedFieldParts:o,showOperator:l,showOperatorLabel:a,selectedFieldWidgetConfig:i,readonly:u||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta.showWidget,o=t.settings.immutableValuesMode;if(!n)return null;var i=k.createElement(dc,(0,ns.Z)({key:"values"},this._buildWidgetProps(this.props),{config:t,setValue:o?ws:this.props.setValue,setValueSrc:o?ws:this.props.setValueSrc,setFuncValue:o?ws:this.props.setFuncValue,readonly:o||r,id:this.props.id,groupId:this.props.groupId}));return k.createElement(Fs,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},i)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var i=k.createElement(Fc,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?ws:this.props.setOperatorOption,config:e,readonly:o});return k.createElement(Fs,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},i)}},{key:"renderBeforeWidget",value:function(){var e=this.props.config,t=e.settings.renderBeforeWidget;return t&&k.createElement(Fs,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},"function"==typeof t?t(this.props,e.ctx):t)}},{key:"renderAfterWidget",value:function(){var e=this.props.config,t=e.settings.renderAfterWidget;return t&&k.createElement(Fs,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},"function"==typeof t?t(this.props,e.ctx):t)}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.fieldError,o=t.settings,i=o.renderRuleError,l=o.showErrorMessage,a=[n].concat((0,T.Z)((null==r?void 0:r.toArray())||[])).filter((function(e){return!!e})).shift()||null;return l&&a&&k.createElement("div",{className:"rule--error"},i?i({error:a},t.ctx):a)}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.props.config,r=this.meta.showDragIcon,n=t.settings.renderIcon,o=function(e){return null==n?void 0:n(e,t.ctx)},i=k.createElement(o,{type:"drag"});return r&&k.createElement("div",{key:"rule-drag-icon",onMouseDown:e,className:"qb-drag-handler rule--drag-handler"},i)}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,i=n.immutableGroupsMode,l=n.renderButton,a=n.renderIcon,u=n.canDeleteLocked,s=function(e){return l(e,t.ctx)};return!i&&(!r||r&&u)&&k.createElement(s,{type:"delRule",onClick:this.removeSelf,label:o,config:t,renderIcon:function(e){return a(e,t.ctx)}})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,i=t.settings,l=i.lockLabel,a=i.lockedLabel,u=i.showLock,s=i.renderSwitch,c=function(e){return s(e,t.ctx)};return u&&!(r&&!n)&&k.createElement(c,{type:"lock",id:o,value:r,setValue:this.setLock,label:l,checkedLabel:a,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,i=n.value,l=n.config,a="value"==(null==o?void 0:o.first())&&!t&&1==i.size&&r.fullWidth,u=l.settings.renderButtonGroup,s=function(e){return u(e,l.ctx)},c=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],p=k.createElement("div",{key:"rule-body",className:is()("rule--body",a&&"can--shrink--value")},c),d=this.renderError(),f=this.renderDrag(),v=this.renderLock(),g=this.renderDel();return k.createElement(k.Fragment,null,f,k.createElement("div",{className:"rule--body--wrapper"},p,d),k.createElement("div",{className:"rule--header"},k.createElement(s,{config:l},v,g)))}}]),o}(k.Component);Zc.propTypes={id:mu().string.isRequired,groupId:mu().string,selectedField:mu().any,selectedFieldSrc:mu().string,selectedFieldType:mu().string,selectedOperator:mu().string,operatorOptions:mu().object,config:mu().object.isRequired,value:mu().any,valueSrc:mu().any,valueType:mu().any,asyncListValues:mu().array,isDraggingMe:mu().bool,isDraggingTempo:mu().bool,parentField:mu().string,valueError:mu().any,fieldError:mu().string,isLocked:mu().bool,isTrueLocked:mu().bool,handleDraggerMouseDown:mu().func,setField:mu().func,setFieldSrc:mu().func,setOperator:mu().func,setOperatorOption:mu().func,setLock:mu().func,removeSelf:mu().func,setValue:mu().func,setValueSrc:mu().func,reordableNodesCnt:mu().number,totalRulesCnt:mu().number,parentReordableNodesCnt:mu().number};const Tc=function(e){var t=(0,Fu.$j)((function(e){return{dragging:e.dragging}}),null,null,{context:Ou})(function(e){var t;return t=function(t){(0,L.Z)(i,t);var r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,_.Z)(r);if(n){var o=(0,_.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,P.Z)(this,e)});function i(e){var t;return(0,j.Z)(this,i),(t=o.call(this,e)).dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e,r,n){t.props.actions.setField(t.props.path,e,r,n)},t.setFieldSrc=function(e){t.props.actions.setFieldSrc(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,i){t.props.actions.setValue(t.props.path,e,r,n,o,i)},t.setValueSrc=function(e,r,n){t.props.actions.setValueSrc(t.props.path,e,r,n)},t.setFuncValue=function(e,r,n,o,i,l,a){t.props.actions.setFuncValue(t.props.path,e,r,n,o,i,l,a)},t.pureShouldComponentUpdate=$u((0,C.Z)(t)),t.dummyFn.isDummyFn=!0,t}return(0,E.Z)(i,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,l=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||i||(u=!1),u&&l.push(a)}l.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=ls(this.props.config,this.props.field),n=this.props.fieldType||(null==r?void 0:r.type)||null,o=this.props.config.settings.showErrorMessage,i=(r&&r.type,!t&&this.props.isDraggingTempo),l=this.props,a=l.valueError,u=null!=([l.fieldError].concat((0,T.Z)((null==a?void 0:a.toArray())||[])).filter((function(e){return!!e})).shift()||null)&&o;return k.createElement("div",{className:is()("group-or-rule-container","rule-container",u?"rule-with-error":null),"data-id":this.props.id},[t?k.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:t,isDraggingTempo:i,onDragStart:this.props.onDragStart,setLock:i?this.dummyFn:this.setLock,removeSelf:i?this.dummyFn:this.removeSelf,setField:i?this.dummyFn:this.setField,setFieldSrc:i?this.dummyFn:this.setFieldSrc,setFuncValue:i?this.dummyFn:this.setFuncValue,setOperator:i?this.dummyFn:this.setOperator,setOperatorOption:i?this.dummyFn:this.setOperatorOption,setValue:i?this.dummyFn:this.setValue,setValueSrc:i?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),i}(k.Component),t.propTypes={id:mu().string.isRequired,groupId:mu().string,config:mu().object.isRequired,path:mu().any.isRequired,operator:mu().string,field:mu().any,fieldSrc:mu().string,fieldType:mu().string,actions:mu().object.isRequired,onDragStart:mu().func,value:mu().any,valueSrc:mu().any,asyncListValues:mu().array,valueError:mu().any,fieldError:mu().string,operatorOptions:mu().object,reordableNodesCnt:mu().number,parentField:mu().string,isLocked:mu().bool,isTrueLocked:mu().bool,dragging:mu().object,isDraggingTempo:mu().bool},t}(e));return t.displayName="ConnectedRuleContainer",t}(ps("rule")(Es(Zc)));var Vc=r(63869),Ic=r.n(Vc);var xc=hu.DefaultUtils.defaultGroupConjunction;const Rc=function(e,t){var r=(0,Fu.$j)((function(e){return{dragging:e.dragging}}),null,null,{context:Ou})(function(e,t){var r;return r=function(r){(0,L.Z)(l,r);var n,o,i=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,_.Z)(n);if(o){var r=(0,_.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,P.Z)(this,e)});function l(e){var r;return(0,j.Z)(this,l),(r=i.call(this,e))._selectedConjunction=function(e){return(e=e||r.props).conjunction||xc(e.config,e.field)},r.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setConjunction(r.props.path,e)},r.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setNot(r.props.path,e)},r.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setLock(r.props.path,e)},r.dummyFn=function(){},r.removeSelf=function(){r.props.actions.removeGroup(r.props.path)},r.addGroup=function(){r.props.actions.addGroup(r.props.path)},r.addCaseGroup=function(){r.props.actions.addCaseGroup(r.props.path)},r.addDefaultCaseGroup=function(){r.props.actions.addDefaultCaseGroup(r.props.path)},r.addRule=function(){var e="rule_group"==t?r.props.field:null;r.props.actions.addRule(r.props.path,void 0,void 0,void 0,e)},r.setField=function(e,t,n){r.props.actions.setField(r.props.path,e,t,n)},r.setOperator=function(e){r.props.actions.setOperator(r.props.path,e)},r.setValue=function(e,t,n,o,i){r.props.actions.setValue(r.props.path,e,t,n,o,i)},r.setFuncValue=function(e,t,n,o,i,l,a){r.props.actions.setFuncValue(r.props.path,e,t,n,o,i,l,a)},r.pureShouldComponentUpdate=$u((0,C.Z)(r)),Ju((0,C.Z)(r)),r.selectedConjunction=r._selectedConjunction(e),r.conjunctionOptions=r._getConjunctionOptions(e),r.dummyFn.isDummyFn=!0,r}return(0,E.Z)(l,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,l=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||i||(u=!1),u&&l.push(a)}l.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return Da()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.config.settings.showErrorMessage,r=this.props.dragging.id==this.props.id,n=this.props.path.size,o=this.props.config.settings.maxNesting,i=!r&&this.props.isDraggingTempo,l=this.props.fieldType||null,a=this.props.valueError,u=null!=((0,T.Z)((null==a?void 0:a.toArray())||[]).filter((function(e){return!!e})).shift()||null)&&t,s=void 0===o||n<o,c=1==n;return k.createElement("div",{className:is()("group-or-rule-container","group-container",u?"group-with-error":null),"data-id":this.props.id},[r?k.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:c,allowFurtherNesting:s,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:r,isDraggingTempo:i,onDragStart:this.props.onDragStart,isRoot:c,allowFurtherNesting:s,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:i?this.dummyFn:this.setConjunction,setNot:i?this.dummyFn:this.setNot,setLock:i?this.dummyFn:this.setLock,removeSelf:i?this.dummyFn:this.removeSelf,addGroup:i?this.dummyFn:this.addGroup,addCaseGroup:i?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:i?this.dummyFn:this.addDefaultCaseGroup,addRule:i?this.dummyFn:this.addRule,setField:i?this.dummyFn:this.setField,setFuncValue:i?this.dummyFn:this.setFuncValue,setOperator:i?this.dummyFn:this.setOperator,setValue:i?this.dummyFn:this.setValue,value:this.props.value||null,valueError:this.props.valueError||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:l,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}]),l}(k.Component),r.propTypes={config:mu().object.isRequired,actions:mu().object.isRequired,path:mu().any.isRequired,id:mu().string.isRequired,groupId:mu().string,not:mu().bool,conjunction:mu().string,children1:mu().any,onDragStart:mu().func,reordableNodesCnt:mu().number,field:mu().any,fieldSrc:mu().string,fieldType:mu().string,parentField:mu().string,valueError:mu().any,isLocked:mu().bool,isTrueLocked:mu().bool,dragging:mu().object,isDraggingTempo:mu().bool},r}(e,t));return r.displayName="ConnectedGroupContainer",r};var Dc={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},Ac=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,i=e.setLock,l=e.isLocked,a=e.isTrueLocked,u=e.id,s=e.canAddGroup,c=e.canAddRule,p=e.canDeleteGroup,d=t.settings,f=d.immutableGroupsMode,v=d.addRuleLabel,g=d.addGroupLabel,h=d.delGroupLabel,y=d.groupActionsPosition,m=d.renderButton,b=d.renderIcon,O=d.renderSwitch,S=d.renderButtonGroup,F=d.lockLabel,w=d.lockedLabel,j=d.showLock,E=d.canDeleteLocked,C=function(e){return b(e,t.ctx)},L=function(e){return m(e,t.ctx)},P=function(e){return O(e,t.ctx)},_=function(e){return S(e,t.ctx)},Z=Dc[y||"topRight"],T=j&&!(l&&!a)&&k.createElement(P,{type:"lock",id:u,value:l,setValue:i,label:F,checkedLabel:w,config:t}),V=!f&&c&&!l&&k.createElement(L,{type:"addRule",onClick:r,label:v,readonly:l,config:t,renderIcon:C}),I=!f&&s&&!l&&k.createElement(L,{type:"addGroup",onClick:n,label:g,readonly:l,config:t,renderIcon:C}),x=!f&&p&&(!l||l&&E)&&k.createElement(L,{type:"delGroup",onClick:o,label:h,config:t,renderIcon:C});return k.createElement("div",{className:"group--actions ".concat(Z)},k.createElement(_,{config:t},T,V,I,x))}}]),o}(k.PureComponent);function Nc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nc(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var qc=hu.RuleUtils.isEmptyGroupChildren,Wc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return""},t.renderBeforeActions=function(){var e=t.props.config.settings.renderBeforeActions;return null==e?null:"function"==typeof e?e(t.props,t.props.config.ctx):e},t.renderAfterActions=function(){var e=t.props.config.settings.renderAfterActions;return null==e?null:"function"==typeof e?e(t.props,t.props.config.ctx):e},t.removeSelf=t.removeSelf.bind((0,C.Z)(t)),t.setLock=t.setLock.bind((0,C.Z)(t)),t.renderItem=t.renderItem.bind((0,C.Z)(t)),t}return(0,E.Z)(o,[{key:"isGroupTopPosition",value:function(){return Ic()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this,t=this.props,r=t.confirmFn,n=t.config,o=n.settings,i=o.renderConfirm,l=o.removeGroupConfirmOptions,a=function(){e.props.removeSelf()};l&&!this.isEmptyCurrentGroup()?i.call(n.ctx,Mc(Mc({},l),{},{onOk:a,onCancel:null,confirmFn:r}),n.ctx):a()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config;return qc(t,r)}},{key:"render",value:function(){return k.createElement(k.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}},{key:"showNot",value:function(){return this.props.config.settings.showNot}},{key:"showConjs",value:function(){var e=this.props,t=e.conjunctionOptions;return e.children1,e.config,Object.keys(t).length>1||this.showNot()}},{key:"isNoChildren",value:function(){var e=this.props.children1;return!e||0==e.size}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&k.createElement("div",{key:"group-children",className:is()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return k.createElement("div",{key:"group-header",className:is()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&k.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id;return k.createElement(Ac,{config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props.config.settings.maxNumberOfRules,t=this.props.totalRulesCnt;return!e||t<e}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.valueSeq().map(this.renderItem).toArray():null}},{key:"renderItem",value:function(e){if(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,i=t.isLocked,l="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return k.createElement(wp,(0,ns.Z)({},this.extraPropsForItem(e),{key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:l,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:i}))}}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=this.reordableNodesCnt();return t.settings.canReorder&&!r&&o>1&&!n}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.props.config,r=t.settings.renderIcon,n=function(e){return null==r?void 0:r(e,t.ctx)},o=k.createElement(n,{type:"drag"});return this.showDragIcon()&&k.createElement("div",{key:"group-drag-icon",onMouseDown:e,className:"qb-drag-handler group--drag-handler"},o)}},{key:"conjunctionOptions",value:function(){return this.props.conjunctionOptions}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.children1,n=e.id,o=e.selectedConjunction,i=e.setConjunction,l=e.not,a=e.setNot,u=e.isLocked,s=t.settings,c=s.immutableGroupsMode,p=s.renderConjs,d=(s.showNot,s.notLabel),f=this.conjunctionOptions();return this.showConjs()&&r&&r.size?p({disabled:this.isOneChild(),readonly:c||u,selectedConjunction:o,setConjunction:c?ws:i,conjunctionOptions:f,config:t,not:l||!1,id:n,setNot:c?ws:a,notLabel:d,showNot:this.showNot(),isLocked:u},t.ctx):null}},{key:"renderHeader",value:function(){return k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}}]),o}(k.Component);Wc.propTypes={reordableNodesCnt:mu().number,conjunctionOptions:mu().object.isRequired,allowFurtherNesting:mu().bool.isRequired,isRoot:mu().bool.isRequired,not:mu().bool,selectedConjunction:mu().string,config:mu().object.isRequired,id:mu().string.isRequired,groupId:mu().string,path:mu().any,children1:mu().any,isDraggingMe:mu().bool,isDraggingTempo:mu().bool,isLocked:mu().bool,isTrueLocked:mu().bool,handleDraggerMouseDown:mu().func,onDragStart:mu().func,addRule:mu().func.isRequired,addGroup:mu().func.isRequired,removeSelf:mu().func.isRequired,setConjunction:mu().func.isRequired,setNot:mu().func.isRequired,setLock:mu().func.isRequired,actions:mu().object.isRequired};const Gc=Rc(ps("group")(Es(Wc)),"group");var Bc=r(69458);var Uc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,l=e.setLock,a=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,p=c.immutableGroupsMode,d=c.addRuleLabel,f=c.delGroupLabel,v=c.renderButton,g=c.renderIcon,h=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,b=c.lockedLabel,O=c.showLock,S=c.canDeleteLocked,F=function(e){return g(e,t.ctx)},w=function(e){return v(e,t.ctx)},j=function(e){return h(e,t.ctx)},E=function(e){return y(e,t.ctx)},C=O&&!(a&&!u)&&k.createElement(j,{type:"lock",id:s,value:a,setValue:l,label:m,checkedLabel:b,hideLabel:!0,config:t}),L=!p&&n&&!a&&k.createElement(w,{type:"addRuleGroup",onClick:r,label:d,readonly:a,config:t,renderIcon:F}),P=!p&&o&&(!a||a&&S)&&k.createElement(w,{type:"delRuleGroup",onClick:i,label:f,config:t,renderIcon:F});return k.createElement("div",{className:"group--actions"},k.createElement(E,{config:t},C,L,P))}}]),o}(k.PureComponent);function zc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zc(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"rule_group--children"},t.renderHeaderWrapper=function(){return null},t.renderFooterWrapper=function(){return null},t.renderConjs=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!1},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"renderChildrenWrapper",value:function(){return k.createElement(k.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),(0,Bc.Z)((0,_.Z)(o.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,l=e.setFuncValue,a=e.setFieldSrc,u=e.parentField,s=e.id,c=e.groupId,p=e.isLocked,d=t.settings.immutableFieldsMode;return k.createElement(bc,{key:"field",classname:"group--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:l,setFieldSrc:a,parentField:u,readonly:d||p,id:s,groupId:c})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return k.createElement(Uc,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}]),o}(Wc);Jc.propTypes=$c($c({},Wc.propTypes),{},{selectedField:mu().any,selectedFieldSrc:mu().string,parentField:mu().string,setField:mu().func,setFieldSrc:mu().func});const Hc=Rc(ps("group rule_group")(Es(Jc)),"rule_group");var Yc=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,l=e.setLock,a=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,p=c.immutableGroupsMode,d=c.addSubRuleLabel,f=c.delGroupLabel,v=c.renderButton,g=c.renderIcon,h=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,b=c.lockedLabel,O=c.showLock,S=c.canDeleteLocked,F=function(e){return g(e,t.ctx)},w=function(e){return v(e,t.ctx)},j=function(e){return h(e,t.ctx)},E=function(e){return y(e,t.ctx)},C=O&&!(a&&!u)&&k.createElement(j,{type:"lock",id:s,value:a,setValue:l,label:m,checkedLabel:b,config:t}),L=!p&&n&&!a&&k.createElement(w,{type:"addRuleGroupExt",onClick:r,label:d,readonly:a,config:t,renderIcon:F}),P=!p&&o&&(!a||a&&S)&&k.createElement(w,{type:"delRuleGroup",onClick:i,label:f,config:t,renderIcon:F});return k.createElement("div",{className:"group--actions group--actions--tr"},k.createElement(E,{config:t},C,L,P))}}]),o}(k.PureComponent);function Kc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kc(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ep=hu.ConfigUtils,tp=ep.getFieldConfig,rp=ep.getFieldWidgetConfig,np=hu.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,op=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"rule_group_ext--children"},t.renderFooterWrapper=function(){return null},t.canAddGroup=function(){return!1},t.canAddRule=function(){return!0},t.canDeleteGroup=function(){return!0},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:is()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return k.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,i=n.showErrorMessage,l=(0,T.Z)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return i&&l&&k.createElement("div",{className:"rule_group--error"},o?o({error:l},t.ctx):l)}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=(e.selectedOperator,tp(t,r)||{});return null!=n.showNot?n.showNot:t.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=(e.selectedOperator,tp(t,r)||{}),i=(0,Bc.Z)((0,_.Z)(o.prototype),"conjunctionOptions",this).call(this);if(n.conjunctions){var l,a={},u=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Xc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(n.conjunctions);try{for(u.s();!(l=u.n()).done;){var s=l.value,c=i[s];c&&(a[s]=c)}}catch(e){u.e(e)}finally{u.f()}i=a}return i}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,l=e.setFieldSrc,a=e.setFuncValue,u=e.parentField,s=e.id,c=e.groupId,p=e.isLocked,d=t.settings.immutableFieldsMode;return k.createElement(bc,{key:"field",classname:"rule--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:a,setFieldSrc:l,parentField:u,readonly:d||p,id:s,groupId:c})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedOperator,i=(e.setField,e.setOperator),l=e.isLocked,a=t.settings.immutableFieldsMode,u=rp(t,r,o)||{},s=u.hideOperator,c=r&&s&&u.operatorInlineLabel,p=r&&!s;return k.createElement(Cs,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedFieldSrc:n,selectedOperator:o,setOperator:i,selectedFieldPartsLabels:["group"],showOperator:p,showOperatorLabel:c,selectedFieldWidgetConfig:u,readonly:a||l,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config,n=this._buildWidgetProps(this.props);return np(n,t,r)}},{key:"_buildWidgetProps",value:function(e){var t=e.selectedField,r=e.selectedFieldSrc,n=e.selectedFieldType,o=e.selectedOperator,i=e.operatorOptions,l=e.value,a=e.valueType,u=(e.valueSrc,e.asyncListValues,e.valueError);return e.fieldError,{field:t,fieldSrc:r,fieldType:n,operator:o,operatorOptions:i,value:l,valueType:a,valueSrc:["value"],valueError:u,fieldError:null,parentField:e.parentField}}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,i=t.settings.immutableValuesMode;if(!r||!n)return null;var l=k.createElement(dc,(0,ns.Z)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:t,setValue:i?ws:this.props.setValue,setValueSrc:ws,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return k.createElement(Fs,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return k.createElement(Yc,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}]),o}(Wc);op.propTypes=Qc(Qc({},Wc.propTypes),{},{selectedField:mu().any,selectedFieldSrc:mu().string,selectedOperator:mu().string,value:mu().any,parentField:mu().string,setField:mu().func,setFieldSrc:mu().func,setOperator:mu().func,setValue:mu().func,valueError:mu().any});const ip=Rc(ps("group rule_group_ext")(Es(op)),"rule_group");var lp={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},ap=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,i=e.isLocked,l=e.isTrueLocked,a=e.id,u=e.canAddGroup,s=e.canAddDefault,c=t.settings,p=c.immutableGroupsMode,d=c.addCaseLabel,f=c.addDefaultCaseLabel,v=c.groupActionsPosition,g=c.renderButton,h=c.renderIcon,y=c.renderSwitch,m=c.renderButtonGroup,b=c.lockLabel,O=c.lockedLabel,S=c.showLock,F=function(e){return h(e,t.ctx)},w=function(e){return g(e,t.ctx)},j=function(e){return y(e,t.ctx)},E=function(e){return m(e,t.ctx)},C=lp[v||"topRight"],L=S&&!(i&&!l)&&k.createElement(j,{type:"lock",id:a,value:i,setValue:o,label:b,checkedLabel:O,config:t}),P=!p&&u&&!i&&k.createElement(w,{type:"addCaseGroup",onClick:r,label:d,readonly:i,config:t,renderIcon:F}),_=!p&&s&&!i&&k.createElement(w,{type:"addDefaultCaseGroup",onClick:n,label:f,readonly:i,config:t,renderIcon:F});return k.createElement("div",{className:"group--actions ".concat(C)},k.createElement(E,{config:t},L,P,_))}}]),o}(k.PureComponent);function up(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var sp=hu.TreeUtils,cp=sp.getTotalReordableNodesCountInTree,pp=sp.getTotalRulesCountInTree,dp=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"switch_group--children"},t.renderFooterWrapper=function(){return null},t.hasDefaultCase=function(){var e;return(null===(e=t.props.children1)||void 0===e?void 0:e.size)&&t.props.children1.filter((function(e){return null==e.get("children1")})).size>0},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"canAddGroup",value:function(){var e,t=this.props.config.settings.maxNumberOfCases,r=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return!t||r<t}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e,t=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return this.hasDefaultCase()&&t--,t}},{key:"totalRulesCntForItem",value:function(e){return pp(e)}},{key:"reordableNodesCntForItem",value:function(e){var t;if(this.props.isLocked)return 0;var r=this.props.config.settings,n=r.canLeaveEmptyCase,o=r.canRegroupCases,i=(null===(t=this.props.children1)||void 0===t?void 0:t.size)||0;this.hasDefaultCase()&&i--;var l=cp(e);return 1==l&&o&&n&&i>1&&(l=111),l}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:is()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){return this.props.config.settings.renderSwitchPrefix||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id;return k.createElement(ap,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l})}}]),o}(Wc);dp.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?up(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):up(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Wc.propTypes);const fp=Rc(ps("group switch_group")(Es(dp)),"switch_group");function vp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vp(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var hp=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).childrenClassName=function(){return"case_group--children"},t.renderFooterWrapper=function(){return null},Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&(0,Bc.Z)((0,_.Z)(o.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:is()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:k.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:(0,Bc.Z)((0,_.Z)(o.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?this.renderValue():null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&(0,Bc.Z)((0,_.Z)(o.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&(0,Bc.Z)((0,_.Z)(o.prototype),"canAddRule",this).call(this)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.setValue,i=e.id,l=t.settings.immutableValuesMode,a=k.createElement(dc,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:"value",valueError:null,fieldError:null,config:t,setValue:l?ws:o,setValueSrc:ws,readonly:l||r,id:i,groupId:null});return k.createElement(Fs,{className:"case_group--value"},a)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,i=e.isTrueLocked,l=e.id;return k.createElement(Ac,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,t=e&&e.size?e.get(0):null,r=null!=t&&(!Array.isArray(t)||t.length>0);return(0,Bc.Z)((0,_.Z)(o.prototype),"isEmptyCurrentGroup",this).call(this)&&!r}}]),o}(Wc);hp.propTypes=gp(gp({},Wc.propTypes),{},{parentReordableNodesCnt:mu().number,value:mu().any,setValue:mu().func});const yp=Rc(ps("group case_group")(Es(hp)),"case_group");var mp=["type"];function bp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Op(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bp(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Sp=function(e){var t,r=(null===(t=e.properties)||void 0===t?void 0:t.toObject())||{},n=Op({},r);return e.isParentLocked&&(n.isLocked=!0),r.isLocked&&(n.isTrueLocked=!0),n},Fp={rule:function(e){return k.createElement(Tc,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return k.createElement(Gc,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return k.createElement(Hc,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return k.createElement(ip,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return k.createElement(fp,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return k.createElement(yp,(0,ns.Z)({},Sp(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},wp=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){return(0,j.Z)(this,o),n.apply(this,arguments)}return(0,E.Z)(o,[{key:"render",value:function(){var e,t=this.props,r=t.type,n=(0,Vl.Z)(t,mp),o="array"==(null===(e=n.properties)||void 0===e?void 0:e.get("mode"))?"_ext":"",i=n.config.settings.renderItem,l=Fp[r+o];return i?i(Op(Op({},n),{},{type:r,itemComponent:l}),n.config.ctx):l?l(n):null}}]),o}(k.PureComponent);wp.propTypes={config:mu().object.isRequired,id:mu().string.isRequired,groupId:mu().string,type:mu().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:mu().any.isRequired,properties:mu().any,children1:mu().any,actions:mu().object.isRequired,reordableNodesCnt:mu().number,onDragStart:mu().func,parentField:mu().string,isDraggingTempo:mu().bool,isParentLocked:mu().bool};var jp=hu.TreeUtils,Ep=jp.getTotalReordableNodesCountInTree,Cp=jp.getTotalRulesCountInTree,Lp=hu.DefaultUtils,Pp=Lp.createListFromArray,_p=Lp.emptyProperties,kp=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),(t=n.call(this,e)).pureShouldComponentUpdate=$u((0,C.Z)(t)),t._updPath(e),t}return(0,E.Z)(o,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.pureShouldComponentUpdate(e,t);if(n){var o=[];for(var i in e)e[i]!==r[i]&&"__isInternalValueChange"!=i&&o.push(i);o.length||(n=!1),1==o.length&&"tree"==o[0]&&e.__isInternalValueChange&&(n=!1)}return n}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=Pp([t])}},{key:"render",value:function(){var e=this.props,t=e.tree,r=e.config,n=e.actions,o=e.onDragStart,i=t.get("type"),l="switch_group"==i,a=l?null:Ep(t),u=l?null:Cp(t),s=t.get("id");return k.createElement(wp,{key:s,id:s,path:this.path,type:i,properties:t.get("properties")||_p(),config:r,actions:n,children1:t.get("children1")||_p(),reordableNodesCnt:a,totalRulesCnt:u,parentReordableNodesCnt:0,onDragStart:o})}}]),o}(k.Component);kp.propTypes={tree:mu().any.isRequired,config:mu().object.isRequired,actions:mu().object.isRequired,onDragStart:mu().func};const Zp=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,Fu.$j)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:Pu,setDragProgress:Lu,setDragEnd:_u},null,{context:Ou})(function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){(0,L.Z)(l,t);var n,o,i=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,_.Z)(n);if(o){var r=(0,_.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,P.Z)(this,e)});function l(e){var t;return(0,j.Z)(this,l),(t=i.call(this,e))._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=Uu(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var i,l=o.closest(".query-builder-container")||o,a=(l=t._getScrollParent(l)||document.body).scrollTop,u=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),s=u.length?u[0]:null;s&&(i=window.getComputedStyle(s,null).getPropertyValue("padding-left"),i=parseInt(i));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:i},p={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:a,clientX:n.clientX,clientY:n.clientY,itemInfo:as(t.tree.items[e]),treeEl:o,treeElContainer:l},d={clientX:n.clientX,clientY:n.clientY},f=t._getEventTarget(n,p);t.eventTarget=f,f.addEventListener("mousemove",t.onDrag),f.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(p,c,d)},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),i=t.props.dragStart,l=o.paddingLeft,a=i.treeElContainer.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var u={clientX:e.clientX,clientY:e.clientY},s={clientX:i.clientX,clientY:i.clientY};if(e.__mock_dom){var c=i.treeEl,p=t._getDraggableNodeEl(c),d=t._getPlaceholderNodeEl(c);e.__mock_dom({treeEl:c,dragEl:p,plhEl:d})}if(!i.plX){var f=i.treeEl,v=t._getPlaceholderNodeEl(f);v&&(i.plX=v.getBoundingClientRect().left+window.scrollX,i.plY=v.getBoundingClientRect().top+window.scrollY)}var g=i.x,h=i.y,y=i.clientX,m=i.clientY,b=i.scrollTop,O={x:g+(e.clientX-y),y:h+(e.clientY-m)+(a-b)};o.x=O.x,o.y=O.y,o.paddingLeft=l,o.mousePos=u,o.startMousePos=s,t.props.setDragProgress(u,o),n&&t.handleDrag(o,e,r)||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},t.pureShouldComponentUpdate=$u((0,C.Z)(t)),Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(l,[{key:"onPropsChanged",value:function(e){this.tree=us(e.tree)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=[];for(var l in e)e[l]!=r[l]&&"dragging"!=l&&"mousePos"!=l&&i.push(l);i.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(ss=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,i=n.treeElContainer,l=this._getPlaceholderNodeEl(o,!0);if(l){var a=l.getBoundingClientRect().left+window.scrollX,u=l.getBoundingClientRect().top+window.scrollY,s=n.plX,c=n.plY,p=i.scrollTop;n.plX=a,n.plY=u,n.itemInfo=as(r.itemInfo),n.y=l.offsetTop,n.x=l.offsetLeft,n.clientY+=u-c,n.clientX+=a-s,i!=document.body&&(n.scrollTop=p),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,i,l,a=this,u=e.itemInfo,s=e.paddingLeft,c=null,p=this.props.dragStart.treeEl,d=e.id,f=this._getDraggableNodeEl(p),v=this._getPlaceholderNodeEl(p);if(f&&v){if(n=f.getBoundingClientRect(),!(o=v.getBoundingClientRect()).width)return;var g={hrz:0,vrt:0};n.top<o.top?g.vrt=-1:n.bottom>o.bottom&&(g.vrt=1),n.left>o.left?g.hrz=1:n.left<o.left&&(g.hrz=-1);var h,y={x:(l=p.getBoundingClientRect()).left+(l.right-l.left)/2,y:g.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)h=t.__mocked_hov_container;else{var m=document.elementFromPoint(y.x,y.y-1);if(!(h=m?m.closest(".group-or-rule-container"):null)&&m&&m.classList.contains("query-builder-container")){var b,O=null==m||null===(b=m.firstChild)||void 0===b?void 0:b.firstChild;O&&O.classList.contains("group-or-rule-container")&&(h=O)}}if(h){var S=h.classList.contains("group-container"),F=h.getAttribute("data-id"),w=h,j=!1,E=!1;if(w){var C=(i=w.getBoundingClientRect()).bottom-i.top,L=this.tree.items[F];if(!L)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var P=null,_=null,k=null,Z=null;if(0==g.vrt)k=u,(_=v)&&(P=_.getBoundingClientRect());else if(S){if(g.vrt>0){var V=h.getElementsByClassName("group--header"),I=V.length?V[0]:null;if(I){var x=I.getBoundingClientRect(),R=x.bottom-x.top;n.bottom-x.top>3*R/4&&L.top>e.itemInfo.top&&(k=L,P=x,_=I,E=!0)}}else g.vrt<0&&L.lev>=u.lev&&i.bottom-n.top>=2&&L.top<e.itemInfo.top&&(k=L,P=i,_=w,j=!0);(g.vrt<0?i.bottom-n.top>C-5:n.bottom-i.top>C-5)&&(E||j||(k=L,P=i,_=w),Z=L)}else(g.vrt<0?i.bottom-n.top>C/2:n.bottom-i.top>C/2)&&(k=L,P=i,_=w);var D=k&&k.id==d;if(P){var A=n.left-l.left,N=(P.left,l.left,Math.max(0,Math.round(A/s))),M=[],q=[];if(D);else{if(S&&(j?M.push([Eu,k,k.lev+1]):E&&M.push([Cu,k,k.lev+1]),Z)){var W=0==Z.lev,G="case_group"==Z.type&&"case_group"!=u.type,B=Z.prev&&this.tree.items[Z.prev].caseId,U=Z.next&&this.tree.items[Z.next].caseId;u.caseId==B&&(B=null),u.caseId==U&&(U=null);var z=B&&this.tree.items[B],$=U&&this.tree.items[U];g.vrt>0?W?q.push([Eu,Z,Z.lev+1]):G&&$?q.push([Cu,$,$.lev+1]):q.push([wu,Z,Z.lev]):g.vrt<0&&(W?q.push([Cu,Z,Z.lev+1]):G&&z?q.push([Eu,z,z.lev+1]):q.push([ju,Z,Z.lev]))}j||E||(g.vrt<0?M.push([ju,k,k.lev]):g.vrt>0&&M.push([wu,k,k.lev]))}var J=function(e){var t=e[1],r=u.caseId?a.tree.items[u.caseId]:null,n=t.caseId?a.tree.items[t.caseId]:null;return[].concat((0,T.Z)(e),[r,n])};M=M.map(J),q=q.map(J);var H=null,Y=(M=M.filter((function(e){var t=e[0],r=e[1];if((t==ju||t==wu)&&null==r.parent)return!1;if(r.collapsed&&(t==Eu||t==Cu))return!1;var n=r.id==u.id;if(!n)for(var o=r;o.parent;)if((o=a.tree.items[o.parent]).id==u.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==Eu||t==Cu?r:a.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)}));0==Y.length&&q.length>0&&(Y=q.filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)})));var K=Y.map((function(e){return e[2]})),Q=u.lev,X=K.concat(Q),ee=null;-1!=X.indexOf(N)?ee=N:N>Math.max.apply(Math,(0,T.Z)(X))?ee=Math.max.apply(Math,(0,T.Z)(X)):N<Math.min.apply(Math,(0,T.Z)(X))&&(ee=Math.min.apply(Math,(0,T.Z)(X))),H=Y.find((function(e){return e[2]==ee})),D||H||!Y.length||(H=Y[0]),c=H}}}else Wu.log("out of tree bounds!")}return!!c&&(this.move(u,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,i,l){if(!e||!t)return!1;if(e.id===t.id)return!1;var a=this.props.config.settings,u=a.canRegroup,s=a.canRegroupCases,c=a.maxNesting,p=a.maxNumberOfRules,d=a.canLeaveEmptyCase,f=(i?i.lev+1:t.lev)+(e.depth||0),v=r==ju||r==wu,g=r==Cu||r==Eu,h=v&&1==t.lev||g&&0==t.lev,y=e.parent!=t.parent,m=g||y,b="case_group"==e.type&&!h||"rule_group"==e.parentType||"rule_group"==t.type||"rule_group"==t.parentType||"case_group"!=e.type&&"case_group"==t.type&&v||"case_group"!=e.type&&"switch_group"==t.type||!s&&e.caseId!=t.caseId,O=t.isLocked||e.isLocked||i&&i.isLocked;if(c&&f>c)return!1;if(m&&(!u||b||O))return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var S=!!n&&2==n._height,F=o?o.atomicRulesCountInCase+1:0;if(p&&F>p)return!1;if(S&&!d)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==Eu))return!1;var w=!0;return l&&(w=l(e.node.toJS(),t.node.toJS(),r,i?i.node.toJS():null)),w}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(ss=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return k.createElement(e,(0,ns.Z)({},this.props,{onDragStart:this.onDragStart}))}}]),l}(k.Component),t.propTypes={tree:mu().any.isRequired,actions:mu().object.isRequired},t}(e,t));return r.displayName="ConnectedSortableContainer",r}(kp);function Tp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Vp=hu.clone,Ip=hu.ConfigUtils,xp=Ip.getFieldConfig,Rp=Ip.getFieldParts,Dp=Ip.getFieldPathParts,Ap=hu.RuleUtils,Np=Ap.getFieldPathLabels,Mp=Ap.getWidgetForFieldOp,qp=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(e){var t;return(0,j.Z)(this,o),t=n.call(this,e),Ju((0,C.Z)(t)),t.onPropsChanged(e),t}return(0,E.Z)(o,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.fieldType,o=e.operator,i=e.parentField,l=e.isFuncArg,a=e.fieldDefinition,u=t.settings.canCompareFieldWithField,s=(t.settings.fieldSeparator,Rp(i,t)),c=i?xp(t,i):null,p=i?null==c?void 0:c.subfields:t.fields,d=this.filterFields(t,p,r,i,s,o,u,l,a,n);return this.buildOptions(s,t,d,s)}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.field,o=(e.fieldType,e.operator,e.value),i=e.placeholder,l=e.isFuncArg,a=e.parentField,u=r.settings,s=u.fieldPlaceholder,c=u.fieldSeparatorDisplay,p=o,d=!!o,f=n?xp(r,n):{},v=null==f||null===(t=f.widgets)||void 0===t?void 0:t.field,g=(null==v?void 0:v.widgetProps)||{},h=d?null:l&&i||g.valuePlaceholder||s,y=d?xp(r,p):null,m=y||{},b=Dp(p,r),O=Dp(p,r,!0),S=this.getFieldLabel(y,p,r),F=Np(p,r),w=F?F.join(c):null;return(w==S||a)&&(w=null),{placeholder:h,selectedKey:p,selectedKeys:b,selectedPath:O,selectedLabel:S,selectedOpts:m,selectedAltLabel:m.label2,selectedFullLabel:w}}},{key:"filterFields",value:function(e,t,r,n,o,i,l,a,u,s){t=Vp(t);var c,p=e.settings.fieldSeparator,d=xp(e,r),f=Mp(e,r,i,"value");return e.widgets[f],c=a?null==u?void 0:u.type:d?d.type:s,function t(n,o){for(var u in n){var s=n[u].subfields,f=(o||[]).concat(u),v=f.join(p),g=xp(e,v);if(g)if("!struct"==g.type||"!group"==g.type)0==t(s,f)&&delete n[u];else{var h=!(c&&g.type!=c||!a&&v==r),y=l||e.settings.canCompareFieldWithField;y&&(h=h&&y(r,d,v,g,i)),h||delete n[u]}else delete n[u]}return fs()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var l=t.settings,a=l.fieldSeparator,u=l.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"";return fs()(r).map((function(l){var a=[].concat((0,T.Z)(null!=o?o:[]),[l]),c=r[l],p=n.getFieldLabel(c,a,t),d=Np(a,t).join(u);(d==p||e)&&(d=null);var f=c.label2,v=c.tooltip;if(!c.hideForCompare)return"!struct"==c.type||"!group"==c.type?{key:l,path:s+l,label:p,fullLabel:d,altLabel:f,tooltip:v,items:n.buildOptions(e,t,c.subfields,a,{label:p,tooltip:v})}:{key:l,path:s+l,label:p,fullLabel:d,altLabel:f,tooltip:v,grouplabel:null==i?void 0:i.label,group:i}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Rp(t,r),i=(null==e?void 0:e.label)||ye()(o);return Nu(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tp(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isValueField:!0,config:t,customProps:r,setField:n,readonly:o,items:this.items,id:i,groupId:l},this.meta);return a(u,t.ctx)}}]),o}(k.Component);qp.propTypes={id:mu().string,groupId:mu().string,setValue:mu().func.isRequired,config:mu().object.isRequired,field:mu().any,fieldSrc:mu().string,fieldType:mu().string,value:mu().string,operator:mu().string,customProps:mu().object,readonly:mu().bool,parentField:mu().string,fieldDefinition:mu().object,isFuncArg:mu().bool};const Wp=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,i=e.readonly,l=(e.widgetId,e.customProps),a=void 0===l?{}:l,u=a.radioYes||{},s=a.radioNo||{},c=function(e){return r("true"==e.target.value)};return k.createElement(k.Fragment,null,k.createElement("input",(0,ns.Z)({type:"radio",value:!0,checked:!!t,disabled:i,onChange:c},u))," ",n,k.createElement("input",(0,ns.Z)({type:"radio",value:!1,checked:!t,disabled:i,onChange:c},s))," ",o)},Gp=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,l=e.customProps,a=t||"";return k.createElement("input",(0,ns.Z)({type:"text",value:a,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i},l))},Bp=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,l=(e.maxRows,e.fullWidth),a=e.customProps,u=t||"";return k.createElement("textarea",(0,ns.Z)({value:u,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i,style:{width:l?"100%":void 0}},a))};hu.moment;const Up=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return k.createElement("input",(0,ns.Z)({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},zp=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return k.createElement("input",(0,ns.Z)({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))};var $p=hu.moment;const Jp=function(e){var t,r=e.value,n=e.setValue,o=(e.config,e.valueFormat),i=(e.use12Hours,e.readonly),l=e.customProps;return t=r?$p(r).format("YYYY-MM-DDTHH:mm"):"",k.createElement("input",(0,ns.Z)({type:"datetime-local",value:t,disabled:i,onChange:function(e){var t=e.target.value;t=""==t?void 0:$p(new Date(t)).format(o),n(t)}},l))};var Hp=hu.ListUtils.mapListValues;const Yp=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps;return k.createElement("select",(0,ns.Z)({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},D()(i,["showSearch","input","showCheckboxes"])),Hp(t,(function(e){var t=e.title,r=e.value;return k.createElement("option",{key:r,value:r},t)})))};var Kp=hu.ListUtils.mapListValues;const Qp=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps,l=null!=r;return k.createElement("select",(0,ns.Z)({onChange:function(e){return n(e.target.value)},value:l?r:"",disabled:o},D()(i,["showSearch","input"])),!l&&k.createElement("option",{disabled:!0,value:""}),Kp(t,(function(e){var t=e.title,r=e.value;return k.createElement("option",{key:r,value:r},t)})))},Xp=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,l=e.step,a=e.placeholder,u=e.customProps,s=null==t?"":t;return k.createElement("input",(0,ns.Z)({type:"number",value:s,placeholder:a,disabled:n,min:o,max:i,step:l,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},u))},ed=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,l=e.step,a=e.placeholder,u=e.customProps,s=void 0===u?{}:u,c=s.input||{},p=s.slider||s,d=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},f=null==t?"":t;return k.createElement("div",{style:{display:"inline-flex"}},k.createElement("input",(0,ns.Z)({key:"number",type:"number",value:f,placeholder:a,disabled:n,min:o,max:i,step:l,onChange:d},c)),k.createElement("input",(0,ns.Z)({key:"range",type:"range",value:f,disabled:n,min:o,max:i,step:l,onChange:d},p)))},td=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=e.errorText,l=null!=n;return k.createElement("select",{onChange:function(e){return r(e.target.value)},value:l?n:"",disabled:o,style:{color:i?"red":null}},!l&&k.createElement("option",{disabled:!0,value:""}),function e(t){return t.map((function(t){var r=t.items,n=t.path,o=t.label,i=t.disabled,l=t.matchesType;if(r)return k.createElement("optgroup",{disabled:i,key:n,label:o},e(r));var a=l?{fontWeight:"bold"}:{};return k.createElement("option",{disabled:i,key:n,value:n,style:a},o)}))}(t))},rd=function(e){var t,r=e.id,n=e.not,o=e.setNot,i=e.conjunctionOptions,l=e.setConjunction,a=e.disabled,u=e.readonly,s=e.config,c=e.showNot,p=e.notLabel,d=Object.keys(i).length,f=a,v=s.settings.forceShowConj||d>1&&!f,g=function(e){return l(e.target.value)};return[c&&(t="not",[k.createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:u,onChange:function(e){return o(e.target.checked)}}),k.createElement("label",{key:r+t+"label",htmlFor:r+t},p||"NOT")]),v&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=t.name,o=t.label,s=t.checked,c=l.isDummyFn?"__dummy":"";return!u&&!a||s?[k.createElement("input",{key:r+c,type:"radio",id:r+c,name:n+c,checked:s,disabled:u||a,value:e,onChange:g}),k.createElement("label",{key:r+c+"label",htmlFor:r+c},o)]:null}))]};var nd={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const od=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=r||nd[t];return k.createElement("button",{onClick:n,type:"button",disabled:o},i)},id=function(e){var t=e.type,r={}[t]||null;return r||"drag"!==t||(r=k.createElement(js,null)),r},ld=function(e){var t=e.children;return e.config,k.createElement(k.Fragment,null,t)},ad=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return k.createElement("select",{onChange:function(e){return n(e.target.value)},value:r||"",disabled:o},function(e){return e.map((function(e){var t=(0,V.Z)(e,2),r=t[0],n=t[1];return k.createElement("option",{key:r,value:r},n.label)}))}(t))},ud=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,i=(e.config,e.type);return[k.createElement("input",{key:o+i,type:"checkbox",id:o+i,checked:!!t,onChange:function(e){return r(e.target.checked)}}),k.createElement("label",{key:o+i+"label",htmlFor:o+i},n)]},sd=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var cd=function(e){return e.config,e.children};var pd=function(e){(0,L.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,_.Z)(t);if(r){var o=(0,_.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,P.Z)(this,e)});function o(){var e;(0,j.Z)(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return(0,E.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,n=e.config,o=e.optionLabel,i=e.optionPlaceholder,l=e.customProps,a=e.minProximity,u=e.maxProximity,s=e.optionTextBefore,c=e.readonly,p=n.settings,d=n.widgets,f=n.ctx,v=t?t.proximity:void 0,g=p.showLabels,h=r.get("proximity",v),y=$s()(a,u+1).map((function(e){return{title:e,value:e}})),m=d.select.factory,b=function(e){return m(e,f)};return k.createElement("div",{className:"operator--PROXIMITY"},k.createElement("div",{className:"operator--options"},g&&k.createElement("label",{className:"rule--label"},o),!g&&s&&k.createElement("div",{className:"operator--options--sep"},k.createElement("span",null,s)),k.createElement(b,(0,ns.Z)({config:n,value:h,listValues:y,setValue:this.handleChange,readonly:c,placeholder:i},l))),k.createElement("div",{className:"operator--widgets"},this.props.children))}}]),o}(k.PureComponent);function dd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dd(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}pd.propTypes={config:mu().object.isRequired,setOption:mu().func.isRequired,options:mu().any.isRequired,minProximity:mu().number,maxProximity:mu().number,optionPlaceholder:mu().string,optionTextBefore:mu().string,optionLabel:mu().string,customProps:mu().object,readonly:mu().bool},pd.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};var vd={conjunctions:fd({},pa.conjunctions),operators:fd(fd({},pa.operators),{},{proximity:fd(fd({},pa.operators.proximity),{},{options:fd(fd({},pa.operators.proximity.options),{},{factory:function(e,t){return(0,t.RCE)(t.O.ProximityOperator,e)}})})}),widgets:{text:fd(fd({},pa.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}}),textarea:fd(fd({},pa.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextAreaWidget,e)}}),number:fd(fd({},pa.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaNumberWidget,e)}}),slider:fd(fd({},pa.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSliderWidget,e)}}),select:fd(fd({},pa.widgets.select),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSelectWidget,e)}}),multiselect:fd(fd({},pa.widgets.multiselect),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaMultiSelectWidget,e)}}),date:fd(fd({},pa.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateWidget,e)}}),time:fd(fd({},pa.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTimeWidget,e)}}),datetime:fd(fd({},pa.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateTimeWidget,e)}}),boolean:fd(fd({},pa.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaBooleanWidget,e)}}),field:fd(fd({},pa.widgets.field),{},{factory:function(e,t){return(0,t.RCE)(t.W.ValueFieldWidget,e)},customProps:{showSearch:!0}}),func:fd(fd({},pa.widgets.func),{},{factory:function(e,t){return(0,t.RCE)(t.W.FuncWidget,e)},customProps:{}}),case_value:fd(fd({},pa.widgets.case_value),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}})},types:fd(fd({},pa.types),{},{select:fd(fd({},pa.types.select),{},{widgets:fd(fd({},pa.types.select.widgets),{},{select:fd(fd({},pa.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),settings:fd(fd({},pa.settings),{},{renderField:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.VanillaConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.VanillaSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.VanillaButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.VanillaIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.VanillaButtonGroup,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.VanillaProvider,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderConfirm:function(e,t){return(0,t.W.vanillaConfirm)(e)},renderSwitchPrefix:"Conditions",customFieldSelectProps:{showSearch:!0},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),ctx:fd(fd({},pa.ctx),{},{W:fd({},S),O:fd({},F),RCE:function(e,t){return k.createElement(e,t)}})};const gd=vd=hu.ConfigMixins.removeMixins(vd,["rangeslider","treeselect","treemultiselect"]);var hd=r(77837),yd=r.n(hd);function md(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function bd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?md(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):md(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Od=hu.Autocomplete,Sd=Od.mergeListValues,Fd=Od.listValueToOption,wd=Od.optionToListValue,jd=Od.optionsToListValues,Ed=Od.fixListValuesGroupOrder,Cd=hu.ListUtils,Ld=Cd.mapListValues,Pd=Cd.listValuesToArray,_d=Cd.getListValue,kd=Cd.makeCustomListValue,Zd=Cd.searchListValue;function Td(e){return new Promise((function(t){setTimeout(t,e)}))}Cd.getItemInListValues;const Vd=function(e,t){var r=e.asyncFetch,n=e.useLoadMore,o=e.useAsyncSearch,i=e.forceAsyncSearch,l=e.asyncListValues,a=e.listValues,u=e.allowCustomValues,s=e.value,c=e.setValue,p=e.placeholder,d=e.config,f=t.debounceTimeout,v=t.multiple,g=t.uif,h=t.isFieldAutocomplete,y=["LOAD_MORE","LOADING_MORE"],m="Load more...",b="Loading more...",O=i?"Type to search":p,S=k.useState(!1),F=(0,V.Z)(S,2),w=F[0],j=F[1],E=k.useState(void 0),C=(0,V.Z)(E,2),L=C[0],P=C[1],_=k.useState(0),Z=(0,V.Z)(_,2),I=Z[0],x=Z[1],R=k.useState(!1),D=(0,V.Z)(R,2),A=D[0],N=D[1],M=k.useState(""),q=(0,V.Z)(M,2),W=q[0],G=q[1],B=k.useState(void 0),U=(0,V.Z)(B,2),z=U[0],$=U[1],J=k.useRef(0),H=k.useRef(0),Y=k.useRef(!1),K=k.useMemo((function(){return Pd(l)}),[l]),Q=k.useMemo((function(){return r?l?Sd(z,K,!0):z:Pd(a)}),[r,l,z,a]),X=r?z:Pd(a);u&&W&&!Zd(W,z)&&(X=Sd(X,[kd(W)],!0)),!r||z||!l||W||w||"antd"!==g||(X=Q),r&&!u&&l&&"mui"===g&&(X=Sd(X,K,!0,!0));var ee=I>0,te=w&&r&&void 0===z&&(!i||W),re=te&&ee,ne=!re&&Q&&Q.length>0&&L&&L.hasMore&&(L.filter||"")===W,oe=!ee&&ne,ie=Ld(X,Fd),le=null!=s,ae=!v&&le?_d(s,Q):null,ue=function(){var e=(0,Il.Z)(se().mark((function e(){var t,o,i,l,a,u,s,c,p,f,v,g,h,y,m=arguments;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:null,!(o=m.length>1&&void 0!==m[1]&&m[1])&&L&&P(void 0),i=o&&z?z.length:0,l=o&&L||!n&&{pageSize:0},a=++J.current,e.next=8,r.call(null==d?void 0:d.ctx,t,i,l);case 8:if(u=e.sent,J.current==a&&H.current){e.next=12;break}return e.abrupt("return",null);case 12:return s=null!=u&&u.values?u:{values:u},c=s.values,p=s.hasMore,f=s.meta,v=Pd(c),o?(h=Sd(z,v,!1),g=h.length>z.length):(h=v,n&&(g=h.length>0)),(y=null!=p||null!=f||null!=g?bd(bd(bd(bd({},null!=g?{hasMore:g}:{}),null!=p?{hasMore:p}:{}),null!=f?f:{}),{},{filter:t}):void 0)&&P(y),e.abrupt("return",h);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=(0,Il.Z)(se().mark((function e(){var t,r,n,o=arguments;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,r=o.length>1&&void 0!==o[1]&&o[1],x((function(e){return e+1})),N(r),e.next=6,ue(t,r);case 6:if(n=e.sent,H.current){e.next=9;break}return e.abrupt("return");case 9:null!=n&&$(n),x((function(e){return e-1})),N(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=k.useCallback(yd()(ce,f),[]);k.useEffect((function(){return H.current++,te&&0==I&&0==J.current&&(0,Il.Z)(se().mark((function e(){return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:case"end":return e.stop()}}),e)})))(),function(){H.current--}}),[te]);var de=function(){j(!0)},fe=function(){var e=(0,Il.Z)(se().mark((function e(t){var r;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Y.current)?(Y.current=!1,v&&j(!1)):j(!1),"mui"!==g||r){e.next=6;break}return e.next=6,ge(null,"","my-reset");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,Il.Z)(se().mark((function e(t,n,o){var i,l,a,p,d,f,y,m,b,O,S,F,E,C,L,P;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=v&&"mui"===g&&"clear"===o,a=!v&&"mui"===g&&"clear"===o&&"change"===(null==t?void 0:t.type),p=!v&&"mui"===g&&"clear"===o&&"change"!==(null==t?void 0:t.type),"mui"===g&&(o=n,n=v?o.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})):null!==(d=null===(f=o)||void 0===f?void 0:f.value)&&void 0!==d?d:o),y=v&&Array.isArray(o)&&o.map((function(e){return null==e?void 0:e.specialValue})).find((function(e){return!!e}))||(null===(i=o)||void 0===i?void 0:i.specialValue),v&&n&&!Array.isArray(n)&&(n=[].concat((0,T.Z)(s||[]),[n]),o=null),!(l&&0===n.length&&W&&w||a)){e.next=9;break}return e.abrupt("return");case 9:if(m=v&&n.length&&n.length>(s||[]).length&&n[n.length-1]==W&&!_d(W,z),"LOAD_MORE"!=y){e.next=17;break}return G(W),Y.current=!0,e.next=15,ce(W,!0);case 15:e.next=37;break;case 17:if("LOADING_MORE"!=y){e.next=21;break}Y.current=!0,e.next=37;break;case 21:if(!v){e.next=31;break}if(b=jd(n,Q,u),O=(0,V.Z)(b,2),S=O[0],F=O[1],c(S,r?F:void 0),!m){e.next=29;break}return e.next=27,Td(0);case 27:return e.next=29,ge(null,"","my-reset");case 29:e.next=37;break;case 31:if(E=wd(n,Q,u),C=(0,V.Z)(E,2),L=C[0],P=C[1],c(L,r?P:void 0),!p||!h){e.next=37;break}return e.next=36,Td(0);case 36:j(!1);case 37:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ge=function(){var e=(0,Il.Z)(se().mark((function e(t,r,n){var l,a;return se().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l="mui"===g&&"reset"===n,(a=r)!==m&&a!==b&&!l){e.next=4;break}return e.abrupt("return");case 4:if(r==W){e.next=13;break}if(G(a),!o||i&&!a){e.next=12;break}return e.next=10,pe(a);case 10:e.next=13;break;case 12:o&&i&&$([]);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();return{options:"mui"===g?Ed(ie):ie,listValues:Q,hasValue:le,selectedListValue:ae,open:w,onOpen:de,onClose:fe,onDropdownVisibleChange:function(e){e?de():fe()},onChange:ve,inputValue:W,onInputChange:ge,canShowLoadMore:oe,isInitialLoading:re,isLoading:ee,isLoadingMore:A,isSpecialValue:function(e){var t=(null==e?void 0:e.specialValue)||(null==e?void 0:e.value);return y.includes(t)},extendOptions:function(e){var t=(0,T.Z)(e);return n&&(oe?t.push({specialValue:"LOAD_MORE",title:m}):A&&t.push({specialValue:"LOADING_MORE",title:b,disabled:!0})),t},getOptionSelected:function(e,t){if(null==t)return null;var r=null!=t.value?t.value:t;return e.value===r},getOptionDisabled:function(e){return e&&e.disabled},getOptionIsCustom:function(e){var t;if(null!=e&&e.isCustom)return!0;var r=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e,n=_d(r,Q);return(null==n?void 0:n.isCustom)||!1},getOptionLabel:function(e){if(null==e)return null;var t=null!=e.value?e:Fd(_d(e,Q));return!t&&e.specialValue?e.title:!t&&u?e:t?t.title||t.label||t.value:e},aPlaceholder:O}};function Id(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Id(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Id(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Rd=xd(xd({},hu),{},{ReactUtils:O,DragIcon:js})},40164:(e,t,r)=>{var n={"./es-us":88218,"./es-us.js":88218,"./ru":31313,"./ru.js":31313};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=40164}}]);
//# sourceMappingURL=15.bundle.js.map